3 наиболее вероятные причины вашей проблемы:
1) `⋇1` 
Возможно, при создании CNAME-записей в панели управления DNS вы указали полное доменное имя (FQDN) в поле имени хоста.
Многие регистраторы (например, GoDaddy или Namecheap) автоматически добавляют имя зоны к значению, если оно не завершается точкой.
В результате создается запись вида `selector1._domainkey.yourdomain.com.yourdomain.com`, которая технически корректна, но находится по неверному адресу.
Валидатор Microsoft Defender обращается по ожидаемому адресу `selector1._domainkey.yourdomain.com` и получает ответ `NXDOMAIN`, что блокирует активацию.
2) `⋇2` 
Возможно, вы используете DNS-провайдера с функцией CDN (чаще всего Cloudflare) и оставили включенным режим проксирования (оранжевое облако) для записей DKIM.
В этом режиме DNS-сервер возвращает A-записи с IP-адресами прокси-сервера вместо CNAME, указывающего на `onmicrosoft.com`.
Microsoft 365 требует чистой CNAME-записи для верификации владения и работы механизма автоматической ротации ключей.
Нарушение цепочки CNAME приводит к тому, что Defender не может подтвердить конфигурацию, даже если запись опубликована.
3) `⋇3`
Эта гипотеза основывается на архитектурных особенностях распределенной облачной системы Exchange Online, где возможна временная или постоянная рассинхронизация между графическим интерфейсом (GUI) и фактическим состоянием объектов в бэкенде. 
Пример проблемы: https://www.reddit.com/r/sysadmin/comments/11itcpm 
В экосистеме Microsoft 365 управление конфигурацией DKIM осуществляется через объекты `DkimSigningConfig`, хранящиеся в службе каталогов Azure Active Directory и реплицируемые в транспортные серверы Exchange Online Protection (EOP).  
Известны задокументированные случаи, когда переключатель «Enable DKIM» в портале Microsoft Defender (security.microsoft.com) отображается неактивным (greyed out) или находится в положении «Включено», но фактически подпись писем не производится. 
Это состояние, называемое «stuck state», возникает, когда команда на изменение конфигурации из GUI не была корректно обработана контроллером домена или не прошла полную репликацию по всем географическим зонам.  
Даже при наличии абсолютно корректных и провалидированных DNS-записей, служба транспорта не начинает добавлять заголовок DKIM-Signature, так как внутренний флаг Enabled для данного домена остается в значении $false.  
Более того, попытка повторного переключения тумблера в GUI часто не приводит к исправлению ситуации, так как интерфейс использует кэшированные данные о состоянии объекта.  
