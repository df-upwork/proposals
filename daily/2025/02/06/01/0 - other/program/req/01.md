## 1.
Моя компания находится в Шарлотт (Северная Каролина, США). 

## 2.
Моя компания предоставляет услуги переезда 2 типов:
1.1) Локальные: в радиусе 50 миль от пункта 1. 
1.2) Глобальные: из 1.1 в любую точку США.

## 3. 
Я рекламирую услуги моей компании (пункт 1) в поисковой выдаче Google посредством Google Ads.

## 4. Моя стратегическая задача
Я хочу, чтобы объявления рекламной кампании пункта 3 не показывались в поисковой выдаче Google, если пользователь Google (далее — `User`) сделал нерелевантный услугам (пункт 2) компании поисковый запрос.

## 4. Как я хочу выполнить задачу 4
Я хочу выполнить задачу 4 следующим способом:
4.1) Составляется список нерелевантных поисковых запросов (пункт 5 ниже).
4.2) Для каждого элемента списка поисковых запросов (пункт 5 ниже) определить: релевантен ли этот запрос услугам моей компании.

## 5.Список поисковых запросов
```
railcar mover rental
#1 pet mover
#1 us pet mover
√© preciso mover
02 01 mover 4029357733 can s618034583078548 card 3466
02 honda crv does not move then starts moving
1 2 x 170 inch belt mover deck
1 64 round bale mover
1 bedroom long distance mover canada
1 day mover salary
```

## 6. Твоя задача
Выполни 4.2 посредством разработки программы на языке Python, которая использует API OpenAI.

## 7. Критерии нерелевантности поискового запроса
Считай запрос нерелевантным, если для этого запроса справедливо хотя бы одно из утверждений этого пункта 7:
### 7.1.
Запрос не соответствует услугами компании (пункт 2).
### 7.2.
`User`'у нужен слишком мелкий переезд.
### 7.3.
`User` ищет конкурентов моей компании.
Например: запрос содержит названия брендов, производителей, моделей и т.д.
### 7.4.
`User` хочет выполнить переезд самостоятельно или проводит общее исследование (например, ищет процесс, этапы и т.д.).
### 7.5.
`User` ограничен в бюджете и ищет дешевые услуги.

## 8. Формат ответа программы пункта 6
### 8.1.
Ответ должен быть таблицей с 4 колонками.
## 8.2.
Каждой строке списка пункта 5 должна соответствовать ровно одна строка твоей таблицы.
## 8.3.
Строки таблицы должны распологаться ровно в той же последовательности, что и элементы списка пункта 5.
## 8.4.
У каждой строки таблицы должны быть ровно 5 ячеек:
8.4.1) Порядковый номер строки (начинай с 1).
8.4.2) Элемент списка пункта 5.
8.4.3) Считаешь ли ты поисковый запрос 8.4.2 релевантным услугам моей компании? (на основе пункта 7 выше)
Значением ячейки должно быть ровно одно слово: «да» или «нет».
8.4.4) Если значением ячейки 8.4.3 является «нет», то укажи конкретные подпункты пункта 7 выше, на основе которых ты принял рещение 8.4.3.
Значением ячейки должен быть просто список подпунктов пункта 7, через запятую.
8.4.5) Если значением ячейки 8.4.3 является «нет», то укажи правила для Google Ads в формате Google Ads, которые будут выполнять для этого конкретого запроса задачу пункта 4.

## 9. Технические требования
### 9.1.
Используй модель OpenAI `o1-preview`.
### 9.2.
Ключ API OpenAI:
```
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
```
Он должен быть вынесен в файл `.env`;
### 9.3.
Используй следующие правила форматирования кода (`.editorconfig`):
```
root = true
[*]
indent_size = 4
indent_style = tab
[*.py]
indent_style = space
```
### 9.4.
Форматируй код Python по следующему примеру:
```python
from .db import db
from config import Config
from flask import Flask
from flask_login import LoginManager
import os
def create_app():
    def initLM(a):
        from app.models import User
        from flask_login import LoginManager
        l = LoginManager()
        l.init_app(a)
        l.login_message = "Your session has expired. Please log in again."
        l.login_message_category = 'danger'
        l.login_view = 'auth.login'
        l.user_loader(lambda v: db.session.get(User, int(v)))

    def register_blueprints(a):
        for ma, p in [
            ('app.blueprints.accounting_routes.accounting_blueprint', '/accounting'),
            ('app.blueprints.auth_routes.auth_bp', '/auth'),
            ('app.blueprints.dashboard_routes.dashboard_bp', '/dashboard'),
            ('app.blueprints.settings_routes.settings_bp', '/settings'),
            ('app.blueprints.transactions_routes.transactions_bp', '/transactions'),
            ('app.blueprints.wallet_routes.wallet_bp', '/wallet'),
        ]:
            m, at = ma.rsplit('.', 1)
            a.register_blueprint(getattr(__import__(m, fromlist = [at]), at), url_prefix = p)

    r = Flask(__name__)

    @r.after_request
    def _(r):
        r.headers.update({
            'Cache-Control': 'no-store, no-cache, must-revalidate, proxy-revalidate, max-age=0'
            ,'Expires':'0'
            ,'Pragma':'no-cache'
        });
        return r

    @r.teardown_request
    def _(_):
        def l(v):
            from flask import request
            if not request.path.startswith('/static/'):
                print(f"DB POOL USAGE: `session.remove()`, {v}: {db.engine.pool.checkedout()}")
        l('before')
        db.session.remove()
        l('after')

    @r.template_filter('format_number')
    def _(v):
        try: x = float(v)
        except: x = 0
        return '0.00' if not x else f'{x:,.2f}' if abs(x) >= 1 else f'{x:,.5f}'

    r.config.from_object(Config)
    os.makedirs('uploads', exist_ok = True)
    r.config['UPLOAD_FOLDER'] = 'uploads'
    db.init_app(r)
    initLM(r)
    register_blueprints(r)
    db.create_all(app=r)
    return r
```

### 9.5.
Комментарии в коде не пиши.

### 9.6.
Пустые строки между строками кода разрешены только между функциями (`def`): полностью в соответствии с примером 9.4.

### 9.7.
Для строковых значений по возможности используй одинарные кавычки (полностью в соответствии с примером 9.4).

### 9.8.
Пункты 1-7 выше должны быть без изменения включены в prompt при запросе к OpenAI API.
## 10.
Пример правильного результата работы программы:
~~~
| № | Поисковый запрос | Релевантный? | Причины нерелевантности | Правило для Google Ads |
|---|-----------------|--------------|----------------------|---------------------|
| 1 | railcar mover rental | нет | 7.1, 7.3 | -`railcar mover` -rental |
| 2 | #1 pet mover | нет | 7.1, 7.3 | -`pet mover` |
| 3 | #1 us pet mover | нет | 7.1, 7.3 | -`pet mover` -`us pet` |
| 4 | √© preciso mover | нет | 7.1, 7.4 | -`preciso mover` |
| 5 | 02 01 mover 4029357733 can s618034583078548 card 3466 | нет | 7.1 | -`card` -`can` |
| 6 | 02 honda crv does not move then starts moving | нет | 7.1 | -`honda` -`crv` -`starts moving` |
| 7 | 1 2 x 170 inch belt mover deck | нет | 7.1, 7.3 | -`belt mover` -`mover deck` |
| 8 | 1 64 round bale mover | нет | 7.1, 7.3 | -`bale mover` |
| 9 | 1 bedroom long distance mover canada | нет | 7.2, 7.5 | -`1 bedroom` |
| 10 | 1 day mover salary | нет | 7.1, 7.4 | -`mover salary` |
~~~