## 1.
Клиент хочет выполнить следующий проект:
### 1.1. Title
Netsuite bulk upload for Asset Revaluation
### 1.2. Description
I need to do an asset revaluation in Netsuite for some assets (Fixed Assets - Transactions - Asset Revaluation).
When trying to import a csv for a bulk update, this error appears: "TypeError: Cannot read property 'value' of undefined"
Need someone specifically with experience in mass csv uploads for Asset Revaluation in Netsuite.

### 1.3. Tags
NetSuite Development
Oracle NetSuite
NetSuite Administration

## 2. В чём причина проблемы клиента?
### 2.1.
В 1-й раз я тебя спросил:
~~~
В чём причина проблемы клиента?
~~~

### 2.2.
Ты ответил:
~~~
Вероятнее всего, проблема связана с тем, что при массовом CSV-импорте не передаётся (или некорректно передаётся) хотя бы одно из обязательных полей, которое ожидает NetSuite. 

Сообщение об ошибке «TypeError: Cannot read property 'value' of undefined» обычно появляется в случаях, когда скрипт или сама система NetSuite пытаются получить доступ к полю или свойству, которого нет в переданных данных или которое неправильно сопоставлено при импорте. В контексте Asset Revaluation это может означать:

1. **Не хватает нужного столбца в CSV** (например, идентификатора актива, даты переоценки, новой стоимости или другого обязательного поля).
2. **Ошибочная или неполная настройка мэппинга полей** во время CSV-импорта в NetSuite (например, поле, которое должно содержать значение для переоценки, не сопоставлено или сопоставлено не с тем столбцом).
3. **Использование пользовательского (custom) скрипта или расширения**, в котором жёстко прописано ожидание определённых данных, но эти данные в CSV не приходят.

Чтобы устранить ошибку, нужно проверить:
- Правильность структуры и заголовков CSV-файла.
- Соответствие между столбцами CSV и полями NetSuite при настройке импорта (Mapping).
- Наличие всех требуемых полей (включая те, которые могут быть обязательными для NetSuite, но не очевидны на первый взгляд).
~~~

## 3. Какие поля являются обязательными?
### 3.1.
В 2-й раз я тебя спросил:
~~~
В пункте 2.2 ты писал:
```
не передаётся (или некорректно передаётся) хотя бы одно из обязательных полей, которое ожидает NetSuite. 
```
А какие поля являются обязательными?
~~~

### 3.2.
Ты ответил:
~~~
В целом в NetSuite нет одного «универсального» списка обязательных полей, который подходил бы всем клиентам одинаково — многое зависит от настроек учётной системы, используемых книг (asset books), обязательных пользовательских полей и т. д. Тем не менее для **стандартной** операции Asset Revaluation в модуле Fixed Assets Management в типовой конфигурации чаще всего требуются следующие поля (или их эквиваленты при мэппинге):

1. **Asset (Атив)**  
   - Ссылка на сам актив, который переоценивается (Internal ID, Name или Number — зависит от того, как настроена ваша система).  
   - Это может быть поле *Asset Name*, *Asset ID* или *Internal ID*, подгружаемое из таблицы активов в NetSuite.

2. **Book (Книга)**  
   - Указывает, в рамках какой книги (Asset Book) выполняется переоценка.  
   - Если у вас несколько книг учёта (например, бухгалтерская, налоговая, управленческая), вы должны выбрать конкретную книгу, для которой выполняется операция.

3. **Effective Date (Дата переоценки)**  
   - Дата, с которой должна действовать переоценка.  
   - Обязательно указывается с учётом формата, принятого в NetSuite (чаще всего это формат `MM/DD/YYYY`, если не настроено иначе).

4. **New Cost / Fair Value / Revaluation Amount (Новая стоимость или справедливая стоимость)**  
   - Поле, отражающее сумму, до которой «поднимается» или «опускается» стоимость актива.  
   - В одних конфигурациях это может называться *Revaluation Amount* (сумма переоценки), в других — *New Cost* (новая стоимость), в третьих — *Fair Value* (справедливая стоимость).  
   - Важно понимать, что NetSuite может ожидать отдельное поле именно для «Новое значение» и отдельное для «Старая стоимость» (либо система рассчитывает разницу автоматически).

5. **Account (Счёт учёта переоценки)**  
   - Иногда (в зависимости от настроек) требуется указать бухгалтерский счёт, который будет задействован при переоценке (например, счёт дооценки/уценки).  
   - Могут быть отдельные поля: *Gain/Loss Account* (для учёта прибыли/убытка от переоценки) и *Depreciation Expense Account* (для будущих расходов на амортизацию), если переоценка затрагивает эти параметры.

6. **Depreciation / Amortization Fields (Поля, связанные с амортизацией)**  
   - В некоторых случаях (особенно если переоценка изменяет срок полезного использования или метод амортизации) NetSuite требует указать новые значения для:  
     - *Depreciation Method* (метод амортизации),  
     - *Remaining Life* (остаточный срок) или *End Date* (дата окончания амортизации),  
     - *Salvage Value* (ликвидационная стоимость).  
   - Если при переоценке метод и сроки не меняются, эти поля могут быть необязательными, но зависят от настроек.

7. **Posting Period (Учётный период)**  
   - В некоторых конфигурациях NetSuite для транзакций обязательно указывается учётный период (например, *Sep 2024*).  
   - Если не заполнять, система может пытаться автоматически определить период на основе даты, но если у вас строгая политика закрытия периодов, могут возникать ошибки.

---

### Как определить, какие поля требуются именно в вашей системе

1. **Откройте настройки CSV Import** для Asset Revaluation (или похожую запись, если вы используете собственную кастомизацию). В меню **Setup** → **Import/Export** → **Import CSV Records** выберите тип записи (Record Type), связанный с переоценкой активов. На шаге **Field Mapping** вы увидите список доступных полей, а некоторые из них будут помечены как *Required*.

2. **Проверьте пользовательские поля (custom fields)**, которые могут быть сделаны обязательными (Required) в вашем аккаунте. Если администратор или интегратор установил обязательность для какого-то дополнительного поля (например, *Reason for Revaluation*, *Approval Status* и т. д.), то без заполнения этого поля CSV импорт выдаст ошибку.

3. **Посмотрите в документации NetSuite (Help Center)** по модулю Fixed Assets Management → CSV Import. Там часто есть глава, описывающая типовые поля, которые должны быть указаны для корректной переоценки.

4. **Учтите момент, что может работать SuiteScript** (User Event или Client Script), которое при сохранении записи «Asset Revaluation» требует дополнительные поля. Если такой скрипт «ждёт» данных, которых нет в CSV, может возникать ошибка вроде «Cannot read property 'value' of undefined». В этом случае нужно посмотреть логи (Execution Log) и код скрипта, чтобы выяснить, какое конкретно поле оно запрашивает.

---

### Резюме

Чтобы избежать ошибки «TypeError: Cannot read property 'value' of undefined», стоит убедиться, что в CSV-файле точно заполнены (и корректно сопоставлены) **Asset**, **Book**, **Effective Date**, **Revaluation Amount** (или *New Cost*), а также все поля, которые ваша система помечает как обязательные (включая возможные пользовательские). Затем перепроверьте, что нет настроенных скриптов (SuiteScript) или Workflows, которые могут вызывать ошибку при отсутствии дополнительной информации.

Если ошибка продолжает появляться, в логе импорта или в системных журналах NetSuite (Script Execution Log) обычно указывается, какое поле не удалось прочитать (хотя в случае «Cannot read property 'value' of undefined» иногда требуется ручной отладочный вывод). Но в любом случае начните с проверки **Field Mapping** и списка обязательных полей в вашем конкретном аккаунте.
~~~
