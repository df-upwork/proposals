# 1.
## 1.1.
`Aᨀ` ≔ (мой ответ `ꆜ`)

## 1.2.
Содержание `Aᨀ`:
~~~markdown
Ваша проблема наверняка вызвана одной из 2 причин:
1) Несоответствие способа входа конфигурации синхронизации групп
1.1) Суть
Пользователи пытаются войти в систему, используя своё имя участника-пользователя (UPN, например, `user@company.com`), в то время как конфигурация сервера по умолчанию требует использования имени группы Entra ID в качестве имени пользователя для групповой аутентификации.
1.2) Обоснование
Поведение аутентификации групп в Azure PostgreSQL Flexible Server регулируется параметром `pgaadauth.enable_group_sync`.
По умолчанию этот параметр часто бывает выключен.
Когда синхронизация выключена, пользователи, подключающиеся через членство в группе, должны указывать имя группы Entra ID в качестве имени пользователя (в psql или DBeaver), а свой личный токен доступа — в качестве пароля.
Если синхронизация включена, пользователи могут входить в систему, используя роль с тем же именем, что и их адрес электронной почты (UPN).
Если пользователи пытаются использовать свой UPN при выключенной синхронизации, PostgreSQL не сопоставит их с ролью группы.
Этот сценарий точно объясняет, почему прямые сопоставления пользователей (где вход осуществляется по UPN и существует соответствующая роль UPN) работают, а групповые — нет.
Это поведение часто является неочевидным для администраторов.
2) Недостаточные разрешения Microsoft Graph API
2.1) Суть
Identity, используемое сервером Azure PostgreSQL Flexible Server для интеграции с Entra ID, не имеет необходимых разрешений API для чтения информации о членстве пользователей в группах из Microsoft Graph.
2.2) Обоснование
Для авторизации пользователя на основе его членства в группе серверу PostgreSQL может потребоваться проверить это членство в Entra ID.
Эта проверка часто выполняется путем запроса к Microsoft Graph API, особенно если включен параметр `pgaadauth.enable_group_sync` или если информация о группах отсутствует в токене доступа (например, из-за "overage").
Для выполнения таких запросов удостоверение сервера должно иметь соответствующие разрешения в Entra ID, такие как `GroupMember.Read.All` или `Directory.Read.All`.
Предоставление этих разрешений требует согласия администратора тенанта и часто упускается при настройке.
Прямая аутентификация пользователя работает, поскольку она основана на идентификаторе объекта пользователя (OID), который всегда присутствует в токене, и не требует запросов к Graph API для проверки групп.
~~~

# 2.
# 2.1.
`Fⰳ(§p)` ≔ (Пункт `§p` из `Aᨀ`)

# 2.2.
`Fⰳ(§a-§b)` ≔ (Фрагмент `Aᨀ` с пункта `§a` по пункт `§b` включительно)

# 3.
`Fᨀ` ≔ `Fⰳ(1-2)`

# 4. `᛭T`
Проанализируй `Fᨀ`:
1) Есть ли там логические ошибки?
2) Есть ли там фактические ошибки?

# 5. Требования к твоему ответу
## 5.1.
Отвечай на русском языке.
## 5.2.
Мой вопрос не пересказывай.
## 5.3.
Уже сформулированную мной информацию не пересказывай.
## 5.4.
Писать свою версию `Fᨀ` не нужно: просто укажи свои замечания по пунктам.
## 5.5.
До и после списка замечаний ничего не пиши.
## 5.6.
Нумерация замечаний должна быть сквозной.
## 5.7.
Для каждого своего замечания указывай свою степень уверенности в нём по шкале от 0 до 100:
- 0 означает, что твоё замечание безосновательно (ошибочно).
- 100 означает, что ты полностью уверен в правоте своего замечания.

# 6. К чему не надо придираться
## 6.1.
Если большая часть `Fᨀ` — на русском языке, то не придирайся к смешению в `Fᨀ` русского и английского языков.
Это смешение — временное и будет устранено позже.