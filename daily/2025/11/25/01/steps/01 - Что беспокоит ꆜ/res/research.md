https://gemini.google.com/share/7e47c3669ed9


## **1. Введение: Операционный контекст и профилирование инцидента**

### **1.1. Характеристика субъекта и критичность инфраструктуры**

Рассматриваемый инцидент произошел в техническом контуре компании ꆜ — организации микро-сегмента, базирующейся в Брукфилде, США, и специализирующейся на секторе «Финансы и Бухгалтерия». Несмотря на ограниченный штат (2-9 сотрудников), цифровой след компании на платформе Upwork свидетельствует о непропорционально высокой зависимости бизнес-модели от эффективности почтовой инфраструктуры. Совокупные расходы, превышающие $41,000, и высокая активность в найме экспертов узкого профиля (83% hire rate) указывают на то, что email-маркетинг и транзакционные рассылки являются не вспомогательной функцией, а критическим бизнес-активом, вероятно, обеспечивающим основной поток ликвидности и коммуникации с институциональными инвесторами.

Анализ исторических проектов субъекта (P1⁎ — P7⁎) позволяет реконструировать эволюцию их технического стека. Компания прошла путь от использования стандартных SaaS-решений до развертывания сложной, кастомной in-house платформы доставки почты (ESP). Текущая конфигурация включает использование Postal в качестве управляющего интерфейса, Docker-контейнеризацию, базы данных MariaDB и, что наиболее критично для данного исследования, сложную систему маршрутизации на базе Postfix. Масштаб инфраструктуры, включающий 512 выделенных IP-адресов и управление 50,000 поддоменов, выводит задачу из разряда типичного системного администрирования в область архитектуры высоких нагрузок (High Load) и управления репутацией в промышленных масштабах.

### **1.2. Феноменология сбоя (P†)**

Центральной проблемой, инициировавшей данное исследование, является критический сбой маршрутизации (routing failure), зафиксированный в проекте P⁎. Формулировка проблемы содержит ключевые технические маркеры:

«We are experiencing a routing failure in our custom multi-MTA email setup after switching from HAProxy to a Postfix-based internal router using transport_maps».

Данный сбой возник непосредственно после архитектурной миграции — отказа от использования HAProxy в качестве пограничного балансировщика и перехода на использование Postfix в качестве внутреннего маршрутизатора. Симптоматика сбоя, согласно контексту проектов P4⁎ и P5⁎, выражается в нарушении детерминированности исходящего трафика: письма, которые должны отправляться с конкретных выделенных IP-адресов (привязанных к определенным клиентам или маркетинговым кампаниям), уходят с дефолтного интерфейса сервера или маршрутизируются неверно. Для финансовой организации это несет экзистенциальные риски: утечка «грязного» трафика на премиальные IP-адреса или, наоборот, попадание транзакционных писем в пулы для «холодных» рассылок, приводит к немедленной деградации репутации домена и блокировке со стороны крупных провайдеров (Gmail, Outlook).

### **1.3. Цели и методология исследования**

Настоящий отчет ставит своей целью не просто устранение симптомов, но и глубинный анализ корневых причин (Root Cause Analysis), приведших к архитектурному конфликту. Мы рассмотрим:

1. Фундаментальные различия в моделях обработки трафика HAProxy и Postfix, которые сделали миграцию необходимой, но рискованной.  
2. Внутренние механизмы демона trivial-rewrite в Postfix и иерархию таблиц маршрутизации, ставшую причиной конфликта.  
3. Проблематику масштабирования конфигурации master.cf для поддержки 512 интерфейсов.  
4. Влияние автоматизированных средств управления конфигурацией (Postal) на стабильность системы.

Анализ базируется на верифицированных технических данных, документации Postfix и эмпирических данных сообщества системных архитекторов.

---

## **2. Архитектурная ретроспектива: Эпоха HAProxy и причины миграции**

Для полного понимания природы текущего сбоя необходимо детально разобрать архитектуру, от которой отказался клиент. Отказ от HAProxy не был случайным; он был продиктован фундаментальными ограничениями протоколов L4/L7 OSI в контексте задач современной почтовой доставки.

### **2.1. Ограничения HAProxy в SMTP-маршрутизации**

В традиционных высоконагруженных системах HAProxy используется как надежный балансировщик нагрузки. Сниппет 1 четко определяет границы применимости HAProxy в почтовых системах: он идеален для распределения входящего трафика между пулом идентичных MX-серверов, но абсолютно непригоден для сложной логической маршрутизации исходящей почты.

Проблема кроется в "слепоте" HAProxy к контексту SMTP-конверта. HAProxy оперирует потоками TCP. Он может, используя инспекцию пакетов, увидеть команду EHLO или MAIL FROM, но принятие сложного решения о маршрутизации на основе комбинации "Отправитель + Получатель + Текущая репутация IP" выходит за рамки его штатных возможностей. Сниппет 1 подтверждает: HAProxy не может выбирать бэкенд на основе доменного имени в SMTP так же легко, как он делает это в HTTP (на основе заголовка Host), из-за особенностей протокола SMTP, где передача метаданных размазана по сессии.

### **2.2. Проблема Proxy Protocol и потери IP-адреса**

Одной из причин использования HAProxy перед Postfix часто является необходимость скрыть топологию бэкендов и обеспечить единую точку входа. Однако это порождает проблему потери исходного IP-адреса клиента. Postfix видит подключение от локального HAProxy, а не от реального отправителя. Для решения этой проблемы был разработан Proxy Protocol (v1 и v2), который Postfix начал поддерживать относительно недавно (с версии 2.10, согласно 2 и 2).

Хотя Proxy Protocol решает проблему видимости входящего IP для входящей почты, он не помогает в управлении *исходящей* маршрутизацией. Клиенту требовалось решение, которое могло бы детерминированно направлять почту на один из 512 IP-адресов. HAProxy, будучи прокси-сервером, не имеет собственных механизмов очереди и повторной доставки (retry), критичных для MTA. Если целевой интерфейс недоступен, HAProxy просто разрывает соединение, что недопустимо для надежной доставки.2

### **2.3. Императив перехода на внутренний маршрутизатор Postfix**

Осознав эти ограничения, Клиент принял стратегически верное, но тактически сложное решение: перенести логику распределения трафика на уровень приложения (Application Layer), то есть на Postfix.  
Postfix, в отличие от HAProxy, является полноценным MTA. Он обладает:

* **Очередями:** Письма не теряются при временной недоступности канала.  
* **Глубокой инспекцией:** Демоны Postfix (smtpd, cleanup) имеют полный доступ к заголовкам и конверту письма.  
* **Механизмами перезаписи:** Canonical maps, masquerading и generic maps позволяют модифицировать письмо на лету.3

Однако, перейдя на Postfix как на "маршрутизатор", Клиент столкнулся с жесткостью его внутренних таблиц маршрутизации, что и привело к инциденту P†.

---

## **3. Анатомия сбоя: Конфликт приоритетов в подсистеме trivial-rewrite**

Центральным узлом, в котором произошел сбой, является демон trivial-rewrite. Именно этот компонент Postfix отвечает за принятие решения: "Куда и как отправить это письмо?". Анализ показывает, что Клиент столкнулся с неочевидным, но документированным конфликтом между transport_maps и механизмами маршрутизации, зависимыми от отправителя.

### **3.1. Иерархия принятия решений о маршрутизации**

В конфигурации Postfix существует строгая, жестко закодированная иерархия параметров, определяющих выбор транспорта (агента доставки) и следующего узла (nexthop). Ошибка Клиента заключается в предположении, что разные карты маршрутизации работают аддитивно или что более специфичное правило (по отправителю) автоматически перекроет более общее.

Согласно технической документации 4, приоритет выбора транспорта (delivery transport) выглядит следующим образом (в порядке убывания важности):

| Уровень приоритета | Параметр конфигурации (main.cf) | Механизм действия | Источник данных |
| :---- | :---- | :---- | :---- |
| **1 (Высший)** | **transport_maps** | Безусловный маппинг на основе **адреса получателя** (Recipient Address). Если найдено совпадение (включая wildcard), поиск прекращается. | 4 |
| **2** | sender_dependent_default_transport_maps | Маппинг на основе **адреса отправителя** (Sender Address). Проверяется *только* если в transport_maps не найдено соответствия. | 4 |
| **3** | default_transport | Глобальный транспорт по умолчанию для всех писем, не попавших под критерии выше. | 5 |
| **4 (Низший)** | relayhost | Узел пересылки по умолчанию (влияет на nexthop, но транспорт обычно берется из default_transport). | 4 |

### **3.2. Реконструкция сценария сбоя**

Опираясь на описание проблемы "routing failure... using transport_maps" в P†, мы можем с высокой точностью реконструировать конфигурационную ошибку.

1. **Задача Клиента:** Обеспечить ротацию IP-адресов для разных клиентов. Например, письма от customer_A@domain.com должны уходить через интерфейс 192.0.2.10, а от customer_B@domain.com — через 192.0.2.20.  
2. **Попытка реализации:** Клиент, вероятно, настроил sender_dependent_default_transport_maps для реализации этой логики. Это правильный шаг.7  
3. **Вмешательство transport_maps:** Одновременно с этим, в конфигурации остался активным параметр transport_maps. Это могло произойти по нескольким причинам:  
   * Артефакты старой конфигурации.  
   * Автоматическая генерация файла transport панелью управления Postal (Postal часто создает дефолтные транспорты).  
   * Попытка оптимизировать доставку на крупные домены (например, gmail.com smtp:special-relay).  
4. **Механизм коллизии:** Когда в систему поступает письмо от customer_A@domain.com (которому назначен спец-транспорт по отправителю) на адрес dest@gmail.com, демон trivial-rewrite сначала сканирует transport_maps. Если там есть запись для gmail.com (или wildcard *), Postfix **немедленно** применяет указанный там транспорт.  
5. **Результат:** Проверка sender_dependent_default_transport_maps **даже не выполняется**. Письмо уходит через транспорт, указанный в transport_maps (обычно это дефолтный smtp без привязки к конкретному IP). Происходит утечка основного IP-адреса сервера.

Это полностью объясняет формулировку Клиента: система "сломалась" именно при введении transport_maps в уравнение.

### **3.3. Роль параметра sender_dependent_relayhost_maps**

Часто администраторы путают sender_dependent_default_transport_maps и sender_dependent_relayhost_maps. Различие критично:

* sender_dependent_default_transport_maps меняет **весь транспорт** (программу доставки и параметры, включая bind_address).  
* sender_dependent_relayhost_maps меняет только **хост назначения** (nexthop), но использует транспорт по умолчанию (smtp).4

Если Клиент использовал второй вариант, он мог изменить только *куда* идет письмо, но не *откуда* (с какого IP) оно уходит, так как bind_address привязан к транспорту, а не к хосту назначения. Сниппет 9 демонстрирует похожую проблему, где relayhost_maps не давал нужного эффекта переопределения транспорта.

---

## **4. Проблематика масштабирования: Управление 512 IP-адресами**

Второй слой проблемы, не менее критичный, чем логика маршрутизации, касается физической реализации отправки с 512 различных IP-адресов. Postfix не имеет встроенного механизма "Pool Rotation" в том виде, в каком он присутствует в специализированном ПО для рассылок (например, PowerMTA).

### **4.1. Статическая природа smtp_bind_address**

Параметр smtp_bind_address, отвечающий за выбор исходящего IP-адреса, является параметром клиента SMTP. Сниппеты 4 подтверждают: этот параметр задает IP-адрес, к которому биндится сокет при создании исходящего соединения.

Критическое ограничение заключается в том, что smtp_bind_address не может быть выбран динамически на основе таблицы внутри одного процесса доставки. Нельзя написать правило: "Если отправитель X, то используй smtp_bind_address=Y".  
Для использования другого IP необходимо запустить другой экземпляр (сервис) клиента SMTP с другими аргументами командной строки в master.cf.12

### **4.2. "Взрыв" файла master.cf**

Для поддержки 512 IP-адресов Клиенту необходимо объявить 512 уникальных сервисов в файле master.cf. Конфигурация должна выглядеть следующим образом:

| Имя сервиса | Тип | Параметры запуска |
| :---- | :---- | :---- |
| out-001 | unix | smtp -o smtp_bind_address=192.0.2.1 -o smtp_helo_name=mta1.domain.com |
| out-002 | unix | smtp -o smtp_bind_address=192.0.2.2 -o smtp_helo_name=mta2.domain.com |
| ... | ... | ... |
| out-512 | unix | smtp -o smtp_bind_address=192.0.2.254 -o smtp_helo_name=mta512.domain.com |

**Вызовы такой архитектуры:**

1. **Управление конфигурацией:** Ручное редактирование файла такого размера (тысячи строк) неизбежно приведет к ошибкам ("fat-finger error").  
2. **Ресурсоемкость:** Хотя Postfix запускает процессы по требованию (on-demand), наличие 512 потенциальных сервисов требует корректной настройки лимитов процессов (default_process_limit) в main.cf. Если лимит слишком низок, письма будут застревать в очереди, ожидая свободного слота для конкретного IP-транспорта.  
3. **HELO/EHLO Alignment:** Сниппет 12 подчеркивает важность параметра smtp_helo_name. Для каждого IP должна быть настроена уникальная PTR-запись в DNS, и Postfix должен представляться именно этим именем. Использование общего $myhostname для всех 512 IP приведет к массовому попаданию в спам (mismatch между IP и HELO).

### **4.3. Альтернатива: Multi-Instance архитектура**

Сниппеты 15 предлагают альтернативный подход: запуск нескольких независимых экземпляров Postfix (Multi-Instance), каждый со своим файлом конфигурации main.cf и своим IP-адресом.

* **Плюсы:** Полная изоляция очередей. Если один IP попадает в блэклист и очередь забивается отбоями, это не влияет на другие инстансы.  
* Минусы: Администрирование 512 экземпляров Postfix — задача на порядок сложнее, чем управление одним файлом master.cf. Требует значительных ресурсов памяти и CPU на оверхед процессов.  
  В контексте P†, где речь идет о "Postfix-based internal router" (единственное число), вероятнее всего используется схема с единым инстансом и множеством транспортов.

### **4.4. Проблема "Randmap" и балансировка нагрузки**

В сниппетах 7 и 17 упоминается использование randmap для рандомизации выбора транспорта:  
sender_dependent_default_transport_maps = randmap:{transport1, transport2...}.  
Это решение часто используется для ротации IP внутри пула. Однако, в старых версиях Postfix или при неправильном синтаксисе, randmap может работать некорректно или кэшироваться слишком агрессивно (smtp_connection_cache_on_demand), что приводит к неравномерному распределению нагрузки. Кроме того, требование "Deterministic org/Return-Path" (P5D) прямо противоречит идее случайной ротации. Клиенту нужна детерминированная, а не случайная привязка.

---

## **5. Аспект безопасности и доставляемости (Deliverability)**

Переход на собственную инфраструктуру с выделенными IP накладывает на Клиента полную ответственность за репутацию этих IP.

### **5.1. Утечка IP (IP Leakage)**

Наиболее критичный риск, описанный в P5D, — «no main server IP leaks». Если маршрутизация сбоит (например, не найдено правило в карте), Postfix по умолчанию использует транспорт default_transport (обычно smtp) и системный интерфейс по умолчанию.  
Это приводит к тому, что письма разных клиентов начинают уходить с одного и того же (управляющего) IP.

* **Последствие 1:** Смешивание репутации. "Токсичный" клиент может испортить репутацию чистого IP.  
* **Последствие 2:** Блокировка управляющего IP. Если управляющий IP попадет в RBL (Real-time Blackhole List), администратор может потерять доступ к серверу или способность отправлять сервисные уведомления.

### **5.2. JA3 Fingerprinting и TLS Personas**

В описании проекта P5⁎ упоминаются "JA3/TLS personas" и "wire-level proof". Это указывает на высокий уровень зрелости противника (спам-фильтров), с которым борется Клиент. Современные системы защиты (Cloudflare, Gmail) анализируют не только IP и домен, но и отпечаток TLS-клиента (JA3 hash), который зависит от версии OpenSSL, набора шифров и порядка расширений в ClientHello.

* **Влияние HAProxy:** HAProxy позволял централизованно управлять параметрами TLS.  
* **Влияние Postfix:** Каждый процесс smtp в Postfix использует системную библиотеку OpenSSL. Настройка уникальных "TLS персон" для разных транспортов в Postfix крайне затруднена и требует либо патчинга исходного кода, либо сложной манипуляции с tls_policy_maps и версиями библиотек, что значительно сложнее, чем в специализированных прокси.

---

## **6. Рекомендации по устранению сбоя и оптимизации**

На основе проведенного анализа предлагается комплексный план действий для разрешения инцидента P†.

### **6.1. Разрешение конфликта приоритетов (Immediate Mitigation)**

Необходимо устранить конкуренцию между transport_maps и sender_dependent_default_transport_maps.

1. **Аудит transport_maps:** Проверить содержимое файла (обычно /etc/postfix/transport).  
2. **Исключение общих правил:** Удалить любые записи вида *, . или перечисления популярных доменов (gmail.com, yahoo.com), если они не требуют специфической *внутренней* маршрутизации (например, доставка на локальный LMTP для Dovecot).  
3. **Стратегическое переключение:** Если transport_maps используется Postal для внутренней логики, необходимо перенести логику внешнего роутинга полностью в sender_dependent_default_transport_maps.  
4. **Команда диагностики:** Использовать postmap -q для симуляции принятия решений:  
   Bash  
   # Проверка, какой транспорт выберет Postfix для письма от clientA на gmail.com  
   postmap -q "clientA@domain.com" hash:/etc/postfix/sender_transport  
   # Сравнение с глобальным транспортом  
   postmap -q "gmail.com" hash:/etc/postfix/transport

   Если вторая команда возвращает результат, он перекроет первую. Это необходимо исправить удалением записи из второй карты.

### **6.2. Автоматизация генерации master.cf (Infrastructure as Code)**

Управление 512 транспортами вручную недопустимо. Рекомендуется внедрить скрипт (Python/Bash), который генерирует секцию master.cf на основе CSV-файла или БД с IP-адресами.

**Пример шаблона генерации:**

# **Генерируемый блок для IP 192.0.2.10**

out-192-0-2-10 unix - - n - - smtp  
-o smtp_bind_address=192.0.2.10  
-o smtp_helo_name=mta-10.client-domain.com  
-o syslog_name=postfix-10  
Скрипт должен также проверять наличие соответствующих записей в sender_dependent_default_transport_maps.

### **6.3. Защита от утечки IP (Fail-Safe Configuration)**

Для реализации требования «No IP leaks» необходимо изменить поведение по умолчанию.  
В main.cf следует установить:

Code snippet

default_transport = error:No routing defined for this sender. Contact admin.

**Механизм действия:** Если для отправителя не найдено правило в sender_dependent_default_transport_maps (и transport_maps пуст для назначения), Postfix не попытается отправить письмо с дефолтного IP, а немедленно вернет ошибку (bounce) отправителю. Это гарантирует, что ни один пакет не уйдет с "запрещенного" интерфейса.

### **6.4. Тюнинг ядра ОС для High Volume SMTP**

С 512 IP-адресами на одном хосте возможны проблемы с исчерпанием эфемерных портов, если трафик очень велик.  
Рекомендуемые параметры sysctl:

* net.ipv4.ip_local_port_range: Расширить диапазон.  
* net.ipv4.tcp_tw_reuse: Включить для быстрого переиспользования сокетов в состоянии TIME-WAIT.  
* Увеличение лимитов файловых дескрипторов (ulimit -n) для процесса Postfix.

### **6.5. Будущая архитектура: Разделение ролей**

В долгосрочной перспективе, учитывая рост требований (JA3, сложные политики), Клиенту стоит рассмотреть возврат к двухуровневой архитектуре, но с правильной конфигурацией:

1. **Frontend (Postfix):** Занимается приемом почты, очередями, DKIM-подписью и логической маршрутизацией (выбор транспорта).  
2. **Egress Layer (Nginx/Envoy или патченный HAProxy):** Занимается только терминацией TLS и привязкой к IP. Postfix передает трафик на локальные порты Egress-слоя, который уже биндится к внешним интерфейсам. Это позволит гибко управлять TLS-параметрами без пересборки Postfix.

---

## **7. Сводная таблица параметров конфигурации для решения P†**

| Параметр main.cf | Значение | Обоснование | Источник |
| :---- | :---- | :---- | :---- |
| transport_maps | (Пусто) или только локальные маршруты | Исключить конфликт приоритетов. | 4 |
| sender_dependent_default_transport_maps | hash:/etc/postfix/sender_transport | Основной механизм выбора исходящего IP. | 7 |
| default_transport | error:Routing failure protection | Защита от утечки основного IP при сбое маппинга. | 4 |
| smtp_connection_cache_on_demand | no | Предотвращение использования кэшированного соединения с неправильного IP. | 12 |
| sender_dependent_relayhost_maps | (Не использовать) | Меняет только nexthop, но не транспорт (IP). Не подходит для задачи. | 4 |

## **8. Заключение**

Анализ показывает, что инцидент в инфраструктуре ꆜ является классическим примером "конфликта роста". Инструменты, идеальные для стандартных задач (стандартный Postfix routing), оказываются недостаточными или требующими нетривиальной конфигурации при масштабировании до уровня провайдера услуг (ESP).

Ключ к решению лежит в строгом соблюдении иерархии приоритетов Postfix, отказе от конфликтующих карт маршрутизации и внедрении практик "Infrastructure as Code" для управления массивными конфигурационными файлами. Предложенная стратегия Fail-Safe с использованием транспорта error обеспечит необходимый уровень безопасности репутации, критичный для бизнеса Клиента.

#### **Works cited**

1. haproxy - Postfix/Dovecot relay or proxy? - Server Fault, accessed November 25, 2025, [https://serverfault.com/questions/1152899/postfix-dovecot-relay-or-proxy](https://serverfault.com/questions/1152899/postfix-dovecot-relay-or-proxy)  
2. Efficient SMTP Relay Infrastructure With Postfix & Load Balancers - HAProxy Technologies, accessed November 25, 2025, [https://www.haproxy.com/blog/efficient-smtp-relay-infrastructure-with-postfix-and-load-balancers](https://www.haproxy.com/blog/efficient-smtp-relay-infrastructure-with-postfix-and-load-balancers)  
3. Postfix Address Rewriting, accessed November 25, 2025, [https://www.postfix.org/ADDRESS_REWRITING_README.html](https://www.postfix.org/ADDRESS_REWRITING_README.html)  
4. Postfix Configuration Parameters, accessed November 25, 2025, [https://www.postfix.org/postconf.5.html](https://www.postfix.org/postconf.5.html)  
5. Postfix manual - transport(5), accessed November 25, 2025, [https://www.postfix.org/transport.5.html](https://www.postfix.org/transport.5.html)  
6. postconf(5) — postfix - openSUSE Manpages Server, accessed November 25, 2025, [https://manpages.opensuse.org/Tumbleweed/postfix/postconf.5.en.html](https://manpages.opensuse.org/Tumbleweed/postfix/postconf.5.en.html)  
7. How to configure Postfix with transport_maps and randmap? - Stack Overflow, accessed November 25, 2025, [https://stackoverflow.com/questions/62561912/how-to-configure-postfix-with-transport-maps-and-randmap](https://stackoverflow.com/questions/62561912/how-to-configure-postfix-with-transport-maps-and-randmap)  
8. Postfix Configuration Parameters, accessed November 25, 2025, [https://postfix.cs.utah.edu/postconf.5.html](https://postfix.cs.utah.edu/postconf.5.html)  
9. Transport and sender transport maps problem -- Looking for a solution : r/postfix - Reddit, accessed November 25, 2025, [https://www.reddit.com/r/postfix/comments/zeezmt/transport_and_sender_transport_maps_problem/](https://www.reddit.com/r/postfix/comments/zeezmt/transport_and_sender_transport_maps_problem/)  
10. How to make Postfix use another IP address? - Server Fault, accessed November 25, 2025, [https://serverfault.com/questions/92181/how-to-make-postfix-use-another-ip-address](https://serverfault.com/questions/92181/how-to-make-postfix-use-another-ip-address)  
11. Postfix, der sichere Mailserver (MTA) unter CentOS 7.x [Linux - Wissensdatenbank], accessed November 25, 2025, [https://dokuwiki.nausch.org/doku.php/centos:mail_c7:mta_1](https://dokuwiki.nausch.org/doku.php/centos:mail_c7:mta_1)  
12. Postfix - outbound SMTP traffic going out wrong interface - Server Fault, accessed November 25, 2025, [https://serverfault.com/questions/1039222/postfix-outbound-smtp-traffic-going-out-wrong-interface](https://serverfault.com/questions/1039222/postfix-outbound-smtp-traffic-going-out-wrong-interface)  
13. How to email FROM specific IPs, using Linux and Postfix - Jonathan Puddle, accessed November 25, 2025, [https://jonathanpuddle.com/blog/2008/how-to-email-from-specific-ips-using-linux-and-postfix](https://jonathanpuddle.com/blog/2008/how-to-email-from-specific-ips-using-linux-and-postfix)  
14. Multiple postfix output IP - Stack Overflow, accessed November 25, 2025, [https://stackoverflow.com/questions/30420443/multiple-postfix-output-ip](https://stackoverflow.com/questions/30420443/multiple-postfix-output-ip)  
15. Managing multiple Postfix instances on a single host, accessed November 25, 2025, [https://www.postfix.org/MULTI_INSTANCE_README.html](https://www.postfix.org/MULTI_INSTANCE_README.html)  
16. Postfix SMTP Multiple Instances with IP Rotation on a Single VPS - LinuxBabe, accessed November 25, 2025, [https://www.linuxbabe.com/mail-server/postfix-multiple-instances-ip-rotation-on-a-single-vps](https://www.linuxbabe.com/mail-server/postfix-multiple-instances-ip-rotation-on-a-single-vps)  
17. Outbound Email Loadbalance with Multiple IPs - postfix - Server Fault, accessed November 25, 2025, [https://serverfault.com/questions/426060/outbound-email-loadbalance-with-multiple-ips](https://serverfault.com/questions/426060/outbound-email-loadbalance-with-multiple-ips)