1) В первую очередь надо включить проксирование (Proxy) для всех критически важных DNS-записей
Убедитесь, что в разделе DNS у домена все записи (A, CNAME), связанные с веб-трафиком, переведены в «Proxied» (оранжевая облачка), а не в «DNS only» (серый значок).
2) Надо скрыть реальный IP и закрыть прямые соединения
Другими словами, надо убедиться, что пользователи не могут обойти Cloudflare, обратившись к серверу по его IP.
Для этого можно ограничить доступ на уровне брандмауэра (iptables, Security Groups и т. д.), разрешив входящий трафик только с IP Cloudflare.
3) В разделе  «Security» → «Overview» в Cloudflare имеет смысл временно включить «I’m Under Attack Mode». 
Это добавит JavaScript-челленджи для всех новых посетителей.
4) В разделе «Security» → «WAF» → «Rate Limiting» имеет смысл создать правило, ограничивающее число запросов в секунду/минуту с одного IP или подсети. 
Например: «Если с одного IP за 1 минуту поступает больше 100 запросов — применить блокировку или CAPTCHA-челлендж».
5) В разделе «WAF» → «Managed Rulesets» я рекомендую активировать основной пакет правил Cloudflare: «OWASP Core Ruleset».
6) Далее, имеет смысл создать собственные правила, чтобы фильтровать трафик по ряду критериев: IP-адрес, геолокация, User-Agent, HTTP-метод, URI-путь и т. п.
Например:
6.1) Блокировать или выдавать CAPTCHA для всех запросов из стран, где не ведётся бизнес.
6.2) Блокировать запросы с определёнными подозрительными User-Agent.
6.3) Ограничивать доступ к административным URL интернет-магазина по списку разрешённых IP.
7) Далее, имеет смысл включить «Bot Fight Mode» (в разделе «Bots»).
8) У Cloudflare на тарифах Pro, Business, Enterprise имеется дополнительная функциональность «Bot Management».
8.1) При наличии функциональности «Bot Management» Cloudflare анализирует поведение пользователя, заголовки, браузерные данные и т. д., чтобы отличать реальные браузеры от ботов.
В этом случае Cloudflare анализирует поведение пользователя, заголовки, браузерные данные и т. д., чтобы отличать реальные браузеры от ботов.
8.2) На основе отчётов (Bot Analytics) имеет смысл создать кастомные правила: например, если Bot Score < 30, выдавать «JS Challenge» или «Block».
