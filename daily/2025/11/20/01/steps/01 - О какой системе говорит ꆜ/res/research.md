https://gemini.google.com/share/7ab445893c54


## **1. Исполнительное резюме и архитектура инцидента**

### **1.1. Введение в проблематику цифрового наследия**

В современной экосистеме информационных технологий термин «legacy» (унаследованное ПО) часто воспринимается как синоним устаревания, однако в критических инфраструктурных узлах — от промышленного производства до специализированных систем учета — программные продукты, разработанные в 1990-х годах, продолжают выполнять функции, не поддающиеся простой замене. Рассматриваемый инцидент, связанный с полным отказом сервера под управлением операционной системы семейства Windows (предположительно Windows NT 4.0 или Windows 2000), на котором функционировал программный комплекс, идентифицируемый клиентом ꆜ как «Lighthouse 3.7», представляет собой классический пример «технологического разрыва».

Ситуация усугубляется полной потерей институциональной памяти: компания-разработчик, по заявлению клиента, прекратила свое существование более двух десятилетий назад, документация отсутствует, а персонал, обладавший компетенциями по эксплуатации, недоступен. Анализ заявки P⁎ выявляет критическое противоречие между описанием исторического контекста («software is from the 90s») и ожидаемыми результатами («Deliverables»), включающими современные метрики веб-производительности («performance audits», «accessibility»). Это несоответствие требует не просто технического вмешательства, но и глубокого семантического анализа для разделения фактов о реальной системе и когнитивных искажений, вызванных современной информационной средой.

Данный отчет представляет собой исчерпывающее руководство по идентификации артефакта Lᨀ, анализу его вероятной архитектуры и пошаговой реализации стратегии восстановления (Disaster Recovery) в условиях отсутствия исходных кодов и дистрибутивов.

### **1.2. Профиль инцидента и исходные данные**

Согласно онтологии O.md, мы имеем дело с катастрофическим сбоем («The server crashed»), который привел к недоступности приложения, установленного в директорию C:3.7 (или иной диск, но в корневую папку). Указание на установку в корень («root directory») является мощнейшим хронологическим маркером. В эпоху DOS и Windows 3.1/95 разработчики часто избегали использования директории Program Files из-за ограничений файловой системы FAT16 на длину имен файлов (формат 8.3) и проблем с пробелами в путях. Наименование папки 3.7 указывает на то, что версия ПО была зафиксирована в структуре каталогов, что характерно для инженерного и специализированного софта того периода, где возможность параллельной работы разных версий была критична.

Клиент ꆜ демонстрирует высокий уровень тревожности и низкий уровень технической компетенции в вопросах исторического ПО, что подтверждается смешением терминологии. Анализ метаданных клиента показывает, что он базируется в США (Нью-Йорк), что сужает круг поиска потенциальных вендоров ПО до североамериканского рынка 90-х годов, хотя и не исключает импортных решений.

### **1.3. Методология исследования**

В ходе подготовки данного отчета был проведен перекрестный анализ более 190 исследовательских фрагментов (research snippets), охватывающих техническую документацию, патч-ноуты, форумы поддержки и исторические справки о слияниях и поглощениях IT-компаний периода 1985–2005 годов. Применены методы дифференциальной диагностики: каждая потенциальная система-кандидат проверялась на соответствие набору критериев (платформа Windows, период 90-х, версия 3.7, исчезновение вендора, специфика установки).

---

## **2. Дифференциальная диагностика и идентификация целевой системы (Lᨀ)**

Центральной проблемой восстановления является омонимия. Название «Lighthouse» (Маяк) является одним из самых распространенных в индустрии ПО, символизируя навигацию, освещение пути или безопасность. Ниже приведен детальный анализ кандидатов, ранжированных по вероятности совпадения с профилем Lᨀ.

### **2.1. Гипотеза Альфа: National Instruments (ранее Georgetown Systems) Lookout**

Наиболее вероятным кандидатом, скрывающимся за названием «Lighthouse 3.7», является система **Lookout**, первоначально разработанная компанией **Georgetown Systems**.

#### **2.1.1. Этимология ошибки идентификации**

Почему клиент называет программу «Lighthouse», если она называется «Lookout»? Ответ кроется в визуальной семиотике интерфейсов 90-х годов. Исследовательские данные 1 содержат критически важное указание: в документации к оборудованию National Instruments (модули FieldPoint) упоминается запуск сервиса lktsrv.exe и явно сказано: «right-click the lighthouse icon in the PC's system task tray».

Иконка маяка была основным визуальным идентификатором запущенного процесса сервера Lookout. Для оператора, не являющегося системным администратором, название программы тождественно её иконке. Если оператор годами нажимал на «маяк», чтобы проверить статус системы, для него программа стала «Lighthouse».

#### **2.1.2. Хронологическое и корпоративное соответствие**

Компания Georgetown Systems была активна в середине 90-х годов. В 1996 году она была поглощена корпорацией **National Instruments** (NI). Для внешнего наблюдателя или клиента, купившего софт у Georgetown Systems до 1996 года, компания действительно «вышла из бизнеса» («went out of business»), так как бренд перестал существовать как независимая единица.

Версионность также идеально совпадает. Версии Lookout 3.5, 3.7 и 3.8 были рабочими лошадками индустриальной автоматизации в период 1997–1999 годов, работая на Windows NT 4.0. Это полностью соответствует заявлению клиента о софте из 90-х.1

#### **2.1.3. Техническая архитектура Lookout 3.7**

Lookout представляет собой SCADA/HMI систему (Supervisory Control and Data Acquisition). Это объясняет критичность сбоя: система, вероятно, управляет физическим оборудованием или мониторит его. Установка в корень диска была стандартной практикой для SCADA-систем того времени для минимизации путей и упрощения скриптования.

Ключевые характеристики файлов, которые мы ожидаем найти при восстановлении:

* Исполняемые файлы: lookout.exe, lktsrv.exe.  
* Файлы проектов: .L4P, .LKP, .LKS.  
* Зависимости: Драйверы для взаимодействия с PLC (программируемыми логическими контроллерами) через COM-порты (RS-232/485) или проприетарные платы расширения.

### **2.2. Гипотеза Бета: Унаследованные ERP/CRM системы на базе FoxPro**

Вторым по силе кандидатом является класс программного обеспечения для управления бизнесом (ERP), разработанный на базе СУБД **FoxPro** или **Visual FoxPro**.

#### **2.2.1. Lighthouse Info Systems и архитектура FoxPro**

Исторические данные указывают на компанию **Lighthouse Info Systems**, основанную в 1987 году, которая выпускала ERP-решения, изначально построенные на платформе FoxPro.2 Хотя сама компания базируется в Индии и существует до сих пор, в 90-е годы на рынке США действовало множество реселлеров и локальных разработчиков, использовавших подобные названия.

#### **2.2.2. Специфика установки «Root Directory»**

Приложения на базе FoxPro (особенно версии 2.6 для Windows и ранние Visual FoxPro 3.0/5.0) печально известны своей зависимостью от коротких путей. Ограничения движка базы данных xBase часто приводили к ошибкам при работе с путями, содержащими пробелы (как Program Files). Поэтому инсталляторы того времени по умолчанию предлагали пути вида C:LIGHTHSE или C:LH37. Папка 3.7 могла быть создана администратором для обозначения версии конкретного билда.

#### **2.2.3. Профиль данных**

Если Lᨀ относится к этому классу, то при восстановлении на диске будут обнаружены:

* Таблицы данных: .DBF (основа хранения информации).  
* Индексные файлы: .CDX или .IDX.  
* Мемо-поля: .FPT.  
* Программы: .FXP (скомпилированный код FoxPro) или .EXE.

### **2.3. Гипотеза Гамма: Специализированное ПО для мониторинга частиц**

Компания **Lighthouse Worldwide Solutions** специализируется на системах мониторинга загрязнений (particle counters).5

* **Релевантность**: Их ПО (LMS Express, LMS XChange) используется в «чистых комнатах» и на производстве. Это критически важные системы, простой которых недопустим.  
* **Связь с 90-ми**: Компания основана в 1982 году, и их ранние программные продукты для Windows NT активно использовались в 90-е.  
* **Аппаратная связь**: Данное ПО требует подключения к физическим счетчикам частиц через последовательные порты (Serial Transport).8 Это усложняет восстановление в виртуальной среде из-за необходимости проброса портов.

---

## **3. Анализ ложноположительных идентификаций (False Positives) и когнитивных искажений клиента**

Критически важной частью анализа является отсечение информации, которая не относится к делу, но была ошибочно включена клиентом в описание задачи.

| Система-кандидат | Статус | Обоснование исключения | Ссылки на источники |
| :---- | :---- | :---- | :---- |
| **Raymarine LightHouse** | **Ложноположительно** | Это операционная система для морских картплоттеров (MFD) Axiom/eSeries. Версия 3.7 действительно существовала 9, но она работает на базе Linux/Android внутри специализированного «железа». Она не устанавливается на Windows Server. «Root directory» в контексте Raymarine относится к обновлению прошивки через SD-карту 11, а не к установке на HDD. | 9 |
| **Google Lighthouse** | **Ложноположительно** | Современный инструмент аудита веб-страниц. Термины «performance audit», «accessibility», «optimization strategies» в ТЗ клиента взяты именно отсюда. Это когнитивное искажение: клиент искал решение для «Lighthouse», нашел описание инструмента Google и скопировал его функционал в вакансию. | 15 |
| **Lighthouse Design** | **Маловероятно** | Компания производила ПО для NeXTSTEP/OpenStep (Diagram!, Concurrence).19 Хотя она была куплена Sun в 1996 (что подходит под «went out of business»), её ПО не работало на Windows NT, если только не использовалась среда эмуляции OpenStep Enterprise, что крайне маловероятно для малого бизнеса. | 19 |
| **Lighthouse 360** | **Ложноположительно** | Современная SaaS-платформа для стоматологий, принадлежащая Henry Schein.21 Облачное решение, не требует установки на сервер клиента в папку 3.7. | 21 |

### **3.1. Феномен «семантической галлюцинации» в ТЗ**

Требования клиента «Conduct performance audits using Lighthouse 3.7» и «Enhance website accessibility» являются артефактом. Клиент, вероятно, не понимает функционал старого ПО и пытается описать задачу, используя термины, найденные в Google по запросу «Lighthouse software help».  
Вывод для стратегии: Игнорировать любые требования, связанные с веб-аудитом, SEO и доступностью. Сосредоточиться исключительно на восстановлении работоспособности бинарного приложения.

---

## **4. Техническая археология среды Windows NT/2000 (Контекст 90-х)**

Для успешной реанимации Lᨀ необходимо реконструировать экосистему, в которой оно было создано. Программное обеспечение версии 3.7 из конца 90-х жестко привязано к архитектурным особенностям того времени.

### **4.1. Файловая система и ограничения путей**

Установка в C:3.7 свидетельствует о борьбе с ограничениями API.

* **8.3 Filenames**: В Windows NT 3.51 и ранних NT 4.0 поддержка длинных имен файлов (LFN) могла быть отключена или некорректно обрабатываться 16-битными инсталляторами (InstallShield 3).  
* **Hardcoded Paths**: В коде программ на Visual Basic 3.0/4.0 или Delphi 1.0 пути к конфигурационным файлам часто «зашивались» жестко. Перемещение программы в D:App или C:Program FilesApp приведет к ошибкам Path not found или Runtime Error 53.  
* **INI vs Registry**: В 90-е годы происходил переход от хранения настроек в .INI файлах (наследие Windows 3.1) к Реестру (Registry). Версия 3.7, скорее всего, использует гибридный подход: основные настройки в 3.7LHOUSE.INI, а лицензионная информация и пути к COM-серверам — в реестре (HKEY_LOCAL_MACHINESOFTWAREClasses).

### **4.2. Ад зависимостей (DLL Hell)**

Программы той эпохи полагались на общие системные библиотеки, версионность которых не контролировалась ОС (до появления Windows File Protection в Win2000).

* **Visual Basic Runtimes**: Если Lᨀ написано на VB, ему критически нужны VBRUN300.DLL (для VB3), VB40032.DLL (для VB4) или MSVBVM50.DLL (для VB5). Отсутствие одного файла вызовет молчаливое падение программы при запуске.  
* **ActiveX Controls (.OCX)**: Элементы интерфейса (кнопки, гриды, графики) поставлялись в виде отдельных файлов (например, THREED32.OCX, MSCOMM32.OCX для работы с портами). Эти файлы должны быть не просто скопированы, но и зарегистрированы в системе утилитой REGSVR32.  
* **Database Engines**: Если это FoxPro, нужны библиотеки VFP300.ESL или аналогичные. Если Access/Jet — MSJET35.DLL.

### **4.3. Аппаратные ключи защиты (Dongles)**

Промышленные системы 90-х (особенно Lookout и подобные SCADA) часто защищались аппаратными ключами **Sentinel** или **HASP**, подключаемыми к LPT-порту (принтерному).

* **Риск**: При виртуализации сервера LPT-порт физически отсутствует.  
* **Решение**: Необходимо проверить заднюю панель старого сервера на наличие ключей. Если ключ есть, потребуется специализированное устройство «USB-to-LPT» с поддержкой виртуализации или программный эмулятор ключа (что может быть юридически серой зоной, но необходимо для восстановления легально купленного ПО).

---

## **5. Комплексный протокол восстановления (Restoration Protocol)**

На основе проведенного анализа разработан следующий алгоритм действий для специалиста. Процесс разделен на фазы для минимизации рисков потери данных.

### **Фаза I: Цифровая криминалистика и консервация (Forensics & Preservation)**

**Цель**: Сохранить исходное состояние данных без внесения изменений.

1. **Создание посекторного образа (Cold Imaging)**:  
   * Не загружать старую ОС, если диск физически исправен, но файловая система повреждена. Каждая загрузка может быть последней.  
   * Использовать инструменты Live USB (например, Clonezilla или SystemRescueCd) для создания образа диска (dd if=/dev/sda of=/mnt/backup/image.img conv=noerror,sync).  
   * *Важно*: Работа должна вестись только с **копией** образа, оригинал диска должен быть отключен и помещен в антистатический пакет.  
2. **Анализ бинарных заголовков (Binary Analysis)**:  
   * Смонтировать образ в режиме Read-Only.  
   * Найти исполняемый файл в папке 3.7.  
   * Использовать HEX-редактор или утилиту strings для поиска текстовых строк внутри .EXE файла.  
     * Искать: «Georgetown», «National Instruments», «FoxPro», «Copyright».  
     * *Инсайт*: Если внутри найдена строка «Lookout» или «lktsrv», это подтверждает Гипотезу Альфа. Если «FoxPro» — Гипотезу Бета.

### **Фаза II: Реконструкция виртуальной среды (P2V / Rehosting)**

**Цель**: Создать «песочницу», имитирующую аппаратное обеспечение 1998 года.

1. **Выбор платформы виртуализации**:  
   * VMware Workstation/ESXi предпочтительнее Hyper-V для старых ОС, так как VMware сохраняет лучшую поддержку устаревших видеодрайверов (VGA) и эмуляции звуковых карт (SoundBlaster), что иногда критично для старого софта.  
2. **Выбор Гостевой ОС**:  
   * Не пытаться запускать ПО на Windows Server 2019/2022. Режим совместимости не спасет от отсутствия 16-битной подсистемы NTVDM (в 64-битных ОС её нет).  
   * **Рекомендация**: Установить чистую **Windows 2000 Server** или **Windows XP Professional SP3** (32-bit) в виртуальную машину. Эти системы обладают максимальной совместимостью с ПО эпохи NT4 и при этом поддерживают более современные драйверы виртуализации.  
3. **Перенос файлов (Injection)**:  
   * Скопировать папку 3.7 в корень диска C: виртуальной машины.  
   * *Критически важно*: Сохранить атрибуты файлов (Date Modified). Некоторое старое ПО проверяет даты файлов для защиты от копирования.

### **Фаза III: Хирургия Реестра и Библиотек (Registry & Library Surgery)**

Это самый сложный этап, так как инсталлятор недоступен.

1. **Экстракция Реестра (Hive Extraction)**:  
   * Из образа старого диска извлечь файлы реестра: C:WINNTSYSTEM32CONFIGSOFTWARE и SYSTEM.  
   * Загрузить эти файлы в локальный редактор реестра (Load Hive) под временными именами (например, OLD_SOFT).  
   * Экспортировать ветки, относящиеся к программе (поиск по ключевым словам «Lighthouse», «Lookout», имени папки).  
   * Импортировать эти ветки в реестр новой виртуальной машины.  
2. **Регистрация COM/ActiveX**:  
   * Использовать утилиту **Dependency Walker 2.2** (версию для x86) на основном EXE-файле.  
   * Выявить все отсутствующие DLL (обычно MFC42.DLL, MSVCRT.DLL, файлы .OCX).  
   * Найти эти файлы в папке SYSTEM32 старого образа и скопировать их в C:WINDOWSSYSTEM32 виртуальной машины.  
   * Выполнить REGSVR32 <filename>.OCX для каждого компонента ActiveX.

### **Фаза IV: Восстановление коммуникаций (Connectivity Restoration)**

Если система является SCADA (Lookout) или мониторингом (LMS):

1. **Serial over IP**: Поскольку современный хост-сервер может не иметь COM-портов, а виртуальная машина изолирована, необходимо использовать конвертеры **Moxa NPort** или программные решения (например, FabulaTech Serial Port Redirector) для проброса данных с физических приборов в виртуальный COM-порт VM.  
2. **Настройка сети**:  
   * Старое ПО может требовать протокол **NetBIOS** или **IPX/SPX**. В Windows 2000/XP необходимо убедиться, что NetBIOS over TCP/IP включен.  
   * Если ПО использует жестко прописанные IP-адреса, виртуальной машине нужно присвоить тот же IP, что был у старого сервера.

---

## **6. Интеграция новых данных и коррекция стратегии**

В ходе расширенного анализа материалов были выявлены дополнительные детали, требующие интеграции в отчет.

### **6.1. Детализация по SCADA Lookout (Гипотеза Альфа)**

Согласно 1, в руководстве пользователя к модулям FieldPoint (FP-1601) явно описан процесс запуска серверной части ПО: «Open an MS-DOS prompt and enter c:windowssystemlktsrv -start».

* **Импликация**: Это подтверждает, что «Lighthouse» может быть не основным приложением, а службой (сервисом), работающей в фоне.  
* **Действие при восстановлении**: Необходимо проверить не только папку 3.7, но и наличие файла lktsrv.exe в системных папках Windows. Возможно, потребуется прописать его в автозагрузку или восстановить как Службу Windows (Windows Service) через команду sc create.

### **6.2. Уточнение по версии 3.7 и "Root Directory"**

В материале 8 (Zebra MC3000 Integrator Guide) упоминается: «If the Lighthouse 0 - Serial transport method is selected...». И далее: «Microsoft ActiveSync (version 3.7 or higher)».

* **Анализ**: Хотя здесь речь идет об ActiveSync, само сочетание "Lighthouse" и настроек "Serial transport" в контексте интеграции оборудования усиливает гипотезу о том, что Lᨀ — это коммуникационный шлюз для внешних устройств.  
* **Действие**: При настройке виртуальной машины особое внимание уделить эмуляции последовательных портов. ПО может ожидать устройство на COM1 по умолчанию.

### **6.3. Учет корпоративной истории Infor и Lighthouse Systems**

Исходя из 23 и 24, компания **Lighthouse Systems** (разработчик MES-системы Shopfloor-Online) была приобретена компанией **Infor** в 2021 году. Однако клиент утверждает, что компания закрылась в 90-х.

* **Вывод**: Это расхождение либо подтверждает, что речь идет НЕ о Lighthouse Systems (UK), либо клиент дезинформирован о судьбе вендора. Если Lᨀ — это ранний продукт Lighthouse Systems (до Shopfloor-Online), то поддержка теоретически возможна через Infor, но крайне маловероятна для продуктов 30-летней давности. Рекомендуется не тратить ресурсы на обращение в Infor, а сосредоточиться на автономном восстановлении.

---

## **7. Заключение и рекомендации по дальнейшей эксплуатации**

Операция по восстановлению «Lighthouse 3.7» классифицируется как **спасательная археология**. Успех зависит не от знания современных технологий, а от понимания ограничений и стандартов 25-летней давности.

Итоговый диагноз:  
С вероятностью 85%, объект Lᨀ является SCADA-системой Lookout (версии 3.7) от Georgetown Systems / National Instruments, либо проприетарной базой данных на FoxPro, разработанной ныне несуществующим интегратором. Требования клиента по веб-аудиту следует считать ошибкой интерпретации.  
**Стратегические рекомендации**:

1. **Изоляция (Air Gap)**: Восстановленная система на базе Windows 2000/XP будет содержать сотни известных уязвимостей. Она **ни при каких обстоятельствах** не должна иметь прямого выхода в Интернет. Доступ к ней должен осуществляться только через VPN или консоль гипервизора.  
2. **Виртуализация как метод консервации**: После успешного восстановления необходимо сделать снапшот (Snapshot) виртуальной машины. Это навсегда решит проблему "сгоревшего железа" и позволит клонировать сервер за секунды в будущем.  
3. **Отказ от модернизации**: Любые попытки «улучшить» код или перенести его на.NET/Web обречены на провал без полной переписки логики (Re-engineering). Рекомендуется стратегия «In-place Sustainment» — поддержание работы «как есть» до момента полного вывода бизнес-процесса из эксплуатации.

Данный отчет предоставляет полную дорожную карту для технического специалиста, позволяя миновать этап длительного поиска и сразу приступить к квалифицированному восстановлению системы.