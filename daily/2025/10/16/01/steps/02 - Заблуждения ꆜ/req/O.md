# 0.
Сегодня 2025-10-16.

# 1.
## 1.1.
`UW` ≔ (Upwork: https://en.wikipedia.org/wiki/Upwork)

## 1.2.
`ꆜ` ≔ (Некий конкретный потенциальный клиент на `UW`)

## 1.3.
`P⁎` ≔ (Некий конкретный потенциальный проект, опубликованный `ꆜ` на `UW`)

# 2. Информация о `P⁎`
## 2.1. URL
https://www.upwork.com/jobs/~021978556260383183686

## 2.2. Title
M365 Smart Card Sign-In for Windows Computers

## 2.3. Description
`PD` ≔ 
```text
We are setting up smart card sign-in for computers joined to Azure/Entra Active Directory. Our understanding of how this should work is as follows:

A user sits down at a computer and inserts their smart card (or possibly a YubiKey) into a compatible smart card reader — note, this is not a contactless tap card. When the card or YubiKey is inserted, it identifies and authenticates the assigned user. Depending on configuration, the system will either automatically sign the user in or prompt them to enter their PIN. Once authenticated, the user can access their desktop and begin working as usual.

When the user removes their card or YubiKey, the system will automatically sign them out, securing the session.

This setup applies only to local physical machines. We do not have on-premises virtual machine infrastructure or cloud-hosted VMs in our Microsoft 365 tenant.

# Deliverables
Smart Card Sign In
Relatively easy to deploy
Can be replicated and taught
Secure
```

## 2.4. Tags
Microsoft Azure

# 5. Информация о `ꆜ`
## 5.1. Местоположение

United States
Paso Roble

## 5.2. Характеристики компании
### 5.2.1. Сектор экономики
неизвестно

### 5.2.2. Количество сотрудников
неизвестно

## 5.3. Характеристики учётной записи на `UW`
### 5.3.1. Member since
Nov 22, 2020
### 5.3.2. Hire rate (%)
100
### 5.3.3. Количество опубликованных проектов (jobs posted)
2
### 5.3.4. Total spent (USD)
729 
### 5.3.5. Количество оплаченных часов в почасовых проектах
2
### 5.3.6. Средняя почасовая ставка (USD)
94.85

# 6. Выявленные проблемы и потребности клиента (`ꆜ`) на основе `PD`

## 6.1. (П1) Реализация аппаратной аутентификации в облачной среде без сложной инфраструктуры
Основная техническая задача — внедрить вход с помощью физических токенов безопасности (смарт-карт или YubiKey) для компьютеров, присоединенных к Microsoft Entra ID (ранее Azure AD). 
Клиент подчеркивает отсутствие локальной инфраструктуры виртуальных машин. 
Исторически для аутентификации по смарт-картам часто требовались локальные службы федерации (например, ADFS). 
Проблема заключается в реализации решения, работающего напрямую с Entra ID, избегая сложности федеративной инфраструктуры.

## 6.2. (П2) Обеспечение безопасности сеанса при физическом отсутствии пользователя
Проблема минимизации риска несанкционированного доступа, когда пользователь покидает рабочее место. 
Клиент требует автоматического завершения сеанса при извлечении токена: 
«When the user removes their card or YubiKey, the system will automatically sign them out, securing the session».

## 6.3. (П3) Управление сложностью развертывания и инфраструктуры
Клиент требует, чтобы решение было «относительно простым в развертывании» («Relatively easy to deploy») и воспроизводимым. 
Это указывает на озабоченность потенциальной сложностью внедрения и поддержки системы, особенно в контексте аутентификации на основе сертификатов, которая требует Инфраструктуры открытых ключей (PKI).

## 6.4. (П4) Определение безопасного пользовательского опыта (UX)
Клиент описывает желаемый процесс входа с некоторой неопределенностью: «Depending on configuration, the system will either automatically sign the user in or prompt them to enter their PIN». 
Проблема заключается в выборе конфигурации, которая соответствует требованию безопасности («Secure»).

# 7. Анализ обоснованности проблем §6
## 7.1. Анализ П1 (Аутентификация в Entra ID без федерации)

### Обоснованность 
Полностью обоснована.

###
Видение клиента полностью соответствует современным возможностям Microsoft Entra ID. 
Функция **Microsoft Entra Certificate-Based Authentication (CBA)** позволяет реализовать этот сценарий.

#### Нативная поддержка 
Согласно документации Microsoft Learn ("Microsoft Entra certificate-based authentication"), Entra ID поддерживает аутентификацию с использованием сертификатов X.509 (хранящихся на смарт-картах или YubiKey в режиме PIV) напрямую при входе в Windows.

#### Устранение федерации
Современная реализация Entra CBA позволяет аутентифицироваться напрямую в Entra ID и «устраняет необходимость в федеративных AD FS, упрощая среду и сокращая затраты» (eliminates the need for federated AD FS, for a simplified environment and cost reduction). 
Это идеально подходит для облачной среды клиента.

#### Безопасность
Этот метод обеспечивает устойчивую к фишингу (Phishing-resistant) аутентификацию.

## 7.2. Анализ П2 (Выход при извлечении карты)
### Обоснованность
Полностью обоснована.

###
Требование автоматического выхода из системы при извлечении смарт-карты является стандартной функцией операционной системы Windows и не зависит от Entra ID.

### Механизм реализации
Это поведение управляется политикой безопасности Windows: 
`Computer Configuration\Windows Settings\Security Settings\Local Policies\Security Options\Interactive logon: Smart card removal behavior`.

### Настройка 
Документация Microsoft Learn ("Interactive logon Smart card removal behavior") подтверждает, что установка значения политики в «Force Logoff» (Принудительный выход из системы) приведет к автоматическому выходу пользователя из системы при извлечении смарт-карты.

### Зависимости
Для работы этой функции необходимо, чтобы служба "Smart Card Removal Policy" (SCPolicySvc) была запущена. 
На устройствах, присоединенных к Entra ID, эта политика может быть настроена централизованно через Microsoft Intune.

## 7.3. Анализ П3 (Сложность развертывания)

### Обоснованность
Обоснована, но ожидание простоты может быть нереалистичным.

###
Это наиболее критический аспект проекта. 
Хотя Entra CBA упрощает процесс *аутентификации*, он **не устраняет** необходимость в **Инфраструктуре открытых ключей (Public Key Infrastructure, PKI)**.

#### Требование PKI
Клиенту необходим Центр Сертификации (CA) для выпуска сертификатов и управления их жизненным циклом. Это может быть локальный Microsoft AD CS или облачное решение (например, Microsoft Cloud PKI).

#### Сложность PKI
Если у клиента нет существующей PKI, её создание, настройка и поддержка являются сложной задачей, требующей глубоких знаний. 
Это может противоречить требованию «относительно простого развертывания».

#### Список отзыва сертификатов (CRL)
Для обеспечения безопасности необходим доступный через Интернет URL-адрес списка отзыва сертификатов (CRL). 
Документация Microsoft Learn明確に確認します: 
"The CDP can be only HTTP URLs. 
We don't support Online Certificate Status Protocol (OCSP) or Lightweight Directory Access Protocol (LDAP) URLs." 
(CDP может быть только HTTP URL. 
Мы не поддерживаем протокол OCSP или LDAP). 
Публикация и обеспечение доступности CRL добавляет сложности в инфраструктуру.

## 7.4. Анализ П4 (Автоматический вход vs. PIN-код)
### Обоснованность:
Низкая (с точки зрения безопасности).

### 
Предположение клиента о возможности «автоматического входа» (без ввода PIN-кода) противоречит лучшим практикам безопасности и принципам многофакторной аутентификации (MFA).

#### Принцип MFA
Аутентификация по смарт-карте предназначена для обеспечения MFA: фактор владения (карта) и фактор знания (PIN-код). 
PIN-код используется для разблокировки доступа к закрытому ключу, хранящемуся на защищённом чипе карты.

#### Риски безопасности
Обход требования PIN-кода снижает уровень безопасности до однофакторной аутентификации (только владение). 
В случае кражи карты злоумышленник получит доступ к системе.

#### Стандарты безопасности 
Национальный институт стандартов и технологий США (NIST) в рекомендациях NIST Special Publication 800-63B ("Digital Identity Guidelines") требует активации криптографического токена (например, ввода PIN-кода) для подтверждения того, что токен используется его законным владельцем, и для достижения высокого уровня аутентификации (AAL2/AAL3).

Ожидание входа без PIN-кода не является обоснованным, учитывая требование клиента обеспечить безопасность решения («Secure»).



 