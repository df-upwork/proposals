Правильный способ настройки SSL certificate для hMailServer в Windows Server:
1) Запустить «MMC» (Microsoft Management Console) и при необходимости добавить оснастку «Certificates» для просмотра имеющихся сертификатов. 
2) Получить сертификат от доверенного центра сертификаци или создать внутренний (self-signed certificate) с помощью «MMC» (оснастка «Certificates») или другого инструмента.  
3) При получении сертификата в формате `.pfx` (или `.p12`) в Windows Server можно импортировать его в хранилище сертификатов через «MMC» → «Certificates» → «Local Computer» → «Personal» → «Certificates».  
4) В случае использования отдельных файлов ключей и сертификатов (например, `server.crt` и `server.key`) поместить их в надёжную папку на диске. 
Убедиться, что права доступа к приватному ключу ограничены. 
5) Запустить «hMailServer Administrator».  
6) Перейти в «Settings» → «Advanced» → «SSL certificates».  
7) Нажать «Add» и указать:  
– Имя (произвольное) для нового сертификата.  
– Путь к файлу приватного ключа (например, `C:\Certificates\server.key`).  
– Путь к файлу сертификата (например, `C:\Certificates\server.crt`).  
– При необходимости путь к промежуточным сертификатам (intermediate chain).  
8) Сохранить настройки.  
9) В «Settings» → «Advanced» → «TCP/IP ports» указать порты для защищённых соединений (например, 993 для IMAP over SSL, 995 для POP3 over SSL, 465 или 587 для SMTP over SSL/TLS).  
10) Для каждого порта в поле «SSL/TLS» выбрать соответствующий SSL certificate, добавленный в предыдущем шаге.  
11) При необходимости настроить «StartTLS» на стандартных портах IMAP/POP3/SMTP.  
12) Перейти в «hMailServer Administrator» → «Domains» и удостовериться, что все домены и адреса электронной почты настроены правильно.  
13) В «hMailServer Administrator» → «Settings» → «Protocols» → «SMTP»/«POP3»/«IMAP» проверить порты, лимиты и другие параметры.  
14) Убедиться, что фильтрация спама и антивирусная интеграция (если нужна) корректно настроены в «hMailServer Administrator» → «Settings» → «Anti-spam» / «Anti-virus».  
15) Убедиться, что в «Windows Firewall» или другом сетевом межсетевом экране открыты соответствующие порты (SMTP, IMAP, POP3), включая порты для SSL (465, 587, 993, 995).  
16) Проверить маршрутизацию (NAT, если используется) на внешнем роутере или межсетевом экране, чтобы почтовый трафик доходил до сервера.  
17) Использовать любой почтовый клиент (например, Microsoft Outlook или Mozilla Thunderbird), чтобы проверить подключение через IMAP/POP3/SMTP с включённым SSL/TLS.  
18) Убедиться, что клиентское приложение не выдаёт предупреждений о недоверенном сертификате (или добавить корневой и промежуточный сертификаты в хранилище доверенных на клиентской стороне).  
19) Проверить, что логины и пароли корректно передаются по зашифрованному каналу и почтовый трафик успешно проходит.
20) При необходимости включить в hMailServer дополнительную аутентификацию или методы анти-спам (в «Settings» → «Anti-spam») в зависимости от политики безопасности.  
21) Провести тестовое отправление писем на внешние домены (Gmail, Outlook.com и т.п.), убедиться, что письма не попадают в папки со спамом.  
22) Проверить статус сертификата и актуальность даты истечения (expiration date). 
23) Зафиксировать все выполненные настройки (порты, пути к файлам сертификатов, версии ПО) и сохранить эту информацию в безопасном месте.   

  