1) In points 2-5, I describe 4 main causes of your problem (hereafter — `P†`).
In points 7-12, I outline my recommendations.
2) `⋇1`: cache bloat
Ваш сайт `RunRepeat.com` (hereafter — `Rᨀ`) использует фасетный поиск (цвет, размер) и рекламные метки (`gclid`, `utm`). 
Это создает комбинаторный взрыв URL (cache bloat). 
Varnish (hereafter — `Vᨀ`) по умолчанию считает `/shoe?color=red` и `/shoe?gclid=123` разными объектами. 
Если не делать агрессивную нормализацию (очистку и сортировку параметров) до кэширования, память будет забиваться мусором быстрее, чем любые политики eviction смогут её освободить.
3) `⋇2`: Unbounded transient storage
`Vᨀ` использует специальное хранилище `Transient` для короткоживущих объектов и технических записей `hit-for-miss`, создаваемых при невозможности кэширования.
По умолчанию это хранилище использует системный аллокатор `malloc` и не имеет ограничения по максимальному объему потребляемой памяти.
При наплыве трафика с уникальными метками или Cookies, которые бэкенд помечает как `private`, `Vᨀ` бесконтрольно заполняет RAM этими временными записями до полного падения сервера (OOM).
4) `⋇3`: metadata overhead
Параметр конфигурации `-s malloc,SIZE` ограничивает только объем памяти для тела объектов, но игнорирует затраты на их метаданные.
Каждый объект в кэше требует около 1 КБ оперативной памяти для служебных структур (`struct obj`, `objcore`), хранящихся вне лимитируемой области.
Из-за проблемы `⋇1` количество объектов может достигать десятков миллионов, что приводит к потреблению десятков гигабайт памяти исключительно на метаданные.
5) `⋇4`: heap fragmentation
Стандартный системный аллокатор `glibc`, используемый в Linux по умолчанию, неэффективен для многопоточной работы `V` с частым выделением памяти.
Это приводит к внешней фрагментации кучи, когда операционная система считает память занятой процессом, хотя внутри она свободна, но разбита на мелкие участки.
На архитектуре AWS Graviton (ARM64) проблема фрагментации `glibc` проявляется особенно остро, вызывая рост RSS процесса.
6) In points 7-12, I outline my main recommendations for eliminating `P†`.
7) `R1`
7.1) Суть
Внедрить в процедуру `vcl_recv` строгую логику очистки `req.url` от маркетинговых меток (`gclid`, `fbclid`, `utm_`) и уникальных идентификаторов сессий перед вычислением хэша.
7.2) Реализация
7.2.1) Использовать модуль `vmod_std` (функция `std.querysort`) или `vmod_querystring` для алфавитной сортировки параметров запроса, что приводит их к каноническому виду.
7.2.2) Нормализовать заголовок `User-Agent` до ограниченного набора групп (например, mobile/desktop) 
7.2.3) Удалять заголовок `Cookie` для статических ресурсов.
7.3) Результат
7.3.1) Предотвращение `⋇1` посредством превращения потенциальных дубликатов в единичные экземпляры объектов в памяти.
7.3.2) Устранение первопричины `⋇3`.
