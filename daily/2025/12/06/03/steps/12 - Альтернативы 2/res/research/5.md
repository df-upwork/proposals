https://gemini.google.com/share/44ef13361305


## **Введение**

В современной архитектуре облачных данных потребность в репликации информации в реальном времени (Change Data Capture — CDC) является критически важной для построения аналитических хранилищ и систем событийного реагирования. Google Cloud Datastream, как бессерверное решение для CDC, предоставляет нативные возможности интеграции с различными источниками данных, включая MongoDB.1 Однако при интеграции с управляемыми сервисами баз данных, такими как MongoDB Atlas, в корпоративных средах с высокими требованиями к сетевой безопасности, архитекторы сталкиваются со сложными структурными противоречиями.

Основной вектор сложности возникает при попытке соединить Datastream, работающий в управляемой сети Google, с кластером MongoDB Atlas через механизм Private Service Connect (PSC). Данный механизм, обеспечивающий однонаправленную приватную связность без транзитивного пиринга и публичных IP-адресов, вступает в фундаментальный конфликт с протоколом обнаружения топологии MongoDB (Server Discovery and Monitoring — SDAM).

Настоящий отчет представляет собой исчерпывающее исследование технического противоречия (C1⊥), выявленного в пользовательском запросе: невозможность корректного подключения Datastream к Atlas через PSC из-за конфликта между механизмом маршрутизации PSC и протоколом MongoDB Wire Protocol, усугубляемого невозможностью использования параметра directConnection (в силу ограничений Terraform провайдера или требований к отказоустойчивости) и неприменимостью SSH-туннелирования в данной сетевой топологии. В документе детально анализируются природа этого конфликта, спецификации драйверов, поведение облачных сетевых примитивов и предлагаются обоснованные альтернативные архитектурные паттерны (A2ᚖ⠿) для решения задачи.

## ---

**1. Теоретические основы и анатомия технического противоречия**

Для понимания глубины проблемы необходимо деконструировать механизмы взаимодействия трех ключевых компонентов: Google Cloud Datastream, Private Service Connect и драйверов MongoDB.

### **1.1 Архитектура сетевого взаимодействия Datastream**

Google Cloud Datastream функционирует в изолированном проекте Google (tenant project), который отделен от пользовательского VPC (Virtual Private Cloud). Для доступа к ресурсам в пользовательской сети Datastream использует механизм «Private Connectivity Configuration».2

Существует два основных метода организации приватной связности:

1. **VPC Peering:** Создает прямой сетевой мост между сетями. Однако он имеет ограничения транзитивности — Datastream не может «пройти» через пользовательский VPC, чтобы достичь другой пиринговой сети (например, VPC MongoDB Atlas в Google Cloud).3  
2. **Private Service Connect (PSC):** Позволяет опубликовать сервис (в данном случае, интерфейс доступа к данным) внутри пользовательского VPC как локальный IP-адрес. Это предпочтительный метод для безопасной интеграции, так как он не требует обмена таблицами маршрутизации и минимизирует поверхность атаки.4

В контексте задачи Datastream должен инициировать TCP-соединение с адресом, доступным в его контексте маршрутизации. При использовании PSC Datastream «видит» только IP-адрес интерфейса PSC (PSC Interface Endpoint) в пользовательском VPC.

### **1.2 Протокол обнаружения топологии MongoDB (SDAM)**

Фундаментальная причина конфликта кроется в спецификации драйверов MongoDB (включая Java/Go драйверы, используемые внутри Datastream). Подключение к кластеру Replica Set или Sharded Cluster происходит в несколько этапов:

1. **Initial Seed List Connection:** Драйвер подключается к адресам, указанным в строке подключения (Connection String). В случае PSC это IP-адрес конечной точки PSC (например, 10.128.0.5).  
2. **Handshake (hello / isMaster):** Драйвер отправляет команду рукопожатия.  
3. **Topology Discovery Response:** Сервер MongoDB отвечает BSON-документом, содержащим конфигурацию набора реплик. Критически важными полями здесь являются me (адрес текущего узла) и hosts (список всех членов реплика-сета).1  
4. **Reconciliation & Reconnection:** Драйвер обновляет свое представление о топологии, *разрывает* или переводит в фоновый режим соединение с Seed List и пытается установить прямые соединения с адресами, полученными в поле hosts.

### **1.3 Суть противоречия (C1⊥) в среде PSC**

Техническое противоречие возникает на этапе 4. Когда Datastream подключается к PSC Endpoint, запрос проходит через NAT (Network Address Translation) и попадает на узел MongoDB Atlas. Узел Atlas, находясь в своей собственной VPC (управляемой MongoDB), возвращает в поле hosts свои *внутренние* IP-адреса (например, 192.168.10.2, 192.168.10.3) или внутренние DNS-имена (atlas-xyz-shard-00-00.mongodb.net).

Datastream получает этот список и пытается открыть новые TCP-сокеты к этим адресам.

* **Проблема маршрутизации:** Адреса 192.168.10.x являются внутренними адресами VPC Atlas. Они не маршрутизируются через PSC. Интерфейс PSC обеспечивает доступ только к опубликованной конечной точке, но не к произвольным внутренним адресам за ней.  
* **Проблема DNS:** Документация Datastream явно указывает: *"Datastream doesn't support Domain Name System (DNS) resolution in private connections"*.2 Даже если Atlas вернет DNS-имена, Datastream не сможет их разрешить в корректные IP-адреса, доступные через PSC.

#### **Почему directConnection является решением и почему оно недоступно?**

Параметр directConnection=true в строке подключения заставляет драйвер игнорировать топологию, возвращаемую командой hello, и продолжать работать исключительно с адресом из Seed List (то есть с PSC Endpoint).6  
Однако пользовательский запрос вводит ограничение: невозможность использования параметра directConnection. Анализ исследовательских данных выявляет причины этого ограничения:

1. **Ограничения Terraform Provider:** Ресурс google_datastream_connection_profile в провайдере hashicorp/google имеет сложную историю поддержки полей MongoDB. В частности, структура standardConnectionFormat в некоторых версиях провайдера не экспортирует поле directConnection корректно или вызывает постоянную пересоздание ресурса (permadiff).8  
2. **Валидация API:** В некоторых сценариях Datastream API отклоняет профили, где указано имя Replica Set, но при этом форсируется directConnection, так как это семантически противоречиво (Replica Set подразумевает множество узлов, Direct — один).  
3. **Потеря отказоустойчивости:** Использование directConnection привязывает поток данных к конкретному узлу. Если этот узел (Primary) упадет, а PSC Endpoint продолжит направлять трафик на него (или если PSC привязан к конкретному IP), репликация остановится. Драйвер не сможет автоматически переключиться на нового Primary, так как механизм SDAM отключен.

#### **Ограничения SSH-туннелирования**

Использование SSH-туннеля (Forward-SSH) могло бы решить проблему маршрутизации, «пробрасывая» Datastream непосредственно в сеть Atlas. Однако:

* **Взаимоисключение:** В конфигурации Datastream методы Connectivity являются взаимоисключающими. Нельзя выбрать «Private Connectivity» (для доступа к внутренней сети) и одновременно настроить SSH-туннель. SSH-туннель в Datastream подразумевает подключение к публичному IP или доступному адресу бастиона, что противоречит требованию использования PSC для закрытого контура.10  
* **Проблема двойного NAT:** Даже через SSH-туннель драйвер MongoDB получит список внутренних адресов Atlas и попытается подключиться к ним. Если туннель не настроен как прозрачный SOCKS-прокси (что не поддерживается Datastream для MongoDB нативно, только TCP forwarding), проблема Discovery сохраняется.12

## ---

**2. Сравнительный анализ альтернативных архитектурных решений (A2ᚖ⠿)**

Учитывая жесткие ограничения (необходимость PSC, невозможность directConnection на стороне клиента, отсутствие DNS), решение задачи требует выноса логики управления соединением за пределы Datastream. Мы анализируем три основных подхода.

### **Таблица 1: Сравнение стратегий решения**

| Характеристика | Стратегия А: Проксирование (TCP/L4) | Стратегия B: Инфраструктурный патч (API/CLI) | Стратегия C: Архитектурная развязка (Bridge Node) |
| :---- | :---- | :---- | :---- |
| **Основной механизм** | NGINX/HAProxy в Consumer VPC | Принудительная установка флага через gcloud | Промежуточный mongod процесс |
| **Решение проблемы Discovery** | Скрытие топологии на сетевом уровне | Отключение Discovery на уровне драйвера | Discovery выполняется на Bridge-узле |
| **Отказоустойчивость** | Зависит от балансировщика PSC | Низкая (требует ручного вмешательства или L4 LB) | Высокая (Bridge обрабатывает Failover) |
| **Сложность внедрения** | Средняя | Низкая | Высокая |
| **Требования к ресурсам** | Дополнительная VM/Container | Нет | Дополнительная VM (High RAM) |
| **Совместимость с Terraform** | Полная | Требует local-exec хаков | Полная |

## ---

**3. Глубокий анализ Стратегии А: Проксирование через NGINX (Рекомендуемый подход)**

Данная стратегия предполагает внедрение промежуточного слоя (Intermediary Proxy) внутри пользовательского VPC. Этот слой терминирует соединение от Datastream и перенаправляет его в Atlas через PSC, попутно решая проблему топологии.

### **3.1 Архитектура решения**

1. **Компоненты:**  
   * **Datastream:** Находится в Google Tenant Project.  
   * **PSC Interface:** Находится в пользовательском VPC, имеет внутренний IP (например, 10.10.0.5).  
   * **Proxy VM:** Виртуальная машина (Google Compute Engine) в той же VPC, на которой запущен NGINX с модулем stream. IP-адрес: 10.10.0.10.  
   * **MongoDB Atlas:** Находится в удаленной VPC, доступна через PSC.  
2. **Поток данных:**  
   * Datastream инициирует соединение к 10.10.0.10:27017 (Proxy).  
   * NGINX принимает соединение и открывает сокет к 10.10.0.5:27017 (PSC Endpoint).  
   * PSC перенаправляет трафик в Atlas.

### **3.2 Решение проблемы directConnection на уровне Прокси**

Даже при использовании прокси, если Datastream отправит команду hello, Atlas ответит списком внутренних IP. Чтобы избежать этого без настройки directConnection на самом Datastream, мы должны гарантировать, что Datastream *считает*, что работает с одиночным узлом (Standalone), или «обмануть» механизм Discovery.

Однако, поскольку мы не можем изменить код драйвера внутри Datastream, наиболее надежным способом является **комбинация Прокси и принудительного изменения конфигурации**. Если пользовательское ограничение на directConnection связано *только* с Terraform, то использование Прокси позволяет нам упростить конфигурацию Terraform (указав IP прокси), а флаг directConnection добавить через «черный ход» (CLI), что будет рассмотрено в разделе 3.4.

Но существует более изящный метод: использование **L4 Transparent Proxy** в сочетании с **Split-Horizon DNS** (на уровне прокси, а не Datastream).

#### **Конфигурация NGINX (Stream Module)**

Использование модуля http невозможно, так как MongoDB использует собственный бинарный протокол поверх TCP. Необходим модуль stream.13

Nginx

stream {  
    upstream atlas_psc {  
        # IP-адрес конечной точки PSC  
        server 10.10.0.5:27017;  
    }

    server {  
        listen 27017;  
        proxy_pass atlas_psc;  
          
        # Тайм-ауты критичны для CDC стримов  
        proxy_connect_timeout 5s;  
        proxy_timeout 300s;  # Должно быть больше частоты keepalive пакетов  
          
        # Включение keepalive для поддержания соединения  
        proxy_socket_keepalive on;  
    }  
}

### **3.3 Проблема SNI и TLS Passthrough**

MongoDB Atlas требует TLS соединения. При подключении через PSC сертификат, возвращаемый Atlas, будет выдан на имя *.mongodb.net (или конкретного кластера).  
Если Datastream подключается к IP-адресу прокси (10.10.0.10), проверка имени хоста в TLS (Hostname Verification) завершится ошибкой, так как сертификат не содержит 10.10.0.10.  
**Решение:**

1. **Отключение верификации хоста:** В профиле Datastream часто нет явной опции «Accept Invalid Hostnames» в UI, но API может позволять это.  
2. **TLS Passthrough:** NGINX в режиме stream просто пересылает байты. Шифрование происходит между Datastream и Atlas. Datastream должен доверять CA Atlas (обычно Let's Encrypt или DigiCert, которые доверенные по умолчанию).  
3. **Подмена имени (SNI Injection):** Если Atlas требует SNI для маршрутизации (что типично для Shared Clusters, но менее актуально для Dedicated Clusters за PSC), NGINX может использовать директиву proxy_ssl_server_name при перешифровке, но для stream (TCP) это работает только если NGINX сам терминирует SSL и устанавливает новое соединение.

Для Datastream предпочтительнее сценарий, где NGINX выступает "прозрачной трубой".

### **3.4 Преодоление «Невозможности» использования directConnection**

Если пользовательское ограничение «невозможность использования directConnection» является абсолютным (например, политика безопасности запрещает подключение к одному узлу), то архитектура PSC для Datastream **становится нереализуемой** без использования сложного промежуточного ПО, способного переписывать BSON-пакеты на лету (заменяя внутренние IP Atlas на IP прокси в ответе isMaster). Это крайне нетривиальная задача, требующая написания кастомного прокси на Node.js или Go, так как NGINX не умеет парсить и модифицировать тело TCP-пакетов MongoDB.

Однако, анализ контекста 8 подсказывает, что «невозможность» скорее всего связана с **ошибками провайдера Terraform**. В этом случае, решение лежит в плоскости Infrastructure-as-Code (IaC).

## ---

**4. Глубокий анализ Стратегии B: Инфраструктурный патч (Workaround)**

Если Terraform блокирует установку directConnection=true или сбрасывает её, необходимо использовать гибридный подход к развертыванию. Это устраняет техническое противоречие, позволяя использовать PSC и Datastream, обходя ограничения инструментария.

### **4.1 Механизм Terraform + gcloud**

Суть метода заключается в создании профиля подключения через Terraform с базовыми настройками, и последующем «обогащении» конфигурации через прямой вызов API Google Cloud.

**Пример реализации на Terraform:**

Terraform

resource "google_datastream_connection_profile" "mongodb_source" {  
  display_name          = "mongodb-psc-source"  
  connection_profile_id = "mongodb-psc-source"  
  location              = "us-central1"

  mongodb_profile {  
    # Указываем IP прокси или PSC Endpoint  
    hostname = "10.10.0.10"   
    username = var.mongo_user  
    password = var.mongo_pass  
    # Опускаем problematic fields, вызывающие permadiff  
  }

  private_connectivity {  
    private_connection = google_datastream_private_connection.default.id  
  }  
}

# Ресурс-патч, выполняющийся после создания профиля  
resource "null_resource" "force_direct_connection" {  
  triggers = {  
    profile_id = google_datastream_connection_profile.mongodb_source.id  
  }

  provisioner "local-exec" {  
    # Использование флага, найденного в исследовании   
    command = <<EOT  
      gcloud datastream connection-profiles update ${google_datastream_connection_profile.mongodb_source.connection_profile_id}   
      --region=${google_datastream_connection_profile.mongodb_source.location}   
      --project=${var.project_id}   
      --mongodb-direct-connection  
    EOT  
  }  
}

### **4.2 Обоснование эффективности**

Данный подход решает противоречие C1⊥ следующим образом:

1. **Сохранение PSC:** Профиль использует private_connectivity, обеспечивая безопасность.  
2. **Обход Terraform:** Мы не зависим от багов провайдера hashicorp/google.  
3. **Активация Direct Connection:** Флаг --mongodb-direct-connection в CLI 15 корректно обновляет поле standardConnectionFormat.directConnection в API (backend), заставляя драйвер Datastream игнорировать топологию Atlas.

## ---

**5. Стратегия C: Архитектурная развязка через «Bridge Node» (Mongos/Mongod)**

Если требования к отказоустойчивости запрещают использование directConnection (т.е. Datastream должен переключаться при смене Primary), а прямая маршрутизация невозможна, можно использовать промежуточный узел MongoDB.

### **5.1 Концепция**

Вместо TCP-прокси (NGINX) в Compute Engine разворачивается экземпляр mongos (если источник — Sharded Cluster) или mongod (как арбитр или hidden member, хотя это сложно в Atlas), или просто клиентское приложение, эмулирующее MongoDB Wire Protocol.

Наиболее реалистичный вариант для Atlas Replica Set: **Mongo Router (mongos) не применим к Replica Set напрямую**, но можно использовать **TCP Load Balancer** с Health Checks.

### **5.2 Internal Load Balancer (ILB) + Health Check**

Это продвинутая версия Стратегии А, решающая проблему отказа узла при использовании directConnection.

1. **Создается Instance Group** из 2+ VM с NGINX.  
2. **Настраивается Internal TCP Load Balancer** перед этой группой.  
3. **Скрипт Health Check:** На VM запускается скрипт, который периодически опрашивает Atlas PSC IP (или конкретные IP узлов, если они известны и статичны за PSC) командой isMaster.  
4. **Логика:** Тот прокси, который в данный момент «видит» Primary узел Atlas, отвечает 200 OK на Health Check балансировщика.  
5. **Datastream:** Подключается к IP адресу ILB с directConnection=true.

**Результат:**

* Datastream думает, что подключен к одному хосту (ILB).  
* При падении Primary в Atlas, скрипт Health Check на прокси замечает изменение ролей. Балансировщик переключает трафик на тот прокси/порт, который ведет к новому Primary.  
* Это обеспечивает автоматический Failover без участия драйвера Datastream.

## ---

**6. Детальный анализ недостающей информации и рисков**

В ходе анализа исследовательских фрагментов были выявлены пробелы, которые критически важно заполнить для построения надежного решения.

### **6.1 Неудовлетворенные требования и скрытые ограничения**

1. **DNS Resolution в Datastream:** Пользовательский запрос упоминает ограничения SSH, но важно подчеркнуть, что **отсутствие DNS** в Datastream Private Connectivity 2 делает невозможным использование SRV-записей (mongodb+srv://). Это означает, что строку подключения необходимо формировать вручную, указывая IP-адреса. Любая попытка использовать хостнеймы Atlas (например, cluster0-shard-00-00.mongodb.net) приведет к ошибке разрешения имен, даже если сетевая связность есть. Это делает использование Прокси или жестко заданных IP (через gcloud патч) безальтернативным.  
2. **Специфика ошибки SSL/TLS:** При использовании Прокси (Стратегия А) возникает риск атаки "Man-in-the-Middle" с точки зрения Datastream. Сертификат Atlas выписан на доменное имя. Datastream подключается к IP.  
   * *Решение:* Необходимо импортировать корневой сертификат (Root CA), которым подписан сертификат Atlas (ISRG Root X1), в конфигурацию Datastream, если это поддерживается, или убедиться, что используемая версия Datastream доверяет публичным CA. Однако, проблема несоответствия Subject Alternative Name (IP vs DNS) может потребовать отключения валидации хостнейма, что не всегда доступно в UI. В таком случае, использование ILB (Стратегия C) с привязкой к частной DNS зоне внутри Google Cloud (Cloud DNS Private Zone), которая резолвит фейковое имя (соответствующее сертификату, если удастся его сгенерировать, что невозможно для Atlas) или использование самоподписанных сертификатов на уровне Прокси с перешифровкой (SSL Re-encryption) становится единственным выходом.  
   * *SSL Re-encryption (NGINX):*  
     Nginx  
     stream {  
         server {  
             listen 27017 ssl;  
             proxy_pass atlas_backend;  
             ssl_certificate /etc/nginx/certs/self-signed.crt; # Загрузить CA в Datastream  
             ssl_certificate_key /etc/nginx/certs/self-signed.key;  
             proxy_ssl on; # Включение SSL до Atlas  
             proxy_ssl_server_name on; # SNI для Atlas  
             proxy_ssl_name cluster0.mongodb.net; # Имя для SNI  
         }  
     }

     Этот метод позволяет Datastream подключаться к NGINX с доверенным (самоподписанным) сертификатом, а NGINX устанавливает корректное TLS соединение с Atlas, подставляя нужное SNI имя.

### **6.2 Ограничения SSH-туннелирования: Почему это тупик?**

Запрос упоминает ограничения SSH. Важно детализировать: Datastream не позволяет комбинировать типы подключений. Если выбран метод "Private Connectivity" (необходимый для PSC), то поля для настройки SSH-туннеля становятся недоступны в API/UI.10 Попытка создать туннель "сбоку" (на уровне ОС) невозможна, так как Datastream — это управляемый сервис без доступа к ОС. Единственный вариант использования SSH — это выбор метода connectivity "Public IP" с "Forward SSH Tunnel", но это нарушает требование использования PSC и требует публичного доступа к бастиону, что часто неприемлемо по соображениям безопасности.

## ---

**7. План внедрения и Операционная модель**

На основе проведенного анализа предлагается следующий пошаговый план внедрения решения, обходящего техническое противоречие.

### **Этап 1: Подготовка сетевой инфраструктуры**

1. Развертывание **VPC** в Google Cloud.  
2. Настройка **Private Service Connect Endpoint** для Atlas. Получение статического внутреннего IP (например, 10.128.0.5).  
3. Создание **Firewall Rules**, разрешающих входящий трафик от диапазона IP Datastream (обычно /29, выделенный при создании Private Connectivity) на порт 27017 в VPC.

### **Этап 2: Развертывание Прокси-слоя (Усиленная Стратегия А)**

Развертывание группы инстансов (MIG) с NGINX. Конфигурация должна включать stream модуль с proxy_ssl (см. пункт 6.1) для корректной обработки SNI, так как Atlas требует TLS.

* *Важно:* Использование proxy_ssl_server_name on критично, так как Atlas обслуживает множество кластеров на одних IP и использует SNI для маршрутизации. Без этого NGINX не сможет подключиться к нужному кластеру.

### **Этап 3: Создание профиля Datastream**

Использование Terraform для создания профиля, указывающего на IP адрес Прокси (или балансировщика перед ними).

Bash

# Пример команды для патчинга профиля (Стратегия B)  
gcloud datastream connection-profiles update my-mongo-profile   
    --location=us-central1   
    --mongodb-direct-connection   
    --force # Если требуется игнорировать предупреждения

### **Этап 4: Мониторинг и Observability**

Так как мы вводим промежуточный слой, критически важно обеспечить его мониторинг.

* **Метрики NGINX:** Количество активных соединений, битрейт, ошибки подключения к upstream.  
* **Datastream:** Задержка (Latency), пропускная способность.  
* **Логирование:** Включение access_log в блоке stream NGINX позволит видеть каждый факт подключения Datastream и разрывы связи, что незаменимо для отладки проблем с directConnection.

## ---

**8. Заключение**

Анализ технического противоречия C1⊥ показал, что прямая интеграция Datastream и Atlas через PSC невозможна в «нативном» режиме из-за фундаментального несоответствия механизмов маршрутизации (L3/L4 PSC NAT) и протокола обнаружения сервисов MongoDB (L7 SDAM).

Ограничение на использование directConnection, упомянутое в запросе, является преимущественно инструментальным (ограничения Terraform) или процедурным (риск потери Failover).

**Рекомендованным решением (A2ᚖ⠿)** является гибридная архитектура:

1. **Инфраструктурный уровень:** Внедрение **NGINX Proxy с SSL-терминацией/ре-шифрованием**. Это решает проблему SNI и позволяет контролировать поток данных.  
2. **Уровень конфигурации:** Использование **gcloud для принудительной установки флага directConnection** в обход ограничений Terraform. Это решает проблему Discovery, заставляя Datastream работать с прокси как с единственной точкой входа.  
3. **Уровень отказоустойчивости:** Перенос ответственности за Failover с драйвера Datastream на связку **Internal Load Balancer + Health Checks** на уровне прокси.

Такой подход полностью удовлетворяет требованиям безопасности (трафик не покидает приватную сеть), решает проблему маршрутизации (Datastream видит только один IP) и обходит ограничения инструментария, обеспечивая надежный поток данных CDC.


#### **Works cited**

1. Stream data from MongoDB databases | Datastream - Google Cloud Documentation, accessed December 8, 2025, [https://docs.cloud.google.com/datastream/docs/sources-mongodb](https://docs.cloud.google.com/datastream/docs/sources-mongodb)  
2. Create a private connectivity configuration | Datastream - Google Cloud Documentation, accessed December 8, 2025, [https://docs.cloud.google.com/datastream/docs/create-a-private-connectivity-configuration](https://docs.cloud.google.com/datastream/docs/create-a-private-connectivity-configuration)  
3. Configure VPC peering | Datastream - Google Cloud Documentation, accessed December 8, 2025, [https://docs.cloud.google.com/datastream/docs/vpc-peering](https://docs.cloud.google.com/datastream/docs/vpc-peering)  
4. Accessing multi-regional MongoDB Atlas with Private Service Connect - Google Codelabs, accessed December 8, 2025, [https://codelabs.developers.google.com/codelabs/psc-mongo-globalaccess](https://codelabs.developers.google.com/codelabs/psc-mongo-globalaccess)  
5. Configure Private Service Connect interfaces | Datastream - Google Cloud Documentation, accessed December 8, 2025, [https://docs.cloud.google.com/datastream/docs/psc-interfaces](https://docs.cloud.google.com/datastream/docs/psc-interfaces)  
6. MongoDB Integration - Elastic, accessed December 8, 2025, [https://www.elastic.co/docs/reference/integrations/mongodb](https://www.elastic.co/docs/reference/integrations/mongodb)  
7. Specify Connection Options - Node.js Driver - MongoDB Docs, accessed December 8, 2025, [https://www.mongodb.com/docs/drivers/node/current/connect/connection-options/](https://www.mongodb.com/docs/drivers/node/current/connect/connection-options/)  
8. google_datastream_connection_, accessed December 8, 2025, [https://github.com/hashicorp/terraform-provider-google/issues/16089](https://github.com/hashicorp/terraform-provider-google/issues/16089)  
9. `google_datastream_*` resources force replacement due to `create_without_validation` · Issue #21780 · hashicorp/terraform-provider-google - GitHub, accessed December 8, 2025, [https://github.com/hashicorp/terraform-provider-google/issues/21780](https://github.com/hashicorp/terraform-provider-google/issues/21780)  
10. REST Resource: projects.locations.connectionProfiles | Datastream ..., accessed December 8, 2025, [https://docs.cloud.google.com/datastream/docs/reference/rest/v1/projects.locations.connectionProfiles](https://docs.cloud.google.com/datastream/docs/reference/rest/v1/projects.locations.connectionProfiles)  
11. Create connection profiles | Datastream - Google Cloud Documentation, accessed December 8, 2025, [https://docs.cloud.google.com/datastream/docs/create-connection-profiles](https://docs.cloud.google.com/datastream/docs/create-connection-profiles)  
12. MongoDB c# driver - Connect via proxy - Stack Overflow, accessed December 8, 2025, [https://stackoverflow.com/questions/7240309/mongodb-c-sharp-driver-connect-via-proxy](https://stackoverflow.com/questions/7240309/mongodb-c-sharp-driver-connect-via-proxy)  
13. How to setup MongoDB behind Nginx Reverse Proxy [closed] - Stack Overflow, accessed December 8, 2025, [https://stackoverflow.com/questions/31853755/how-to-setup-mongodb-behind-nginx-reverse-proxy](https://stackoverflow.com/questions/31853755/how-to-setup-mongodb-behind-nginx-reverse-proxy)  
14. Mongo DB behind Nginx as reverse proxy, share your Mongo DB with your friends in LAN network - GitHub Gist, accessed December 8, 2025, [https://gist.github.com/bugb/e08f4edd1d7ba11706469ccd6cce1dfd](https://gist.github.com/bugb/e08f4edd1d7ba11706469ccd6cce1dfd)  
15. Create connection profiles | Firestore with MongoDB compatibility, accessed December 8, 2025, [https://docs.cloud.google.com/firestore/mongodb-compatibility/docs/migrate-create-connection-profiles](https://docs.cloud.google.com/firestore/mongodb-compatibility/docs/migrate-create-connection-profiles)  
16. gcp.datastream.ConnectionProfile | Pulumi Registry, accessed December 8, 2025, [https://www.pulumi.com/registry/packages/gcp/api-docs/datastream/connectionprofile/](https://www.pulumi.com/registry/packages/gcp/api-docs/datastream/connectionprofile/)  
17. Example: Private connectivity for a MongoDB Atlas cluster | Integration Connectors, accessed December 8, 2025, [https://docs.cloud.google.com/integration-connectors/docs/connectors/mongodb/configure-psc-mongodb](https://docs.cloud.google.com/integration-connectors/docs/connectors/mongodb/configure-psc-mongodb)  
18. Manage connection profiles | Datastream - Google Cloud Documentation, accessed December 8, 2025, [https://docs.cloud.google.com/datastream/docs/manage-connection-profiles](https://docs.cloud.google.com/datastream/docs/manage-connection-profiles)  
19. google_datastream_connection_, accessed December 8, 2025, [https://registry.terraform.io/providers/hashicorp/google/6.11.0/docs/resources/datastream_connection_profile](https://registry.terraform.io/providers/hashicorp/google/6.11.0/docs/resources/datastream_connection_profile)