Ниже приведена пошаговая инструкция на русском языке, описывающая, как обеспечить правильное сопоставление и синхронизацию «dealers» и «customers» из Salesforce с Microsoft Dynamics 365 Business Central (далее — Business Central) и Microsoft Dynamics 365 Sales (далее — Sales 365). Инструкция учитывает решения из предыдущих пунктов (1–40) и требования о регулярной передаче данных через Power Automate. При описании официальных продуктов и элементов интерфейса используются их точные названия на английском языке.

1) Определить различия между «dealers» и «customers» в Salesforce  
1.1) В Salesforce проверить, как хранится информация о «dealers» и «customers». Обычно это сущность «Account» или «Contact» с определённым полем, позволяющим отличать дилеров от конечных клиентов (например, поле типа `Account Type`).  
1.2) Убедиться, что есть признак (например, поле `Type` или пользовательское поле) для каждого аккаунта, указывающий, является ли он «dealer» или «customer». Если такого поля нет, создать новое поле для классификации:  
• В Salesforce открыть «Setup» → «Object Manager» → «Account» → «Fields & Relationships» → «New», выбрать нужный тип (Picklist, Two Options).  
• Сохранить и опубликовать.

2) Подготовить структуру хранения «dealers» и «customers» в Business Central и Sales 365  
2.1) В Business Central проверить, имеется ли разделение дилеров и конечных клиентов. Возможно, это поле «Customer Posting Group», «Customer Type» или другое пользовательское поле в таблице «Customer». Если необходима отдельная сущность для дилеров, создать или настроить существующие записи (разделять по полю «Dealer = true/false»).  
2.2) В Sales 365 определить, будет ли использование одной сущности «Account» с полем «Dealer / Customer» или несколько сущностей. Чаще всего достаточно одного поля в сущности «Account», где хранится признак «dealer» или «customer».  
2.3) Убедиться, что для каждого дилера или клиента существует уникальный идентификатор, позволяющий сопоставлять записи между системами (например, «Account Number»).

3) Создать или настроить поля в Business Central и Sales 365 для хранения типа аккаунта (dealer vs. customer)  
3.1) В Business Central при необходимости добавить или использовать уже существующее поле, отражающее тип. В разделе «Web Services» опубликовать таблицу или страницу «Customer» так, чтобы поле «Type» (или «IsDealer», если создавалось пользовательское поле) было доступно из внешних систем.  
3.2) В Sales 365:  
• Открыть «Settings» → «Advanced Settings» → «Customizations» → «Customize the System».  
• В сущности «Account» создать поле (например, `DealerOrCustomer`), где значения — «Dealer» и «Customer».  
• Сохранить и опубликовать изменения.

4) Настроить Power Automate для извлечения данных из Salesforce  
4.1) В Power Automate (портал make.powerautomate.com) создать поток (например, «Scheduled cloud flow»), который регулярно получает список аккаунтов из Salesforce.  
• В триггере «Recurrence» указать расписание (например, ежедневно).  
• Добавить шаг «Salesforce» → «List records», выбрать объект «Account».  
• При необходимости задать фильтр: извлекать только аккаунты, где поле «Type» заполнено.  
4.2) В блоке «Apply to each» пройти по каждому аккаунту из Salesforce, сохранив поля идентификатора (например, `Id`) и типа (например, `Type` = Dealer/Customer).

5) Синхронизация записей с Business Central  
5.1) Добавить шаг «Business Central» → «Get record» или «List records» (в зависимости от требуемой логики) для поиска клиента с таким же идентификатором (или другим сопоставимым полем) в Business Central.  
5.2) При отсутствии клиента создать новую запись (действие «Create record»), указав поля:  
• Customer Number (или No.) — значение, сопоставляемое из Salesforce.  
• Тип клиента (например, «IsDealer = true» или «Type = Dealer»).  
• Другие поля (название, адрес).  
5.3) При наличии клиента обновить поле (действие «Update record»), где хранится тип (dealer vs. customer).  
5.4) Сохранить и опубликовать поток.

6) Синхронизация записей с Sales 365  
6.1) Создать или обновить аналогичный поток (или продолжить логику в том же потоке), который берёт те же записи из Salesforce и синхронизирует их в Sales 365.  
• Добавить шаг «Microsoft Dataverse» (или «Dynamics 365»), действие «Update a row» или «Create a new row» в сущности «Account».  
• Сопоставить поле «DealerOrCustomer» с «Type» из Salesforce.  
• Сохранить и опубликовать.  
6.2) Если необходимо, настраивать двухстороннюю синхронизацию (например, изменения в Business Central влияют на поле в Sales 365). В таком случае создавать отдельный поток, который регулярно читает записи из Business Central и обновляет их в Sales 365. Логика аналогична шагам выше, но направление передачи данных меняется (BC → Sales 365).

7) Проверить корректность сопоставления «dealers» и «customers»  
7.1) Выполнить тестовый запуск потоков, создавая несколько тестовых аккаунтов в Salesforce:  
• Один аккаунт с типом «Dealer».  
• Один аккаунт с типом «Customer».  
7.2) Убедиться, что при запуске потока в Business Central появились соответствующие записи (одна помечена как дилер, другая как клиент), а также в Sales 365 в поле «DealerOrCustomer» отображается правильное значение.  
7.3) Проверить, что при обновлении записи в Salesforce (например, изменить «Type» с Dealer на Customer), изменения корректно отражаются в Business Central и Sales 365 после выполнения потока.

8) Настройка дополнительных параметров и разграничений  
8.1) При необходимости создавать разные правила обработки «dealers» и «customers» в Business Central (например, разные группы учёта, разные прайс-листы). В данном случае в процессе «Update record» в Business Central можно установить поля:  
• Customer Posting Group = «DEALER» или «RETAIL» (пример).  
8.2) В Sales 365 можно настроить различные бизнес-процессы или представления (в разделе «Customize the System», вкладка «Views»), чтобы отделять дилеров от конечных клиентов (фильтр по полю «DealerOrCustomer = Dealer»).

9) Документирование и поддержка  
9.1) Задокументировать:  
• Какое поле в Salesforce определяет «dealer» и «customer».  
• Какое поле в Business Central и Sales 365 используется для хранения этой информации.  
• Шаблоны маппинга (какой идентификатор Salesforce сопоставлен с каким идентификатором в BC / Sales 365).  
9.2) Регулярно проверять журналы выполнения потоков в Power Automate (раздел «Run History») и настраивать оповещения об ошибках, чтобы оперативно узнавать о возможных проблемах.  
9.3) При изменении процессов (например, если вводится новый тип аккаунта) обновлять поля и потоки.

Таким образом, «dealers» и «customers» в Salesforce будут правильно сопоставлены и регулярно синхронизированы с Business Central и Sales 365. Это позволит всем системам иметь актуальные данные о типе клиентов и упрощать дальнейшие операции по управлению дилерами и конечными покупателями.