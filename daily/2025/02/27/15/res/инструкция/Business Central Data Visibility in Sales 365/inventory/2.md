Ниже представлена пошаговая инструкция на русском языке с использованием точных официальных названий программного обеспечения на английском языке (таких как Microsoft Business Central, Microsoft Dynamics 365 Sales, Microsoft Power Automate). Инструкция описывает, как сделать данные об остатках товара (inventory) из Microsoft Business Central доступными в Microsoft Dynamics 365 Sales, используя регулярную передачу через Microsoft Power Automate.

1) Определить структуру данных и объекты в Microsoft Business Central

1.1) Проверить, в каких таблицах Microsoft Business Central хранятся данные об остатках товара (inventory). Обычно используются таблицы Items (например, таблица 27) и таблицы для складских остатков (Warehouse Entries или Item Ledger Entries в зависимости от нужного уровня детализации).

1.2) Убедиться, что поля, необходимые для отображения остатков товара (например, артикул, доступное количество, расположение склада), присутствуют и заполнены корректными данными.

1.3) Если требуется ограничиться определенными товарами (например, только активные, доступные для продажи), настроить фильтры в Microsoft Business Central, чтобы исключить устаревшие или неактуальные позиции.

2) Подготовить сущность или поле в Microsoft Dynamics 365 Sales для отображения остатков

2.1) В Microsoft Dynamics 365 Sales открыть «Settings» → «Advanced Settings» → «Customizations» → «Customize the System».

2.2) Создать новую сущность (например, «Inventory»), если требуется хранение остатков в отдельных записях. При создании сущности указать имя (например, Inventory), набор полей (артикул товара, склад, доступное количество и т. д.) и настроить параметры отображения.

2.3) При необходимости, если достаточно обновлять только одно поле в сущности «Product» (или аналогичной стандартной сущности), добавить в нее пользовательское поле для отображения доступного остатка (например, AvailableQuantity). Тогда вместо новой сущности можно обойтись расширением полей для уже существующих продуктов.

3) Создать или настроить соединение (connector) в Microsoft Power Automate

3.1) Войти в Microsoft Power Automate. Перейти в «Data» → «Connections» и проверить наличие соединений для Microsoft Business Central и Microsoft Dynamics 365 Sales. Если соединений нет, добавить их, указав учетные данные и среду (environment).

3.2) Убедиться, что план лицензирования Microsoft Power Automate позволяет использовать премиум-коннекторы (Business Central connector и Microsoft Dataverse connector). При необходимости оформить дополнительную лицензию.

4) Создать поток (flow) в Microsoft Power Automate для регулярной передачи данных об остатках

4.1) Нажать «Create» → «Scheduled cloud flow». Указать интервал запуска (например, каждые 4 часа).

4.2) Добавить действие для чтения данных из Microsoft Business Central. В блоке «Choose an operation» выбрать коннектор «Business Central», затем «List records» (или «Get items» в зависимости от актуального названия операции). Указать нужную компанию (Company) и таблицу (например, «Items» или «Item Ledger Entries») и задать фильтры (например, только товары со статусом «Active»).

4.3) Добавить шаг, который будет обрабатывать результаты и формировать данные для загрузки в Microsoft Dynamics 365 Sales. Если требуется подсчитать доступное количество на складах, в Microsoft Power Automate можно использовать действия типа «Filter array» или «Select» для группировки и расчета итоговых остатков.

4.4) Добавить действие для записи данных в Microsoft Dynamics 365 Sales. Если была создана сущность «Inventory», выбрать «Microsoft Dataverse» → «Add a new row» (или «Update a row»), указать таблицу (например, «Inventory»). Сопоставить поля: артикул товара из ответа Microsoft Business Central → поле артикул в Microsoft Dynamics 365 Sales, доступное количество → соответствующее поле в Sales, и т. д.

4.5) Если нужно обновлять существующие записи в Microsoft Dynamics 365 Sales по ключу (например, по артикулу), в действии «Update a row» указать соответствующее поле для поиска (Alternate Key или стандартный ключ по GUID). При необходимости можно использовать «Get a row by an alternate key» или «List rows» для поиска и сравнения.

5) Обеспечить корректную логику обновления и устранение дубликатов

5.1) Если запись в Microsoft Dynamics 365 Sales создается впервые, использовать действие «Add a new row». Если запись уже существует, использовать «Update a row». Для этого в Microsoft Power Automate может потребоваться дополнительная логика: «Condition» с проверкой, существует ли запись с таким же артикулом.

5.2) При большом объеме товаров настроить порции (pagination) в Microsoft Power Automate и следить за лимитами (Threshold) в блоке «List records» коннектора Microsoft Business Central.

6) Проверить результат и задокументировать процесс

6.1) Запустить поток (flow) вручную или дождаться планового запуска (по расписанию). Перейти в «Monitor» → «Flow runs» (или «My flows» → «Run History»), просмотреть лог и убедиться, что данные корректно прошли из Microsoft Business Central в Microsoft Dynamics 365 Sales.

6.2) Открыть в Microsoft Dynamics 365 Sales сущность, где хранятся остатки (например, «Inventory» или поле «AvailableQuantity» в сущности «Product»), убедиться, что данные появились и соответствуют реальным остаткам из Microsoft Business Central.

6.3) Зафиксировать в описании проекта (документации) логику, поля, расписание (schedule) запуска Microsoft Power Automate, а также подробности о фильтрации данных в Microsoft Business Central.

7) Дополнительная автоматизация (необязательно)

7.1) Настроить оповещения в Microsoft Dynamics 365 Sales, если остаток на складе падает ниже заданного минимума. Для этого в Microsoft Dynamics 365 Sales можно использовать «Processes» → «Workflows» или «Power Automate» (Dataverse Trigger), которые срабатывают при изменении записи сущности «Inventory».

7.2) Настроить роли и безопасность в Microsoft Dynamics 365 Sales, чтобы менеджеры по продажам видели поля об остатках, но не могли изменять их напрямую (read-only доступ).

7.3) При необходимости обновлять не только складские остатки, но и цены, статусы кредитного лимита, истории покупок (YTD amount), можно добавить соответствующие блоки в тот же поток (flow) или создать отдельные потоки для каждой категории данных.

Эти действия позволяют регулярно передавать данные об остатках товара (inventory) из Microsoft Business Central в Microsoft Dynamics 365 Sales с помощью Microsoft Power Automate, делая их доступными отделу продаж без ручного переноса и обеспечивая актуальность сведений о наличии продукции.