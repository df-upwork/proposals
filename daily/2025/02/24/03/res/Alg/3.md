Alg-3 (Алгоритм вставки базовых размеров и аннотаций в AutoCAD на Python, с учётом всего предыдущего обсуждения):

1) Определить, какие именно размеры требуются для базового чертежа винтовой сваи.  
1.1) Исходя из пункта 6.2 (что клиент называет basic dimensions), к ним относятся: общий вид сваи, наружный диаметр трубы, толщина стенки, диаметр лопасти и общая длина (пункт 5.2 и 6.2).  
1.2) Данные об этих размерах читать из Excel в соответствии с Alg-1 (пункт 1.2, где говорится о необходимости автоматически получать параметры).  

2) Определить, какие текстовые обозначения (annotations) требуются в базовом чертеже.  
2.1) Исходя из пункта 7.2 (что клиент называет annotations), к ним относятся простые подписи (например, Pipe OD, Wall Thickness) и, при необходимости, обозначение верхней точки сваи, нижней точки и лопасти (пункты 5.2, 6.2 и 7.2).  
2.2) Для каждой аннотации указать формат текста (шрифт, высота) и язык (обычно английский, чтобы соответствовать permit-ready PDFs согласно пункту 4.2).  

3) В Python-скрипте установить связь с AutoCAD по COM (см. Alg-2, пункт 3 и 4).  
3.1) Использовать модуль win32com.client и объект AcadDocument, полученный ранее (пункты 10.2 о Python и AutoCAD).  
3.2) Обосновывается тем, что необходимо иметь доступ к методам для вставки размеров и аннотаций в ModelSpace (пункты 6.2, 7.2).  

4) Добавлять размеры (dimensions) через соответствующие методы объектной модели AutoCAD.  
4.1) Использовать методы вроде AddDimAligned, AddDimRotated или AddLeader (см. 10.2 о Python + AutoCAD COM), чтобы указать расстояния между ключевыми точками:  
4.1.1) Общая длина сваи – между верхней и нижней точками (пункт 6.2).  
4.1.2) Диаметр трубы – если в двумерном виде показывается окружность, можно применять Aligned Dimension в условном сечении (пункт 6.2).  
4.2) Обосновывается тем, что клиент явно указал необходимость отображать базовые размеры без ручной прорисовки (пункт 1.2 «The goal is to eliminate manual drafting», а также пункты 6.2 о basic dimensions).  

5) Добавлять текстовые обозначения (annotations).  
5.1) Использовать методы AddText, AddMText или эквивалентные функции для создания текстовых примечаний (пункты 7.2 о видах аннотаций).  
5.2) Для подписей указать ключевые параметры, например:  
5.2.1) Pipe OD = … (значение из Excel).  
5.2.2) Wall Thickness = …  
5.2.3) Helix Diameter = …  
5.3) При необходимости автоматически рассчитывать позицию текста, чтобы не перекрывать основной рисунок (см. пункт 7.2, где говорится о расстановке примечаний).  

6) При необходимости задавать стили размеров (Dimension Style) и текстовые стили (Text Style).  
6.1) Использовать объекты Style или настройку по умолчанию AutoCAD (см. пункты 10.2 и 11.2 о взаимодействии через COM).  
6.2) Обосновывается тем, что для permit-ready PDFs (пункт 4.2) часто требуется единообразное оформление, соответствующее требованиям для подачи документов.  

7) Проверить корректность итоговых размеров и аннотаций, учитывая геометрию свай из Alg-2.  
7.1) Сравнить значения, прочитанные из Excel (Alg-1), с теми, что отражаются в чертеже.  
7.2) Обосновывается тем, что в пункте 1.2 требуется создавать точные размеры (basic dimensions) и подписи (annotations) для быстрых согласований.  

8) Экспортировать результат в PDF, чтобы удостовериться, что размеры и аннотации корректно видны.  
8.1) См. шаг 9) из Alg-2 о PlotToFile или ExportToPDF.  
8.2) Обосновывается пунктом 1.2, где клиент говорит о permit-ready PDFs, и пунктом 4.2, который поясняет, что чертеж должен быть полностью готов к подаче на согласование.  

9) При необходимости повторять для разных конфигураций свай, если в Excel несколько строк.  
9.1) Циклически проходить по каждой записи, строить геометрию сваи (Alg-2), вставлять размеры и аннотации по шагам 4)–5), затем экспортировать PDF.  
9.2) Обосновывается тем, что требуется автоматизация без ручного создания отдельных чертежей (пункт 1.2 «eliminate manual drafting» и пункт 6.2 «basic dimensions for multiple piles»).  

10) Сохранить изменения в документе AutoCAD и при необходимости закрыть программу.  
10.1) Использовать методы SaveAs и Quit объекта AcadApplication (см. пункт 10.2 о Python + AutoCAD).  
10.2) Обосновывается тем, что после вставки всех размеров и аннотаций работа завершается, а промежуточный файл должен сохраняться для последующего использования (пункт 1.2 о быстром генерировании и хранении чертежей).