Alg-4 (Алгоритм экспорта чертежа в PDF, с учётом всего предыдущего обсуждения):

1) Убедиться, что в среде AutoCAD доступны все объекты, которые требуется вывести в итоговый файл PDF.  
1.1) Имеется в виду, что чертёж или его часть (в «ModelSpace» или на необходимом «Layout») завершены и содержат базовую геометрию винтовой сваи.  
Обоснование: см. пункт 1.2, где клиент указывает на необходимость автоматически формировать готовые к подаче чертежи (permit-ready PDFs).

2) Проверить, что необходимые размеры (dimensions) и аннотации (annotations) уже вставлены в чертёж.  
2.1) На этом этапе чертёж должен отражать все параметры сваи, включая наружный диаметр трубы, толщину стенки и лопасти (см. Alg-3).  
Обоснование: см. пункты 1.2 и 4.2 (клиент подчёркивает важность полноты информации на выходном PDF).

3) Настроить вывод (Plot) через соответствующий виртуальный принтер (например, «AutoCAD PDF (General Documentation).pc3»), если используется метод «PlotToFile».  
3.1) Перейти в «File» → «Plot» → «Page Setup Manager» или вызвать эквивалентный интерфейс через COM для указания принтера, размера листа и прочих параметров.  
Обоснование: см. пункт 1.2, где клиент просит исключить ручное черчение и гарантировать автоматизированный вывод в PDF.

4) При желании использовать метод «ExportToPDF» (если версия AutoCAD это поддерживает напрямую).  
4.1) Проверить в COM-объектной модели, что у объекта «Document» или «Layout» доступен метод «ExportToPDF».  
4.2) Указать путь к итоговому файлу PDF (например, `C:/Projects/HelicalPile.pdf`).  
Обоснование: см. пункт 10.2 (обсуждение использования Python и AutoCAD через COM) и пункт 1.2 (клиент требует экспортировать в PDF).

5) Установить параметры листа (layout settings), такие как масштаб (scale) и границы печати (plot area).  
5.1) Установить правильный формат листа (например, A3 или Letter), соответствующий требованиям разрешительных органов.  
Обоснование: см. пункт 4.2 (клиенту нужны permit-ready PDFs, обычно с корректными размерами листа и оформлением).

6) Выполнить команду вывода (Plot) или вызвать метод «PlotToFile» / «ExportToPDF» с ранее настроенными параметрами.  
6.1) При использовании COM, указать итоговый путь сохранения PDF в параметрах метода (например, `doc.Plot.PlotToFile("C:/Projects/HelicalPile.pdf")`).  
Обоснование: см. пункт 1.2 (клиент просит создать автоматический процесс формирования PDF) и ранее упомянутые пункты о взаимодействии с AutoCAD COM.

7) Убедиться, что итоговый файл PDF сформирован корректно и содержит все необходимые элементы чертежа (примитивы, размеры, аннотации).  
7.1) При необходимости выполнить открытие файла PDF внешним средством просмотра.  
Обоснование: см. пункт 1.2 (цель — быстро получать готовый к подаче PDF) и пункт 4.2 (требование полноты чертежа для разрешительных инстанций).

8) Сохранить DWG-файл, если требуется.  
8.1) Использовать метод «SaveAs» для объекта «Document» и указать путь к файлу DWG.  
Обоснование: см. пункт 1.2 (клиент ожидает повторяемый рабочий процесс, где PDF формируется на основе DWG, который при необходимости может быть сохранён).

9) Закрыть «Document» или всё приложение AutoCAD (объект «Application»), если дальнейшие действия не требуются.  
9.1) Метод «Quit» может использоваться для завершения работы AutoCAD, в случае когда автоматизация запускается из внешнего Python-скрипта.  
Обоснование: см. пункт 1.2 и пункт 10.2 (упоминается сценарий, когда AutoCAD используется в фоновом режиме для серии автоматических задач).

10) При наличии нескольких конфигураций сваи (несколько строк в Excel) повторить шаги 1–9 в цикле, генерируя набор PDF-файлов.  
10.1) Присвоить каждому PDF-файлу уникальное имя (например, на основе индекса или параметров сваи).  
Обоснование: см. пункт 1.2, где клиент говорит об исключении ручного формирования каждого чертежа и пункт 6.2 (упоминание разных вариантов свай).