У вашей задачи есть 2 хороших способа решения:
1) Entra Certificate-Based Authentication (CBA) с использованием стороннего управляемого PKI (PKIaaS)
1.1) Суть
Этот способ предполагает использование Entra Certificate-Based Authentication (CBA).
Этот способ использует стандартные протоколы смарт-карт (PIV) и полностью поддерживает автоматический выход из системы при извлечении токена средствами Windows.
Для устранения сложности управления инфраструктурой PKI предлагается использование облачных сервисов PKI (PKIaaS), предоставляемых специализированными поставщиками (например, Entrust, Sectigo, Keyfactor).
Поставщик берет на себя все задачи по управлению инфраструктурой CA и публикацией CRL.
Такие решения часто включают Систему управления сертификатами (Certificate Management System, CMS), предназначенную для управления физическими токенами (смарт-картами/YubiKey в режиме PIV).
CMS упрощает регистрацию пользователей, выпуск сертификатов на токены и самообслуживание.
1.2) Достоинства
1.2.1) Полная нативная поддержка требования автоматического выхода из системы при извлечении токена через политику Windows «Interactive logon: Smart card removal behavior».
1.2.2) Сложность развертывания и поддержки PKI перекладывается на поставщика услуг.
1.2.3) Наличие интегрированной CMS значительно упрощает управление жизненным циклом смарт-карт и YubiKey (регистрация, управление PIN, замена).
1.2.4) Решение является облачным и не требует локальной инфраструктуры.
1.2.5) Поставщики гарантируют высокую доступность и безопасность PKI и CRL.
1.3) Недостатки
1.3.1) Операционные затраты на подписку.
1.3.2) Доверие управлением критически важной инфраструктурой безопасности стороннему поставщику.
1.3.3) Требуется время на интеграцию сервиса с Entra ID и, возможно, с Intune.
2) Аутентификация FIDO2
2.1) Суть
Этот способ предлагает использовать стандарт FIDO2 для беспарольной аутентификации.
Пользователи используют физические токены (например, YubiKey в режиме FIDO2) для входа в Windows, присоединенные к Entra ID.
FIDO2 обеспечивает устойчивую к фишингу многофакторную аутентификацию (Phishing-resistant MFA).
2.2) Достоинства
2.2.1) Полностью устраняется необходимость в PKI, что радикально упрощает развертывание и поддержку.
2.2.2) Обеспечивается высокий уровень безопасности (Phishing-resistant MFA).
2.2.3) Пользовательский опыт аналогичен CBA: пользователь вставляет токен и вводит PIN-код.
2.2.4) Отсутствуют проблемы, связанные с управлением сертификатами (сроки действия, отзыв, CRL).
2.2.5) Решение является полностью облачным, легко масштабируемым и нативно поддерживается Entra ID и Windows.
2.3) Недостатки
Windows нативно не поддерживает автоматический выход из системы при извлечении ключа FIDO2.
Встроенная политика безопасности Windows «Interactive logon: Smart card removal behavior» работает только с токенами, использующими протокол смарт-карт (PIV), который применяется в Certificate-Based Authentication (CBA).
Реализация требуемого поведения для FIDO2 потребует использования стороннего программного обеспечения или скриптов, что усложняет развертывание и поддержку.

