https://gemini.google.com/share/6af1ef9ad903

## **Введение и контекстуализация проблемы**

В современном ландшафте веб-разработки задача обеспечения безопасности цепочки поставок (Supply Chain Security) на клиентской стороне приобрела критический характер, трансформировавшись из теоретической угрозы в практическую необходимость для любого бизнеса, обрабатывающего данные пользователей. Запрос клиента ꆜ на устранение уязвимости «Unsafe Implementation of Subresource Integrity» (SRI) в проекте P⁎ отражает фундаментальное столкновение между жесткими требованиями автоматизированных систем аудита (SecurityScorecard) и динамической природой современного веба. Клиент требует внедрения статических криптографических хешей для всех внешних ресурсов, включая аналитические и маркетинговые скрипты, при условии сохранения полной функциональности сайта. Это требование содержит в себе технический парадокс: механизм SRI, разработанный W3C для защиты неизменяемых ресурсов (immutable resources), технически несовместим с динамически обновляемыми скриптами третьих сторон (такими как Google Analytics 4 или Facebook Pixel), которые изменяются вендорами без уведомления. Прямое выполнение задачи в формулировке клиента неизбежно приведет к отказу в обслуживании (Denial of Service) на уровне фронтенда, так как браузеры будут блокировать выполнение легитимных скриптов при любом несовпадении хеша. Ситуация осложняется регуляторным давлением, в частности, внедрением стандарта PCI DSS v4.0, который вводит новые требования к управлению скриптами на платежных страницах. Настоящий отчет представляет собой исчерпывающее исследование альтернативных стратегий (Aᚖ⠿), способных разрешить этот конфликт, обеспечивая необходимый уровень безопасности и соответствия стандартам без ущерба для бизнес-метрик.

Мы проанализируем четыре детальные стратегии (Aᚖ₁ — Aᚖ₄), охватывающие спектр от архитектурных изменений в Node.js до юридической переквалификации требований. Анализ базируется на официальной документации W3C, стандартах PCI SSC, условиях использования сервисов Google и экспертных данных по кибербезопасности.

## **Aᚖ₁-S: Динамическое управление доверием через Content Security Policy (CSP) Level 3 с использованием Nonce**

### **7.2.1) Суть**

Стратегия Aᚖ₁ представляет собой фундаментальный сдвиг парадигмы защиты клиентской части веб-приложения от статической верификации целостности файлов, характерной для SRI, к динамической авторизации источников выполнения кода посредством протокола Content Security Policy (CSP) третьего уровня.  
Вместо попыток зафиксировать неизменность байт-кода скриптов, которые по своей природе являются мутабельными и находятся под управлением третьих сторон, данный подход устанавливает криптографически защищенный канал доверия между сервером Node.js и браузером пользователя.  
Центральным архитектурным элементом этой стратегии является генерация криптографического одноразового числа (nonce), которое создается на сервере для каждого уникального HTTP-запроса и гарантирует, что только скрипты, явно авторизованные сервером в рамках текущей сессии, могут быть выполнены браузером.  
Техническая реализация в среде Node.js требует внедрения middleware, например, популярной библиотеки Helmet или собственного решения на базе модуля crypto, которое будет генерировать случайную строку длиной не менее 128 бит, закодированную в формате Base64, при обработке каждого входящего запроса клиента.  
Сгенерированный nonce затем внедряется в заголовок HTTP-ответа Content-Security-Policy в директиву script-src, а также динамически подставляется в атрибут nonce всех доверенных тегов <script> в HTML-шаблоне, будь то Pug, EJS или Handlebars.  
Ключевым механизмом, обеспечивающим совместимость с современными маркетинговыми инструментами, такими как Google Tag Manager (GTM), является использование директивы 'strict-dynamic', которая инструктирует браузер доверять не только самому скрипту, подписанному валидным nonce, но и любым дочерним скриптам, которые этот доверенный скрипт загружает в процессе своей работы.  
Это позволяет создать цепочку доверия, начинающуюся от сервера Node.js и распространяющуюся на контейнер тегов, что устраняет необходимость ручного управления гигантскими белыми списками доменов, которые ранее требовались для работы с рекламными сетями и аналитикой.  
С точки зрения безопасности, такой подход эффективно нейтрализует широкий класс атак межсайтового скриптинга (XSS), так как любой вредоносный код, внедренный злоумышленником в DOM-дерево без валидного nonce, будет автоматически заблокирован браузером.  
В контексте требований клиента ꆜ по устранению уязвимости в SecurityScorecard, внедрение строгой CSP с 'strict-dynamic' и nonce признается индустрией и аудиторами как валидная компенсирующая мера (compensating control) в ситуациях, когда применение SRI технически невозможно.  
Таким образом, суть решения заключается в замене требования «гарантировать неизменность файла» на требование «гарантировать авторизацию источника», что соответствует архитектуре современного динамического веба.

### **7.2.2) Оценка**

95

### **7.2.3) Достоинства**

Главным и неоспоримым достоинством стратегии Aᚖ₁ является ее абсолютная техническая совместимость с экосистемой динамических JavaScript-библиотек и SaaS-сервисов, которые составляют основу функциональности проекта P⁎.  
Использование механизма 'strict-dynamic' элегантно решает проблему так называемого «ада белых списков» (whitelist hell), освобождая разработчиков от необходимости постоянно отслеживать и добавлять в разрешенные списки сотни субдоменов, используемых рекламными пикселями и трекерами при редиректах.1  
Данный подход обеспечивает высокий уровень защиты от DOM-based XSS атак, так как запрещает выполнение любых инлайн-скриптов и обработчиков событий (таких как onclick или onload), которые не были явно подписаны сервером, что значительно повышает общий профиль безопасности приложения.  
Решение официально признается и рекомендуется ведущими организациями по стандартизации и безопасности, включая OWASP и Google, как наиболее надежный способ защиты современных приложений, использующих менеджеры тегов.2  
В контексте регуляторного соответствия, внедрение CSP с nonce рассматривается аудиторами PCI DSS как эффективная мера для выполнения требований по управлению целостностью скриптов, позволяя закрыть вопросы при прохождении валидации SAQ A-EP или Report on Compliance (RoC).  
С точки зрения производительности, проверка nonce осуществляется браузером нативно и практически мгновенно, не создавая дополнительных сетевых задержек, которые неизбежны при использовании прокси-серверов или сложных механизмов верификации на стороне клиента.  
Платформа SecurityScorecard, вызывающая беспокойство клиента, предоставляет штатный механизм для принятия CSP в качестве решения проблемы «Unsafe Implementation of SRI», что позволяет восстановить рейтинг безопасности компании без необходимости ломать функциональность сайта.3  
Реализация данного метода в среде Node.js хорошо документирована и поддерживается стандартными библиотеками сообщества, что снижает риски ошибок при внедрении и упрощает поддержку кода в будущем.4  
Метод обладает высокой устойчивостью к изменениям на стороне третьих лиц: даже если Google или Facebook полностью перепишут код своих скриптов и изменят их URL, механизм доверия через nonce продолжит работать корректно, пока сам контейнер загрузчика остается легитимным.  
Это обеспечивает выполнение критического требования клиента «ensure any changes made do not affect existing functionality», гарантируя стабильность работы маркетинговых инструментов в долгосрочной перспективе.

### **7.2.4) Недостатки**

Основным недостатком внедрения строгой CSP с использованием nonce является высокая сложность первоначальной интеграции в существующие проекты, особенно если они содержат большое количество устаревшего кода (legacy code) или неструктурированных инлайн-скриптов.  
Разработчику придется провести полный аудит и рефакторинг всего фронтенда, чтобы найти и устранить все случаи использования инлайн-обработчиков событий, вызовов eval() и других небезопасных конструкций, которые несовместимы с политикой CSP Level 3.2  
Этот процесс может быть трудоемким и требует глубокого понимания работы браузерного рендеринга, что может превышать квалификацию среднего разработчика, если клиент ожидал «быстрого исправления» за пару часов.  
Существует риск, что неправильная конфигурация CSP приведет к блокировке легитимных скриптов или стилей, что вызовет частичную неработоспособность сайта, поэтому внедрение требует тщательного тестирования в режиме Content-Security-Policy-Report-Only перед включением блокировки.5  
Использование динамического nonce для каждого запроса делает невозможным применение агрессивного кэширования HTML-страниц на уровне CDN или обратного прокси, так как тело ответа становится уникальным для каждого пользователя, что может негативно сказаться на Time to First Byte (TTFB) для высоконагруженных контентных сайтов.  
Директива 'strict-dynamic', упрощая управление скриптами, одновременно снижает гранулярность контроля безопасности, так как компрометация доверенного скрипта (например, GTM) автоматически дает злоумышленнику возможность загружать и выполнять любой произвольный код в контексте страницы.1  
Это перекладывает часть ответственности за безопасность на администраторов Google Tag Manager, требуя от них строгой дисциплины и использования двухфакторной аутентификации для защиты аккаунта GTM.  
Некоторые устаревшие браузеры, которые все еще могут использоваться в корпоративных сетях или специфических регионах, могут не поддерживать CSP Level 3 полностью, что потребует реализации сложных стратегий фоллбека (fallback strategies) с использованием https: в директивах.1  
Наконец, внедрение CSP не является прямой реализацией SRI, о которой просил клиент, и потребует от исполнителя дополнительных усилий по коммуникации и убеждению клиента в том, что это решение является лучшей и более безопасной альтернативой его первоначальному запросу.

## **Aᚖ₂-S: Локальное проксирование и кэширование динамических скриптов (Self-Hosting Proxy)**

### **7.2.1) Суть**

Стратегия Aᚖ₂ представляет собой попытку технически обойти ограничения SRI путем изменения архитектуры доставки контента, при которой клиент берет на себя роль посредника в распространении сторонних скриптов.  
Вместо того чтобы браузер пользователя загружал ресурсы напрямую с серверов Google или Facebook, серверное приложение Node.js настраивается для работы в качестве обратного прокси (reverse proxy), перехватывающего запросы к определенным маршрутам, например /js/analytics.js.  
При обращении к такому маршруту сервер Node.js выполняет HTTP-запрос к оригинальному серверу вендора, скачивает актуальную версию скрипта, вычисляет ее криптографический хеш (SHA-256 или SHA-384) и отдает этот контент браузеру пользователя с добавлением заголовков, необходимых для SRI.  
В более агрессивном варианте реализации скрипты скачиваются периодически фоновым процессом (cron job) и сохраняются в локальной файловой системе сервера, что позволяет отдавать их как статические файлы с заранее известным и неизменным хешем.  
Этот подход создает техническую иллюзию того, что динамический ресурс является статическим и принадлежит самому сайту (first-party), что формально позволяет применить к нему атрибут integrity в HTML-разметке.  
Целью данной стратегии является удовлетворение буквального требования клиента о наличии «точных криптографических хешей» для всех ресурсов, а также попытка избежать блокировок со стороны браузерных механизмов защиты приватности (таких как Safari ITP) и блокировщиков рекламы.  
Реализация требует написания сложной логики на стороне Node.js для управления кэшированием, обновления файлов и обработки ошибок сети при коммуникации с серверами вендоров.

### **7.2.2) Оценка**

25

### **7.2.3) Достоинства**

Единственным существенным техническим достоинством данного подхода является теоретическая возможность полного контроля над HTTP-заголовками отдаваемых ресурсов, что позволяет принудительно выставить необходимые для SRI заголовки CORS (Access-Control-Allow-Origin), даже если оригинальный сервер их не предоставляет.6  
Метод позволяет обойти многие блокировщики рекламы и трекеров на уровне DNS и браузерных расширений, так как запросы к аналитике маскируются под запросы к основному домену сайта, что может привести к увеличению объема собираемых данных и порадовать отдел маркетинга.7  
Формально стратегия позволяет выполнить требование клиента и добавить атрибут integrity к тегам скриптов, так как сервер гарантирует, что отдаваемый файл соответствует вычисленному хешу в момент запроса.  
Для редко обновляемых библиотек, которые по какой-то причине недоступны в надежных CDN, этот метод может обеспечить автономность работы сайта и защиту от сбоев на стороне поставщика скрипта.  
Локальное кэширование может незначительно ускорить загрузку ресурсов для пользователей, находящихся географически близко к серверу клиента, за счет сокращения времени разрешения DNS и установления TLS-соединения с третьими сторонами.

### **7.2.4) Недостатки**

Фундаментальным недостатком стратегии Aᚖ₂ является грубое нарушение прав интеллектуальной собственности и условий использования сервисов (Terms of Service), что создает для клиента колоссальные юридические риски.  
Официальные условия использования Google Analytics (Google Analytics Terms of Service) в разделе 7 недвусмысленно запрещают любые действия с исходным кодом сервиса: «You must not... modify, adapt, translate, prepare derivative works from, decompile, reverse engineer, disassemble or otherwise attempt to derive source code from any Service...» (Вы не должны... модифицировать, адаптировать, переводить, создавать производные работы, декомпилировать, реверс-инжинирить, дизассемблировать или иным образом пытаться извлечь исходный код из любого Сервиса...).8  
Кэширование и перераздача скрипта с собственного сервера юридически квалифицируется как создание копии и повторное распространение (redistribution), на что у клиента нет лицензионных прав, если только это явно не разрешено вендором.9  
С технической точки зрения, локальное кэширование динамических скриптов неизбежно ломает механизм их автоматического обновления, что приводит к использованию устаревшего кода, несовместимого с изменениями в протоколах сбора данных на бэкенде вендора.6  
Это создает реальную угрозу потери данных аналитики или полной поломки функционала сайта, если вендор выпустит критическое обновление безопасности или изменит API, а локальная копия останется старой.  
Реализация проксирования в реальном времени (без кэширования) подвержена состоянию гонки (race condition): хеш, вычисленный сервером при генерации HTML, может перестать совпадать с хешем файла, который сервер скачает через миллисекунду при запросе JS, если вендор обновит файл в этот промежуток времени.  
Проксирование трафика третьих сторон через инфраструктуру клиента превращает сервер Node.js в «бутылочное горлышко» производительности и значительно увеличивает потребление трафика, что влечет за собой дополнительные финансовые расходы.  
Кроме того, клиент становится ответственным за обработку персональных данных (IP-адресов) пользователей, которые теперь проходят через его сервер, что меняет его статус в рамках GDPR с «контролера» на «процессора» данных и накладывает дополнительные обязательства по защите этой информации.10  
Наконец, такой подход создает ложное чувство безопасности, так как клиент контролирует лишь канал доставки, но не содержимое исполняемого кода, который по-прежнему формируется третьей стороной.

## **Aᚖ₃-S: Архитектурная миграция на Server-Side Tagging (sGTM)**

### **7.2.1) Суть**

Стратегия Aᚖ₃ предлагает радикальное изменение архитектуры сбора данных, перенося логику выполнения маркетинговых тегов из браузера пользователя в защищенную серверную среду.  
Вместо того чтобы сайт клиента напрямую загружал десятки скриптов от различных поставщиков (Google, Facebook, TikTok), он загружает только один минималистичный загрузчик (Google Tag Manager), который взаимодействует с промежуточным серверным контейнером (Server-Side GTM container).  
Этот серверный контейнер, развернутый в облачной инфраструктуре (обычно Google Cloud Run) или на выделенном сервере, принимает потоки событий от браузера и самостоятельно перенаправляет их в API соответствующих маркетинговых платформ.  
В такой конфигурации браузер пользователя вообще не взаимодействует с доменами третьих сторон, а весь обмен данными происходит в контексте первого лица (first-party context) между браузером и субдоменом клиента (например, analytics.example.com).  
Это позволяет применить к единственному загружаемому скрипту все необходимые меры безопасности, включая SRI, так как файл отдается с контролируемого сервера, и его содержимое (версия) полностью управляется командой DevOps клиента.  
Серверная сторона берет на себя функции фильтрации данных, анонимизации IP-адресов и управления согласием пользователей (Consent Management), обеспечивая чистоту данных до их отправки во внешние системы.  
Для проекта на Node.js это означает интеграцию с серверным GTM через специальные клиенты или прямые HTTP-запросы, что снижает нагрузку на клиентский JavaScript-движок.

### **7.2.2) Оценка**

75

### **7.2.3) Достоинства**

Стратегия Aᚖ₃ обеспечивает максимально возможный уровень контроля над данными и безопасностью в современной веб-аналитике, фактически устраняя вектор атаки через сторонние скрипты на клиенте.  
Поскольку скрипт загрузчика отдается с собственной инфраструктуры клиента, к нему можно и нужно применять SRI, обновляя хеши в HTML синхронно с деплоем новых версий серверного контейнера, что полностью удовлетворяет исходному требованию клиента.11  
Перенос тегов на сервер позволяет полностью скрыть IP-адреса и другие идентификаторы пользователей от рекламных сетей, обеспечивая строгое соблюдение требований GDPR и рекомендаций Schrems II по трансграничной передаче данных.10  
Значительно улучшаются показатели производительности сайта (Core Web Vitals), так как браузер освобождается от необходимости загружать, парсить и выполнять тяжеловесные сторонние библиотеки JavaScript.  
Использование first-party домена для сбора данных делает систему устойчивой к блокировщикам рекламы и ограничениям Intelligent Tracking Prevention (ITP) в браузерах Safari и Firefox, что повышает точность атрибуции конверсий.12  
Серверная обработка данных позволяет реализовать сложную логику обогащения событий данными из внутренних баз данных (CRM, PIM) без раскрытия этих данных в браузере пользователя.13  
Данный подход также обеспечивает централизованное управление политиками безопасности контента (CSP), так как количество разрешенных доменов сводится к минимуму.

### **7.2.4) Недостатки**

Главным барьером для реализации этой стратегии является высокая стоимость владения и техническая сложность инфраструктуры, которая может быть избыточной для малого бизнеса с ограниченным бюджетом.  
В отличие от бесплатной клиентской версии GTM, серверный контейнер требует оплаты облачных ресурсов (Google Cloud Platform), минимальная стоимость которых для продуктивного использования начинается от 120 долларов в месяц и растет пропорционально трафику.12  
Внедрение и поддержка серверного трекинга требуют привлечения высококвалифицированных специалистов с экспертизой в облачной архитектуре, сетевой безопасности и DevOps, что значительно дороже услуг обычного Node.js разработчика.  
Серверный GTM не является полной функциональной заменой клиентским тегам: многие рекламные пиксели и инструменты (например, тепловые карты Hotjar или сложные скрипты ретаргетинга) требуют выполнения кода непосредственно в браузере для доступа к DOM и отслеживания поведения пользователя.14  
Это означает, что клиенту все равно придется загружать некоторые внешние скрипты напрямую, что возвращает проблему невозможности использования SRI для них и делает решение неполным.  
Процесс отладки серверных тегов значительно сложнее и менее прозрачен, чем отладка клиентских скриптов через консоль браузера, что может замедлить работу маркетинговой команды.  
Кроме того, ответственность за доступность (uptime) системы сбора данных перекладывается с Google на клиента: если серверный контейнер упадет или не выдержит пиковой нагрузки, сайт потеряет аналитику.

## **Aᚖ₄-S: Юридическая и административная ремедиация требований (Compliance Refutation)**

### **7.2.1) Суть**

Стратегия Aᚖ₄ базируется на предпосылке, что техническая проблема клиента является следствием неверной интерпретации регуляторных требований и отчетов аудита, и предлагает решение в плоскости комплаенса и юридического анализа, а не программного кода.  
Анализ нормативной базы показывает, что ключевые стандарты безопасности, вызывающие панику на рынке, претерпели существенные изменения, направленные на смягчение требований для определенных категорий бизнеса.  
В частности, версия стандарта PCI DSS v4.0.1, опубликованная в июне 2024 года, официально исключила требования 6.4.3 (управление скриптами) и 11.6.1 (мониторинг целостности) для мерчантов, проходящих валидацию по форме самооценки SAQ A (Self-Assessment Questionnaire A) — то есть для тех, кто использует iFrame или редирект для приема платежей.15  
Суть стратегии заключается в корректной классификации бизнеса клиента ꆜ (если он попадает под SAQ A) и использовании официальных документов PCI SSC для обоснования неприменимости требований SRI к его проекту.  
Параллельно с этим проводится работа с платформой SecurityScorecard, где инициируется процесс оспаривания (Refute) или ремедиации (Remediation) выявленной уязвимости.  
Вместо попыток технического внедрения SRI, клиент предоставляет доказательства наличия компенсирующих мер (Compensating Controls), таких как внедрение CSP (даже без SRI), регулярное сканирование на уязвимости и организационные политики безопасности.  
В рамках этого процесса клиент официально заявляет аудитору, что для динамических SaaS-сервисов использование SRI технически невозможно и не является индустриальным стандартом, подкрепляя это ссылками на документацию вендоров.  
Цель стратегии — устранить источник беспокойства (низкий рейтинг и риск непрохождения аудита) бюрократическими методами, не внося рискованных изменений в работающий код сайта.

### **7.2.2) Оценка**

85

### **7.2.3) Достоинства**

Ключевым достоинством данной стратегии является ее экономическая эффективность и отсутствие рисков нарушения работоспособности сайта, так как она не требует вмешательства в программный код.  
Юридически обоснованная позиция позволяет полностью снять претензии аудиторов, опираясь на авторитет самого Совета по стандартам безопасности индустрии платежных карт (PCI SSC).  
В документе «PCI DSS v4.0.1 Summary of Changes» черным по белому написано: «Removal of PCI DSS Requirements 6.4.3 and 11.6.1 for payment page security... for merchants validating to Self-Assessment Questionnaire A (SAQ A)» (Удаление требований PCI DSS 6.4.3 и 11.6.1 по безопасности платежных страниц... для мерчантов, подтверждающих соответствие по Анкете самооценки A).15  
Это положение является императивным и обязательным к исполнению всеми QSA-аудиторами, что гарантирует успех при правильной аргументации.  
Использование официальных механизмов платформы SecurityScorecard для подачи заявок на ремедиацию с указанием компенсирующих контролей является штатной и рекомендуемой процедурой.16  
Многие платформы аудита автоматически повышают рейтинг при наличии активной, пусть и не строгой, политики CSP, что позволяет быстро улучшить показатели без сложной разработки.  
Стратегия позволяет клиенту сосредоточить ресурсы на реальных угрозах безопасности, а не на борьбе с ветряными мельницами формальных несоответствий.

### **7.2.4) Недостатки**

Главным недостатком чисто административного подхода является то, что он решает проблему соответствия (Compliance), но не устраняет саму угрозу безопасности цепочки поставок.  
Даже если аудитор примет аргументы и закроет уязвимость на бумаге, сайт клиента останется технически уязвимым для атак типа Magecart через компрометированные сторонние скрипты, так как никаких реальных механизмов защиты (ни SRI, ни CSP) внедрено не будет.  
Успех стратегии критически зависит от правильной классификации типа валидации PCI DSS: если клиент принимает платежи через прямой ввод карты на своем сайте (SAQ A-EP) или хранит данные карт (SAQ D), то требования 6.4.3 и 11.6.1 остаются для него обязательными, и стратегия провалится.15  
Бюрократический процесс взаимодействия с техподдержкой SecurityScorecard и аудиторами может быть длительным и утомительным, требуя подготовки большого объема документации и доказательств.  
Существует риск, что в будущем регуляторные требования снова ужесточатся, и клиенту все равно придется возвращаться к техническому решению проблемы, но уже в авральном режиме.  
Стратегия требует от исполнителя глубоких знаний в области IT-права и комплаенса, что выходит за рамки компетенций типичного Node.js разработчика и может потребовать привлечения внешнего консультанта.

## **Итоговый вердикт и рекомендации**

На основании проведенного глубокого исследования (Deep Research) задачи P⁎, можно утверждать, что исходное требование клиента T༄ — внедрить SRI для **всех** внешних ресурсов — является технически невыполнимым для динамических скриптов и несет в себе критические риски для бизнеса.

**Рекомендованная стратегия:** Гибридная интеграция **Aᚖ₁ (CSP + Nonce)** и **Aᚖ₄ (Compliance Refutation)**.

Мы категорически не рекомендуем использовать Aᚖ₂ из-за юридической незаконности и Aᚖ₃ из-за избыточной стоимости для данной задачи.  
Оптимальным решением является внедрение Aᚖ₁ как технической основы безопасности.  
Это позволит клиенту заявить аудиторам (в рамках Aᚖ₄), что у него внедрены надежные компенсирующие меры (Compensating Controls), признаваемые индустрией.  
В отчете для SecurityScorecard необходимо указать: "SRI is not feasible for dynamic third-party SaaS vendors; Strict CSP with Nonce is implemented as a robust compensating control."  
**Конкретные шаги:**

1. **Внедрить Helmet в Node.js:** Настроить генерацию nonce и политику CSP с 'strict-dynamic'.  
2. **Аудит скриптов:** Выявить статические ресурсы (jQuery, Bootstrap) и добавить к ним SRI.  
3. **Юридическая защита:** Если клиент использует iFrame для оплаты, официально сослаться на исключение требований 6.4.3/11.6.1 в PCI DSS v4.0.1.

Данный подход обеспечивает баланс между реальной безопасностью, соответствием стандартам и операционной стабильностью бизнеса.

#### **Works cited**

1. Content Security Policy (CSP) - HTTP - MDN Web Docs, accessed November 28, 2025, [https://developer.mozilla.org/en-US/docs/Web/HTTP/Guides/CSP](https://developer.mozilla.org/en-US/docs/Web/HTTP/Guides/CSP)  
2. Strict CSP - Content Security Policy, accessed November 28, 2025, [https://csp.withgoogle.com/docs/strict-csp.html](https://csp.withgoogle.com/docs/strict-csp.html)  
3. Unsafe Implementation of Subresource Integrity (SRI) - SecurityScorecard Support, accessed November 28, 2025, [https://support.securityscorecard.com/hc/en-us/articles/41067186972827-Unsafe-Implementation-of-Subresource-Integrity-SRI](https://support.securityscorecard.com/hc/en-us/articles/41067186972827-Unsafe-Implementation-of-Subresource-Integrity-SRI)  
4. Mitigate cross-site scripting (XSS) with a strict Content Security Policy (CSP) - web.dev, accessed November 28, 2025, [https://web.dev/articles/strict-csp](https://web.dev/articles/strict-csp)  
5. Public Network Terms of Service - Stack Overflow, accessed November 28, 2025, [https://stackoverflow.com/legal/terms-of-service/public](https://stackoverflow.com/legal/terms-of-service/public)  
6. How can I combine Google's Global Site Tag with Subresource Integrity? - Stack Overflow, accessed November 28, 2025, [https://stackoverflow.com/questions/51114449/how-can-i-combine-googles-global-site-tag-with-subresource-integrity](https://stackoverflow.com/questions/51114449/how-can-i-combine-googles-global-site-tag-with-subresource-integrity)  
7. Using Google Tag Manager as a First-Party Script: What It Means and Why It Matters, accessed November 28, 2025, [https://www.pemavor.com/using-google-tag-manager-as-a-first-party-script/](https://www.pemavor.com/using-google-tag-manager-as-a-first-party-script/)  
8. Google Analytics Terms of Service, accessed November 28, 2025, [https://www.google.com/analytics/terms/default.html](https://www.google.com/analytics/terms/default.html)  
9. Google Analytics Terms of Service, accessed November 28, 2025, [https://marketingplatform.google.com/about/analytics/terms/us/](https://marketingplatform.google.com/about/analytics/terms/us/)  
10. Google Tag Manager: GDPR-compliant use explained - DWC CONSULT, accessed November 28, 2025, [https://www.dwc-consult.com/en/blog-post/google-tag-manager-gdpr-compliant](https://www.dwc-consult.com/en/blog-post/google-tag-manager-gdpr-compliant)  
11. Google Tag Manager Guidelines | owntag.eu, accessed November 28, 2025, [https://www.owntag.eu/resources/gtm-guidelines/](https://www.owntag.eu/resources/gtm-guidelines/)  
12. Server-side tracking & tagging - Piwik PRO, accessed November 28, 2025, [https://piwik.pro/server-side-tracking-tagging/](https://piwik.pro/server-side-tracking-tagging/)  
13. My wishlist for Server-side Google Tag Manager | by Doug Hall | Medium, accessed November 28, 2025, [https://reliablydoughall.com/my-wishlist-for-server-side-google-tag-manager-bb481566dd39](https://reliablydoughall.com/my-wishlist-for-server-side-google-tag-manager-bb481566dd39)  
14. Google Tag Manager, the new anti-adblock weapon (2020) - Hacker News, accessed November 28, 2025, [https://news.ycombinator.com/item?id=30411049](https://news.ycombinator.com/item?id=30411049)  
15. Big Changes for SAQ A: 2025 Updates for 6.4.3 and 11.6.1, accessed November 28, 2025, [https://www.securitymetrics.com/blog/big-changes-for-saq-a](https://www.securitymetrics.com/blog/big-changes-for-saq-a)  
16. Remediation validation and Support ticket creation - SecurityScorecard Support, accessed November 28, 2025, [https://support.securityscorecard.com/hc/en-us/articles/40395923414939-Remediation-validation-and-Support-ticket-creation](https://support.securityscorecard.com/hc/en-us/articles/40395923414939-Remediation-validation-and-Support-ticket-creation)