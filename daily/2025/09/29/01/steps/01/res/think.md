https://g.co/gemini/share/db5494f41b84

### Анализ контекста

Предполагается, что клиент (`ꆜ`) использует облачную версию D365 Business Central (SaaS).

Исследование подтверждает, что проблема (`P†`) вызвана фундаментальным ограничением платформы SaaS. Генерация отчетов (в частности, PDF) происходит на серверах Microsoft Azure. По соображениям безопасности, стабильности и лицензирования Microsoft не разрешает пользователям устанавливать произвольные шрифты в этой среде.

Я проверил официальную документацию:
⊤⟦Microsoft Learn: Available fonts - Business Central⟧ (Шрифт "Century Gothic" **отсутствует** в списке предустановленных шрифтов для D365 BC SaaS).

Если механизм рендеринга не находит запрошенный шрифт на сервере, он автоматически заменяет его на доступный шрифт по умолчанию (например, Arial).

Ниже представлен анализ найденных способов решения (`S⠿`).

---

# 1. Анализ `S⠿`

## S₁: Встраивание шрифта в макет Word (Word Layout Font Embedding)

### Описание
D365 BC поддерживает макеты Microsoft Word (.docx). В Word есть функция встраивания шрифтов непосредственно в файл (File → Options → Save → "Embed fonts in the file"). Теоретически, если шрифт успешно встроен, механизм рендеринга BC SaaS может использовать его при генерации PDF. Опыт экспертов сообщества (например, Erik Hougaard) показывает, что этот метод может быть успешным, если выполнен корректно.

### Достоинства
*   **(P1.1) Стоимость:** Бесплатно. Не требует дополнительных лицензий или разработки.
*   **(P1.2) Простота:** Реализуется стандартными средствами Word и загрузкой макета в BC (Custom Report Layouts).

### Недостатки
*   **(C1.1) Зависимость от лицензии шрифта:** Успех критически зависит от прав на встраивание (Font Embeddability) конкретного файла "Century Gothic". Если лицензия запрещает встраивание, Word не внедрит шрифт.
*   **(C1.2) Ограничение типа макета:** Применимо только к Word Layouts. Не работает для RDLC-макетов. Конвертация сложных RDLC в Word может быть трудоемкой.
*   **(C1.3) Ненадежность:** Хотя метод часто работает, он не гарантирован на 100% и может зависеть от настроек в Word (например, необходимо отключить "Do not embed common system fonts").

### Оценка: 75/100

---

## S₂: Сторонние ISV-решения для отчетности (Third-party Reporting Tools)

### Описание
Использование специализированных приложений из Microsoft AppSource (например, **ForNAV** или **Docentric**). Эти решения предоставляют собственные движки рендеринга, которые обходят ограничения платформы SaaS и автоматически внедряют пользовательские шрифты в PDF.

### Достоинства
*   **(P2.1) Надежность:** Гарантированное и поддерживаемое вендором решение.
*   **(P2.2) Улучшенные инструменты:** Часто предлагают более мощные и удобные дизайнеры отчетов.
*   **(P2.3) Универсальность:** Работает для сложных отчетов, которые трудно реализовать стандартными средствами.

### Недостатки
*   **(C2.1) Стоимость:** Требуется приобретение подписки/лицензий.
*   **(C2.2) Внедрение и обучение:** Требуется время на изучение инструмента и конвертацию отчетов в новый формат.
*   **(C2.3) Ограничения предпросмотра:** ⊤⟦ForNAV Knowledge Base⟧ (Предпросмотр в веб-клиенте BC может не отображать пользовательский шрифт; он виден только в финальном PDF).

### Оценка: 90/100

---

## S₃: Внешний сервис рендеринга (External Rendering Engine)

### Описание
Разработка внешнего микросервиса (например, Azure Function). BC отправляет данные отчета (JSON/XML) в этот сервис. Сервис, используя сторонние библиотеки генерации PDF (например, PDFSharp, IronPDF), которые поддерживают полное внедрение шрифтов, генерирует документ с "Century Gothic" и возвращает его в BC.

### Достоинства
*   **(P3.1) Полный контроль и гибкость:** Гарантирует использование любого шрифта и сложного форматирования, обходя все ограничения BC SaaS.
*   **(P3.2) Качество вывода:** Генерируется высококачественный PDF с внедренным текстом (с возможностью поиска и копирования).

### Недостатки
*   **(C3.1) Высокая сложность разработки:** Требует значительных компетенций в AL, Azure и языке микросервиса (например, C#).
*   **(C3.2) Усложнение архитектуры:** Увеличивает накладные расходы на поддержку и инфраструктуру Azure.
*   **(C3.3) Задержки:** Сетевое взаимодействие замедляет генерацию отчета.

### Оценка: 65/100

---

## S₄: Преобразование текста в графику (Text as Graphics/SVG)

### Описание
Текст конвертируется в векторное (SVG paths) или растровое (PNG) изображение и вставляется в отчет как графический элемент. Для динамического текста это также требует внешнего сервиса (аналогично S₃).

### Достоинства
*   **(P4.1) Визуальная точность:** Гарантирует 100% соответствие виду шрифта.

### Недостатки
*   **(C4.1) Потеря функциональности текста:** ≔! (Текст в итоговом PDF нельзя выделить, скопировать или найти поиском. Это критический недостаток для бизнес-документов).
*   **(C4.2) Сложность для динамических данных:** Требует разработки внешнего сервиса (аналогично S₃) и усложняет верстку отчета.

### Оценка: 30/100

---

## S₅: Бизнес-компромисс (Alternative Font)

### Описание
Выбор максимально похожего шрифта из списка официально поддерживаемых в Business Central SaaS (например, Aptos, Segoe UI, Gill Sans Nova).

### Достоинства
*   **(P5.1) Простота и стабильность:** Гарантированная работа без каких-либо дополнительных затрат или обходных путей.
*   **(P5.2) Нулевая стоимость.**

### Недостатки
*   **(C5.1) Несоответствие требованию:** Не решает исходную задачу T⁎. Может нарушать требования корпоративного стиля клиента.

### Оценка: 50/100

---

# 2. Вердикт

Для решения задачи T⁎ рекомендуется действовать итеративно, переходя к следующему шагу при неудаче или неприемлемости предыдущего.

1.  **Приоритет 1: ▶ Попытка S₁ (Встраивание в Word Layout).**
    Это самый быстрый и бесплатный способ. Необходимо:
    *   Убедиться, что отчеты используют (или могут быть конвертированы в) макеты Word.
    *   Проверить права на встраивание (Font Embeddability) файла "Century Gothic".
    *   При сохранении макета в Word активировать "Embed fonts in the file" и **деактивировать** "Do not embed common system fonts".
    Вероятность успеха достаточно высока для стандартных документов.

2.  **Приоритет 2: ▶ Использование S₂ (ISV-решение).**
    Если S₁ не сработал, или если требуется использование сложных RDLC-отчетов, которые невозможно конвертировать в Word, следует использовать специализированное решение (например, **ForNAV**). Это гарантирует результат, но потребует финансовых вложений.

3.  **Приоритет 3: Рассмотрение S₅ или S₃.**
    Если S₂ отклонен по бюджетным соображениям, выбор стоит между:
    *   **S₅ (Компромисс):** Обсудить с клиентом возможность использования альтернативного поддерживаемого шрифта.
    *   **S₃ (Внешний рендеринг):** Если компромисс невозможен и у клиента есть ресурсы на сложную кастомную разработку.

S₄ (Текст как графика) не рекомендуется для бизнес-документов из-за потери функциональности текста.