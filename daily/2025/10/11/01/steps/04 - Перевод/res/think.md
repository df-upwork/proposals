## M-Q3ᚖ₁: Анализ системных журналов (System Log Analysis)

### Суть
Этот метод включает изучение журналов ядра Linux (`dmesg`, `/var/log/kern.log`) и системных журналов (`/var/log/syslog`, `journalctl`) для выявления критических событий на уровне операционной системы.
Основное внимание уделяется поиску сообщений от механизма OOM (Out-Of-Memory) Killer и ошибок запуска служб.

### Оценка
90

### Достоинства
Метод предоставляет прямые доказательства активации OOM Killer, что является частой причиной внезапной остановки MySQL или Apache (Cᛘ₂) (Source 3.1, 17.1).
Анализ позволяет точно определить, какой процесс был завершен и когда это произошло (Source 17.1).
Сбор системных журналов оказывает минимальное влияние на производительность сервера.
Временные метки в журналах помогают установить точную хронологию событий (Source 1.1).

### Недостатки
Системные журналы фиксируют механизм отказа (например, OOM), но не первопричину исчерпания памяти (например, всплеск трафика).
Критические сообщения могут быть потеряны из-за неправильной настройки ротации логов или переполнения буфера ядра.
Для анализа требуются доступ по SSH и навыки работы с командной строкой Linux.

## M-Q3ᚖ₂: Мониторинг базовых метрик инфраструктуры (Basic Infrastructure Metrics Monitoring)

### Суть
Этот метод использует встроенные инструменты мониторинга AWS Lightsail для анализа ключевых показателей производительности инстанса.
Основное внимание уделяется метрикам использования ЦП (CPU Utilization) и оставшейся квоте взрывной производительности ЦП (CPU Burst Capacity).

### Оценка
85

### Достоинства
Этот метод критически важен для диагностики Cᛘ₁, так как исчерпание CPU Burst Capacity приводит к дросселированию ЦП на инстансах Lightsail (Source 10.1).
Метрики предоставляют объективные данные для подтверждения гипотезы о снижении производительности из-за ограничений инфраструктуры AWS.
Инструменты встроены в платформу AWS и не требуют настройки на самом сервере.
Анализ исторических данных позволяет выявить паттерны использования ЦП и частоту исчерпания квоты.

### Недостатки
Стандартные метрики Lightsail не включают мониторинг использования оперативной памяти (RAM) и дискового пространства, что критично для диагностики Cᛘ₂ (Source 4.1).
Метрики показывают факт исчерпания ресурсов ЦП, но не указывают, какие именно процессы вызвали это исчерпание.
Низкая гранулярность стандартных метрик может скрывать короткие пики нагрузки.

## M-Q3ᚖ₃: Расширенный мониторинг ресурсов (Advanced Resource Monitoring)

### Суть
Этот метод направлен на получение детальных метрик, недоступных в стандартном мониторинге Lightsail, в первую очередь использования оперативной памяти (RAM) и файла подкачки (Swap).
Для этого требуется установка агента мониторинга, например AWS CloudWatch Agent, или использование внешних систем.

### Оценка
95

### Достоинства
Мониторинг использования RAM и Swap абсолютно необходим для диагностики условий, приводящих к активации OOM Killer (Cᛘ₂) (Source 3.1).
Метод также позволяет выявить падение производительности из-за интенсивного использования Swap (thrashing) (Source 11.1).
Метод заполняет критические пробелы в базовых метриках Lightsail, предоставляя полную картину состояния ресурсов сервера.
Исторические данные позволяют анализировать использование ресурсов, предшествующее простою, и выявлять тренды, такие как утечки памяти.

### Недостатки
Метод требует установки и настройки дополнительного программного обеспечения (агентов) на сервере.
Использование расширенных метрик CloudWatch или внешних сервисов может повлечь дополнительные расходы.
Агенты мониторинга потребляют некоторое количество ресурсов сервера.

## M-Q3ᚖ₄: Анализ журналов приложений (Application Log Analysis)

### Суть
Этот метод заключается в детальном изучении журналов веб-сервера (Apache `access.log` и `error.log`), базы данных (MySQL `error.log` и `slow_query_log`) и PHP.
Цель состоит в том, чтобы понять характер трафика, выявить ошибки приложений и определить неэффективные операции базы данных.

### Оценка
85

### Достоинства
Анализ `access.log` критически важен для выявления всплесков трафика, активности ботов или DDoS-атак (Cᛘ₄) (Source 5.1).
Он позволяет идентифицировать атаки на уязвимые точки WordPress (`xmlrpc.php`, `wp-login.php`), создающие чрезмерную нагрузку (Source 5.1).
Журналы медленных запросов MySQL напрямую указывают на неэффективные SQL-запросы, потребляющие избыточные ресурсы (Cᛘ₆) (Source 9.1, 16.1).
Журналы ошибок Apache и PHP фиксируют сбои выполнения скриптов, такие как достижение лимита памяти PHP или таймауты.

### Недостатки
Объем журналов доступа может быть очень большим, что затрудняет ручной анализ без специализированных инструментов агрегации.
Журналы приложений не предоставляют прямой информации об использовании системных ресурсов (CPU, RAM) на уровне инфраструктуры.
По умолчанию журналирование медленных запросов MySQL может быть отключено и требует настройки (Source 16.1).

## M-Q3ᚖ₅: Аудит конфигурации стека (Stack Configuration Audit)

### Суть
Этот метод включает аудит настроек Apache, MySQL и PHP на предмет их соответствия доступным ресурсам сервера (RAM и CPU).
В Apache анализируются параметры модуля MPM, такие как `MaxRequestWorkers` или `MaxClients` (Cᛘ₃).
В MySQL проверяются параметры, влияющие на потребление памяти, в первую очередь размер буферного пула (`innodb_buffer_pool_size`).

### Оценка
80

### Достоинства
Неоптимальная конфигурация часто является ключевым фактором нестабильности на серверах с ограниченными ресурсами (Source 14.1).
Правильная настройка Apache MPM может предотвратить создание избыточного количества процессов, ведущее к исчерпанию памяти (Cᛘ₂) (Source 6.1, 19.1).
Оптимизация конфигурации MySQL позволяет достичь баланса между производительностью базы данных и общим потреблением памяти системой (Source 7.1).
Корректировка конфигурации может повысить стабильность без необходимости масштабирования оборудования.

### Недостатки
Оптимальные настройки сильно зависят от характера нагрузки, который часто неизвестен на начальном этапе диагностики.
Метод требует экспертных знаний в области администрирования Apache и тюнинга производительности MySQL.
Внесение изменений в конфигурацию без понимания первопричины проблемы может усугубить ситуацию.

## M-Q3ᚖ₆: Профилирование приложений и базы данных (Application and Database Profiling)

### Суть
Этот метод заключается в использовании специализированных инструментов для анализа производительности WordPress на уровне кода и запросов к базе данных.
Используются плагины (например, Query Monitor) или внешние сервисы APM (Application Performance Monitoring) для выявления медленного PHP-кода и тяжелых SQL-запросов (Cᛘ₅, Cᛘ₆) (Source 8.1, 9.1).

### Оценка
75

### Достоинства
Профилирование позволяет точно определить конкретный плагин, тему или фрагмент кода, ответственный за высокое потребление ресурсов.
Метод позволяет выявить фундаментальные причины неэффективности приложения (Source 13.1).
Оптимизация кода и запросов обеспечивает долгосрочное решение проблемы производительности.

### Недостатки
Инструменты профилирования добавляют значительную нагрузку на сервер, что может усугубить проблемы со стабильностью во время анализа.
Внешние APM-решения могут быть сложными в настройке и дорогостоящими.
Профилирование не выявляет проблем на уровне инфраструктуры (Cᛘ₁) или внешних атак (Cᛘ₄).
Результаты профилирования требуют опыта разработки на WordPress для интерпретации и исправления.

## Вердикт
Поиск первопричины (RCA) повторяющихся простоев требует систематического и итеративного подхода (Source 1.1, 12.1).
Проблема (`P†`), скорее всего, вызвана исчерпанием ресурсов (Cᛘ₁ или Cᛘ₂), которое провоцируется нагрузкой и усугубляется другими факторами (Cᛘ₃-Cᛘ₆).
Диагностика должна следовать четкому процессу для эффективного выявления коренной причины (Source 2.1).

**Фаза 1: Обеспечение видимости и определение механизма отказа.**
Первым шагом необходимо развернуть Расширенный мониторинг ресурсов (M-Q3ᚖ₃) для сбора данных о RAM и Swap, так как они отсутствуют в Lightsail по умолчанию (Source 4.1).
Далее анализируются данные Расширенного (M-Q3ᚖ₃) и Базового мониторинга (M-Q3ᚖ₂), чтобы определить, происходит ли исчерпание CPU Burst Capacity (Cᛘ₁) или оперативной памяти.
Параллельно используется Анализ системных журналов (M-Q3ᚖ₁), чтобы найти подтверждение активации OOM Killer (Cᛘ₂) или других критических ошибок (Source 17.1).

**Фаза 2: Идентификация триггера нагрузки.**
После понимания механизма отказа необходимо определить, что вызывает исчерпание ресурсов.
Для этого используется Анализ журналов приложений (M-Q3ᚖ₄), который помогает определить характер нагрузки: легитимный трафик, фоновые задачи или атаки (Cᛘ₄), а также выявить медленные запросы (Cᛘ₆) (Source 5.1, 9.1).

**Фаза 3: Глубинный анализ и оптимизация.**
Следует провести Аудит конфигурации стека (M-Q3ᚖ₅), чтобы выявить настройки Apache и MySQL, способствующие чрезмерному потреблению ресурсов (Cᛘ₃) (Source 6.1).
Если базовая конфигурация корректна, но сервер не справляется с нагрузкой из-за неэффективности кода, следует применить Профилирование приложений и базы данных (M-Q3ᚖ₆).