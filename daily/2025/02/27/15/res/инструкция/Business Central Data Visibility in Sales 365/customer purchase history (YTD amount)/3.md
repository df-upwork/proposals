Ниже приведена пошаговая инструкция на русском языке (с использованием точных англоязычных терминов в соответствии с официальной документацией), описывающая, как сделать «customer purchase history (YTD amount)» из Business Central доступным в Dynamics 365 Sales, используя Power Automate и формат Excel (RapidStart Services при необходимости). Инструкция основана на решениях, принятых в предыдущих пунктах (1–35).  

1) Подготовить в Business Central поле или логику, содержащую YTD amount  
1.1) В Business Central идентифицировать таблицу, где хранится сумма покупок клиента за год (YTD amount). Обычно это таблица клиентов (customers) или похожая сущность, в которой отражены финансовые итоги за год.  
1.2) Убедиться, что каждое значение YTD amount корректно рассчитывается и обновляется в Business Central. Если в системе уже настроена логика расчета YTD, сохранить существующую конфигурацию. Если логика отсутствует, создать поле (или вычисляемое поле), в котором хранится YTD amount для каждого клиента.  

2) Создать или определить в Dynamics 365 Sales поле для хранения YTD amount  
2.1) Перейти в «Settings» → «Advanced Settings» → «Customizations» → «Customize the System».  
2.2) Найти сущность «Account» (или «Contact», в зависимости от структуры клиента) и добавить новое поле для хранения YTD amount. Например, поле с типом «Currency» или «Decimal Number», в зависимости от формата данных.  
2.3) Сохранить и опубликовать изменения (Publish All Customizations), чтобы поле стало доступно для записи и отображения в Dynamics 365 Sales.  

3) Настроить Power Automate для регулярного чтения данных из Business Central и записи в Dynamics 365 Sales  
3.1) Перейти в «Power Automate» (в разделе «Microsoft Power Platform»).  
3.2) Создать новый поток (Flow). Например, выбрать «Scheduled cloud flow», чтобы запускаться с заданной периодичностью (например, раз в день или раз в час).  
3.3) В качестве первого шага (Trigger) указать расписание (Schedule) и настроить желаемый интервал.  
3.4) Добавить действие (Action) «List records» из «Business Central connector».  
– В параметрах выбрать среду Business Central (Environment), компанию (Company) и таблицу или страницу (например, таблицу клиентов), где находится YTD amount.  
3.5) (Опционально) Использовать действия для фильтрации записей в Business Central (Filter Query), если необходимо обрабатывать не все клиенты, а только определенные группы.  
3.6) Добавить шаг для цикла (Loop), чтобы пройти по всем клиентам, возвращенным из Business Central.  
3.7) Внутри цикла добавить действие (Action) «Update a record» или «Upsert a record» в «Microsoft Dataverse connector» (Dataverse лежит в основе Dynamics 365 Sales).  
– Указать сущность «Account» (или другую, если YTD amount хранится в другой сущности).  
– Найти соответствие (matching) между записью Business Central (например, по полю Customer No. или другому уникальному идентификатору) и записью в Dynamics 365 Sales (например, сопоставить с полем Account Number).  
– Записать значение поля YTD amount из Business Central в поле YTD amount, созданное в пункте 2.  

4) Проверить корректность сопоставления и данных (маппинг полей)  
4.1) Если используется кастомное поле для идентификатора клиента (Customer No.), убедиться, что и в Business Central, и в Dynamics 365 Sales оно содержит согласованные значения. При отсутствии единого идентификатора настроить таблицу соответствия (Mapping Table) или дополнительную логику поиска записей.  
4.2) В Power Automate, в шаге «Update a record», проверить, чтобы значение YTD amount из Business Central корректно передавалось в нужное поле (созданное в пункте 2).  

5) Сохранить и протестировать поток Power Automate  
5.1) Сохранить настройку потока (Flow) в Power Automate и запустить тестовый запуск вручную (Test).  
5.2) Убедиться, что данные из Business Central были прочитаны, и для каждой записи клиента в Dynamics 365 Sales появилась актуальная сумма YTD amount.  
5.3) При необходимости открыть несколько записей в Dynamics 365 Sales (раздел «Sales» → «Accounts») и проверить, что новое поле YTD amount заполнено верно.  

6) При использовании RapidStart Services для экспорта в Excel (при желании)  
6.1) Если возникает потребность выгружать данные из Business Central в Excel-файл (через RapidStart Services), настроить «Configuration Package», включающий таблицы с полем YTD amount.  
6.2) Экспортировать конфигурационный пакет в Excel, при необходимости очищать или дополнять данные, а потом использовать Power Automate для чтения Excel-файла и обновления Dynamics 365 Sales. Данный вариант подходит для сценариев, когда прямой доступ к Business Central через Power Automate затруднен или требуется дополнительная подготовка данных в Excel.  

7) Настроить отображение YTD amount в интерфейсе Dynamics 365 Sales  
7.1) Перейти в «Settings» → «Advanced Settings» → «Customizations» → «Customize the System».  
7.2) Выбрать сущность «Account» и открыть «Forms».  
7.3) В нужной форме (Account Main Form) добавить созданное поле (YTD amount).  
7.4) Сохранить и опубликовать. Теперь пользователь Dynamics 365 Sales, открывая карточку клиента (Account), увидит текущее значение YTD amount.  

8) Организовать мониторинг и обновление (регулярная синхронизация)  
8.1) Убедиться, что расписание потока в Power Automate оптимально. Например, если данные о покупках меняются несколько раз в день, можно запускать поток каждые 2–3 часа. Если достаточно одного обновления в сутки, настроить поток на ночное время.  
8.2) Контролировать возможные сбои или ошибки в Power Automate, используя раздел «Monitor» → «Flow history» для анализа журнала выполнения.  
8.3) В случае массовых изменений в Business Central (например, при закрытии финансового периода) проверить, что у всех клиентов корректно обновилось поле YTD amount в Dynamics 365 Sales.  

9) Проверить согласованность и исключить «data clutter»  
9.1) Перед запуском регулярной синхронизации желательно очистить неактуальных клиентов в Business Central (если они не должны отображаться в Dynamics 365 Sales).  
9.2) Убедиться, что в поле YTD amount в Business Central содержатся только нужные для бизнеса данные (например, не включать особые транзакции, не относящиеся к реальным продажам текущего года).  
9.3) В Dynamics 365 Sales внедрить правила (Business Rules) для контроля корректности вводимой информации и избежать захламления системы ненужными записями.  

10) Документировать настройки для будущей поддержки и модификаций  
10.1) Зафиксировать, какой идентификатор используется для сопоставления клиентов между Business Central и Dynamics 365 Sales.  
10.2) Описать расположение и назначение поля YTD amount в Business Central и в Dynamics 365 Sales.  
10.3) Указать расположение и расписание работы потока в Power Automate.  
10.4) Добавить инструкцию для администраторов: как исправлять возможные ошибки, как изменять расписание, как добавлять новых клиентов или изменять логику расчета YTD amount.  

В результате клиентская история покупок (YTD amount) будет отображаться в Dynamics 365 Sales и регулярно обновляться, что обеспечит актуальную аналитику для менеджеров по продажам и позволит избежать лишних данных (data clutter), следуя принятой стратегии.