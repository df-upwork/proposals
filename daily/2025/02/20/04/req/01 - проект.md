## 1.
Клиент хочет выполнить следующий проект:
### 1.1. Title
Access 2003 ADP Migration Specialist Needed
### 1.2. Description
We are searching for an Access engineer to assist with a migration. We have a stable but aging Access 2003 ADP that is connected to an Azure Managed SQL DB.
The goal is to migrate the ADP from 2003 to 2010 and then MSFT 365. The ADP has 207 forms and 24 modules. It is linked to 205 tables and 163 queries. Through some preliminary testing, we know that the migration can work but will result in many "broken" forms. The project will be a many hour project to migrate and fix resulting errors related to form record sources, VBA reference, and VBA syntax.
The author of the original ADP is available to screen share and consult as needed and can collaborate on a set schedule based on time zones and preferences. Please reply and indicate your level of experience migrating ADPs, debugging Access VBA and forms, your time zone, and your preferred hourly rate.

### 1.3. Tags
Microsoft SQL Server
Microsoft Access
Microsoft Access Programming
VBA

## 2. Что такое «ADP»?
### 2.1.
Я тебя спросил:
~~~
Что клиент обозначает термином «ADP»?
Чем «Access ADP» отличается от обычного Microsoft Access?
~~~

### 2.2.
Ты ответил:
~~~
**ADP** расшифровывается как *Access Data Project* — это особый формат файла Microsoft Access (доступный начиная с Access 2000 и вплоть до Access 2010). Главная идея ADP-файла заключалась в том, что он напрямую (без традиционного «движка» Access Jet/ACE) подключается к базе данных Microsoft SQL Server. Таким образом, в ADP отсутствуют локальные таблицы в формате MDB или ACCDB: все данные фактически хранятся на SQL Server, а в Access-файле сосредоточена только логика (формы, отчёты, модули VBA и т. п.).

### Основные отличия «Access ADP» от обычного Access (.mdb или .accdb):
1. **Механизм хранения данных**  
   - В обычном Access (MDB/ACCDB) данные хранятся в самом файле базы данных Access (или в связанных таблицах, но с использованием файлового движка).  
   - В случае ADP данные расположены на SQL Server, а Access выступает лишь в роли «клиентского» приложения (похоже на «тонкий» слой интерфейса и кода).

2. **Запросы и обработка данных**  
   - В MDB/ACCDB запросы (Query) обычно обрабатываются механизмом Jet или ACE, встроенным в Access.  
   - В ADP запросы (View, Stored Procedure, Function и т. д.) выполняются сервером SQL, а Access их только отправляет на выполнение.  

3. **Особенности разработки**  
   - При работе с ADP формально не используешь «таблицы Access» — вся структура таблиц, индексов и связей управляется на стороне SQL Server.  
   - Формы и модули VBA могут сильно отличаться в реализации, поскольку часть привычных функций Access (например, Data Macros) или конструктор локальных запросов могут работать иначе в ADP.

4. **Поддержка и будущее**  
   - Microsoft прекратила развивать формат ADP, начиная с Access 2013 (файлы ADP больше не поддерживаются «из коробки»).  
   - Из-за этого многие организации, у которых остались старые решения в ADP, ищут пути миграции на «чистый» ACCDB с ODBC-подключениями к SQL Server или на другие технологии.

Таким образом, когда заказчик говорит про «Access 2003 ADP», он имеет в виду приложение, созданное в Access 2003 в формате .adp, которое напрямую подключается к SQL Server (в данном случае — к базе данных на Azure), и теперь им нужно перенести логику (формы, модули, запросы и т.д.) в более новую версию Access (2010, а затем 365), где формат ADP официально не поддерживается. Это сопряжено с целым рядом сложностей и «сломанных» форм/запросов, потому что придётся адаптировать код и структуру под новый механизм подключения (ODBC/Linked Tables и т. д.) и учесть отличия в VBA и объектах Access между версиями.
~~~


## 3. Что такое «migrate the ADP from 2003 to 2010»?
### 3.1.
Я тебя спросил:
~~~
Что клиент имеет в виду под «migrate the ADP from 2003 to 2010»?
~~~

### 3.2.
Ты ответил:
~~~
Под «migrate the ADP from 2003 to 2010» клиент подразумевает перевод (конвертацию) старого Access-приложения в формате ADP, созданного в Access 2003, на формат, совместимый с Access 2010. 

Почему именно «2003 → 2010»? 
- **Access 2010** — последняя версия, которая хоть как-то поддерживает формат ADP.  
- В **Access 2013 и более поздних** формат ADP официально не поддерживается, поэтому прежде чем перейти к более новым версиям (например, Access из Microsoft 365), нужно «промежуточное» обновление приложения в среде Access 2010. 

С технической точки зрения «миграция» включает: 
1. **Открытие/Конвертацию файла**: ADP-файлы, созданные в Access 2003, должны быть обновлены до версии, которую может прочитать Access 2010 (учитывая возможные отличия в структуре проекта и VBA-коде).  
2. **Исправление несовместимостей**: после конвертации часто появляются «сломанные» ссылки, отсутствие нужных библиотек VBA, проблемы с макросами или устаревшие функции, которые нужно адаптировать.  
3. **Проверку и тестирование**: для каждой формы, отчёта и модуля VBA нужно проверить, всё ли корректно работает в Access 2010.  

Таким образом, «migrate the ADP from 2003 to 2010» — это шаг, без которого нельзя перейти к дальнейшему переносу в более новую среду (Access 365), ведь напрямую из Access 2003 ADP-файл невозможно просто «открыть» в современных версиях Access.
~~~

## 4. Пошаговая инструкция по выполнению задачи пункта 3
### 4.1.
Я тебя спросил:
~~~
Напиши инструкцию по выполнению задачи пункта 3
~~~

### 4.2.
Ты ответил:
~~~
Ниже приведена примерная пошаговая инструкция по переносу Access Data Project (ADP) из Microsoft Access 2003 в Microsoft Access 2010. Все названия программ, вкладок и элементов интерфейса приведены на английском языке в соответствии с официальной документацией, а интерфейсные элементы заключены в угловые кавычки.

1. Подготовка и резервное копирование

1.1) Создать резервную копию исходного файла `*.adp` (созданного в Microsoft Access 2003).  
1.2) Убедиться, что установлена корректная версия Microsoft Access 2010 (32-бит или 64-бит), соответствующая системным требованиям и совместимости с библиотеками Visual Basic for Applications (VBA).  
1.3) Проверить доступ к текущей базе данных Microsoft SQL Server или Azure Managed SQL Database, к которой подключён исходный Access Data Project.

2. Открытие и автоматическая конвертация ADP в Microsoft Access 2010

2.1) Запустить Microsoft Access 2010.  
2.2) В главном меню открыть «File» → «Open» и выбрать исходный файл `*.adp` (формата Microsoft Access 2003).  
2.3) При появлении диалогового окна о необходимости обновления файла ADP согласиться на процесс. В большинстве случаев Microsoft Access 2010 автоматически конвертирует структуру проекта под более новую версию без изменения расширения файла.

3. Проверка и настройка VBA-кода

3.1) Открыть «Visual Basic Editor» (через «Database Tools» → «Visual Basic» или нажатием клавиши Alt+F11).  
3.2) В окне «Visual Basic Editor» перейти в «Tools» → «References» и убедиться, что все необходимые библиотеки (например, Microsoft ActiveX Data Objects (ADO), Microsoft DAO) отмечены галочками и корректно доступны.  
3.3) При необходимости установить недостающие ссылки или отключить неиспользуемые, которые могут быть помечены как MISSING.  
3.4) В «Visual Basic Editor» запустить «Debug» → «Compile» (или использовать «Compile» в меню «Debug»), чтобы проверить наличие синтаксических ошибок или проблем с библиотеками.  
3.5) Если в процессе компиляции появляются ошибки, отредактировать код, заменив или исправив устаревшие функции, методы и объекты, которые могли измениться с версии Microsoft Access 2003 на Microsoft Access 2010.

4. Адаптация форм и отчетов

4.1) Перейти в Microsoft Access 2010 и открыть вкладку «Database Tools» (или «Objects», в зависимости от настроек интерфейса) для просмотра всех форм и отчетов.  
4.2) Открыть каждую форму и проверить свойства источников данных (Record Source, Control Source) на совместимость с Microsoft Access 2010.  
4.3) При необходимости изменить ссылки на объекты SQL Server. Например, вместо устаревших способов прямого доступа использовать действующие объекты (Views, Stored Procedures) или настроить связи через ODBC.  
4.4) Проверить макросы (если в проекте используются AutoExec или другие встроенные макросы) на предмет совместимости с Microsoft Access 2010.

5. Проверка соединения с Microsoft SQL Server или Azure Managed SQL Database

5.1) Убедиться, что используемый логин (учётная запись) и права доступа к базе данных Microsoft SQL Server или Azure Managed SQL Database актуальны.  
5.2) Проверить и протестировать запросы, хранимые процедуры и функции, вызываемые из ADP. Убедиться, что они корректно выполняются и возвращают ожидаемые результаты.

6. Финальная компиляция и тестирование

6.1) Снова запустить «Debug» → «Compile» в «Visual Basic Editor». При отсутствии ошибок сохранить проект.  
6.2) Выполнить серию тестов всех ключевых функций: открыть основные формы, выполнить действия (добавление, редактирование, удаление данных), проверить связь с базой данных, запустить отчёты и т.д.  
6.3) При наличии ошибок внести необходимые изменения в VBA-код, источники данных форм и отчётов, затем повторить компиляцию и проверку.

7. Создание итогового файла и подготовка к дальнейшей миграции

7.1) При желании сохранить конвертированный файл ADP под новым именем. Например, `Project_2010.adp`.  
7.2) Зафиксировать список исправлений, внесённых в код и объекты базы данных. Это облегчит будущий переход на Microsoft Access (Microsoft 365) или полную конвертацию в формат `*.accdb` с использованием ODBC-связей к Microsoft SQL Server.  

После выполнения указанных шагов можно переходить к дальнейшему этапу — адаптации проекта в среде Microsoft Access (Microsoft 365), которая не поддерживает формат ADP напрямую. Для этого часто требуется конвертация в формат `*.accdb` и настройка связанных таблиц (Linked Tables), либо перенос объектов в другие приложения.
~~~



## 5. «will result in many "broken" forms»
### 5.1.
Я тебя спросил:
~~~
В пункте 1.2 клиент пишет:
```
Through some preliminary testing, we know that the migration can work but will result in many "broken" forms
```
По каким причинам выполнение задачи пункта 3 может приводить к «many "broken" forms»?
~~~

### 5.2.
Ты ответил:
~~~
Ниже перечислены основные причины, по которым при миграции ADP из Access 2003 в Access 2010 (а затем в более современные версии) может возникать большое количество «сломанных» (broken) форм:

1. **Изменения в объектной модели Access**  
   - Некоторые свойства форм и элементов управления, поддерживаемые в Access 2003, могут быть переименованы или удалены в Access 2010.  
   - Методы и события, на которые полагались формы в VBA-коде, могут работать иначе или потребовать новой синтаксической конструкции.

2. **Проблемы со ссылками (References) в VBA**  
   - После открытия проекта в новой версии Access могут «потеряться» некоторые библиотеки (например, ADO, DAO, ActiveX Controls и т. д.).  
   - Если конкретная библиотека в системе отсутствует (или доступна в несовместимой версии), все объекты, методы или константы из неё перестанут работать и вызовут ошибки компиляции в VBA.

3. **Изменения в способе подключения к SQL Server**  
   - Формы в ADP могут быть настроены напрямую на объекты SQL Server (таблицы, представления, хранимые процедуры) и использовать особенности ADP (например, прямое редактирование серверных объектов).  
   - При переходе на Access 2010 часть объектов требуется перенастроить (Record Source, привязки, параметры форм). Если этого не сделать, формы «не видят» таблиц или возвращают ошибки при попытке отображать данные.

4. **Отличия в синтаксисе SQL-запросов и функций**  
   - Некоторые формы используют встроенные (или динамически формируемые) SQL-запросы, которые могли работать в Access 2003, но в 2010 могут выдавать ошибки (из-за различий в T-SQL, функций VBA vs. SQL и т. п.).  
   - Если в формах заданы источники данных как «Access SQL»-запросы (QueryDefs) или существуют связанные инструкции DDL/SQL, придётся адаптировать их к новому движку.

5. **Использование устаревших ActiveX-элементов управления**  
   - Если в проекте применялись некоторые ActiveX-компоненты (календарь, специальные диалоговые элементы, контролы от сторонних поставщиков), то в новой среде они могут не регистрироваться или быть недоступны.  
   - В результате элементы управления пропадают или заменяются на «#Name?» / «Нет элемента управления» в режиме конструктора.

6. **Различия в безопасности макросов и VBA (Security Settings)**  
   - Access 2010 по умолчанию более строго относится к макросам и кодам VBA (Macro Security). Если настройки безопасности не совпадают, при открытии форм, использующих макросы, могут возникать ошибки или блокироваться выполнение кода.  
   - Может потребоваться прописать «доверенные расположения» (Trusted Locations) или изменить уровень безопасности VBA.

7. **Переход с 32-бит на 64-бит (или наоборот)**  
   - Если в исходном проекте использовались API-вызовы Windows (Declare Function), они могли быть закодированы для 32-битной среды (например, `LongPtr` vs. `Long`). В Access 2010 64-бит (или в более поздних версиях 64-бит Microsoft 365) это может вызывать сбои и «падения» форм.  
   - Требуется корректировать сигнатуры Declare Function и типы данных, соответствующие 64-битной версии VBA.

Все перечисленные факторы в совокупности приводят к тому, что многие формы, особенно сложные (связанные с серверными объектами и VBA-кодом), «ломаются» после конверсии и требуют ручного исправления свойств, ссылок и кода. Именно поэтому заказчик и упомянул о «many broken forms» в процессе миграции.
~~~

## 6. «Некоторые свойства форм и элементов управления, поддерживаемые в Access 2003, могут быть переименованы или удалены в Access 2010»
### 6.1.
Я тебя спросил:
~~~
В пункте 5.2 ты писал:
```
Некоторые свойства форм и элементов управления, поддерживаемые в Access 2003, могут быть переименованы или удалены в Access 2010
```
Учёл ли ты это обстоятельство в своей пошаговой инструкции пункта 4.2?
~~~

### 6.2.
Ты ответил:
~~~
Короткий ответ:  
**В базовой инструкции из пункта 4.2 это учтено лишь частично и «между строк»:** там есть общий призыв открыть каждую форму, проверить свойства (Record Source, Control Source и т.д.) и при необходимости адаптировать. Однако **прямого упоминания** о том, что часть свойств могла **изменить название** или быть **удалена** в новой версии Access, нет.  

Чтобы явно учесть возможные изменения и переименования свойств при миграции, инструкцию обычно дополняют отдельным шагом (или уточнением в пункте «Адаптация форм и отчетов»), где прямо указывают на необходимость проверить и обновить **все** унаследованные свойства, события и методы форм/отчетов, которые могли выйти из употребления или сменить название с Access 2003 на Access 2010.  

Ниже — пример того, как можно детализировать **шаг 4** инструкции, чтобы явно учесть «удалённые или переименованные» свойства форм:

---

### 4. Адаптация форм и отчетов

1. **Открытие и проверка формы**  
   - Перейдите в Microsoft Access 2010 на вкладку «Navigation Pane» и поочерёдно открывайте каждую форму в режиме конструктора (Design View).  
   - Убедитесь, что сама форма открывается без критических ошибок. Если появляются сообщения о пропавших полях или методах (наподобие «Unknown Property» или «Method not found»), зафиксируйте их.

2. **Проверка источников данных (Record Source, Control Source)**  
   - В свойствах формы (Property Sheet → Data) проверьте «Record Source» — если он ссылается на хранимую процедуру (Stored Procedure) или объект SQL Server, который не подключился корректно, вам может потребоваться переключиться на ODBC или переопределить источник данных.  
   - Аналогичным образом просмотрите все элементы управления (Controls) формы и проверьте «Control Source» — ссылки на поля, функции или выражения, которые могли перестать работать в новой версии.

3. **Выявление и исправление устаревших или переименованных свойств**  
   - В режиме конструктора формы откройте «Property Sheet» (F4) и внимательно изучите вкладки «Format», «Data», «Event» и «Other».  
   - Сравните названия или назначение свойств с тем, что было в Access 2003:  
     - Если свойство недоступно (уже отсутствует в списке) или помечено как «#Error», значит оно было **удалено** или **переименовано** в новой версии. Ищите в официальной документации или справке Access 2010, есть ли новое свойство с аналогичной функциональностью.  
     - При переименовании старых свойств в новые (или при удалении), зачастую нужно переписать часть VBA-кода, который вызывает/чтёт эти свойства.

4. **Проверка событий и макросов**  
   - На вкладке «Event» проверьте, корректно ли отображаются события (On Open, On Load, On Click и т.п.). Убедитесь, что в «Event Procedure» (VBA) нет ошибок типа «Ambiguous Name» или «Procedure Not Found».  
   - Если в Access 2003 использовались макросы на события (Embedded Macro), просмотрите их логику и проверьте, не обращаются ли они к свойствам, которые теперь не поддерживаются.

5. **Использование «Find and Replace» и отладка кода**  
   - Откройте «Visual Basic Editor» (Alt+F11), выполните «Debug» → «Compile». Отслеживайте строчки VBA, где Access выдаёт ошибку о неизвестном свойстве или методе (пример: «Method or data member not found»).  
   - Возможно, потребуется глобальный «Find and Replace» (Ctrl+F) по имени устаревшего свойства или метода, чтобы заменить его новым аналогом или убрать вовсе.

6. **Тестирование**  
   - Сохраните изменения, закройте и повторно откройте форму. Убедитесь, что все элементы управления корректно отображаются и взаимодействуют с данными.  
   - При необходимости повторяйте процесс для каждой формы и отчёта, пока не устраните все проблемы, связанные с переименованными/удалёнными свойствами.

---

Таким образом, **в исходных шагах инструкции** пункт «4.2. Открыть каждую форму и проверить свойства источников данных» **формально охватывает** ситуацию с поломанными или устаревшими свойствами, но **не акцентирует** на конкретном риске переименования или удаления некоторых свойств в Access 2010. Чтобы избежать недопонимания, принято **явно прописывать** этот момент в руководстве по миграции, как в примере выше.
~~~

## 7. «Методы и события, на которые полагались формы в VBA-коде, могут работать иначе или потребовать новой синтаксической конструкции.»
### 7.1.
Я тебя спросил:
~~~
В пункте 5.2 ты писал:
```
Методы и события, на которые полагались формы в VBA-коде, могут работать иначе или потребовать новой синтаксической конструкции.
```
Учёл ли ты это обстоятельство в своей пошаговой инструкции пункта 4.2?
~~~

### 7.2.
Ты ответил:
~~~
Короткий ответ:  
**В базовой версии пошаговой инструкции (см. пункт 4.2) этот момент учтён лишь частично** — через общее упоминание о необходимости проверять и адаптировать VBA-код, события, макросы и т. п. Однако там **не дано детальных указаний**, которые подчеркнули бы, что некоторые методы/события действительно **изменили поведение** или **перестали существовать** в новой версии Access и требуют прямого исправления в VBA-коде.

Ниже — пример, **как можно дополнить инструкцию** (особенно её четвёртый раздел, связанный с формами и отчётами), чтобы явно учесть риск несовместимости методов/событий при миграции с Access 2003 на Access 2010.

---

### Дополненная инструкция: учёт изменений методов и событий в VBA

#### 4. Адаптация форм и отчётов

1. **Открытие формы и первичная проверка**  
   - В Microsoft Access 2010 откройте каждую форму в **Design View** (режиме конструктора).  
   - Убедитесь, что форма вообще **открывается**: если Access выводит сообщения об ошибках в связанных событиях, запишите их.

2. **Проверка событий (Event) формы**  
   - Откройте **Property Sheet** (клавиша F4) для формы, перейдите на вкладку **Event**.  
   - Убедитесь, что все события, используемые в Access 2003 (например, *On Open*, *On Load*, *On Current*, *On Click* и т. д.), по-прежнему **присутствуют** в Access 2010 и **правильно связаны** с VBA-процедурами или макросами.  
   - Если в Access 2010 это событие названо иначе (или было заменено на другое), обновите соответствующее поле.  

3. **Проверка VBA-кода, связанного с событиями**  
   - Нажмите кнопку «…» (Build) рядом с нужным событием, чтобы перейти в **VBA-обработчик** (Event Procedure) или макрос.  
   - В **Visual Basic Editor** просмотрите процедуру:  
     - Убедитесь, что **имена** процедур совпадают с реальными событиями, поддерживаемыми Access 2010. Иногда при миграции может получиться «утраченное» событие или «Procedure not found».  
     - Убедитесь, что код внутри процедуры не ссылается на **устаревшие методы** или **свойства**, которые могли быть удалены или переименованы в новой версии (пример: `Me.OldMethodName` → `Me.NewMethodName`).  

4. **Учёт возможных изменений в сигнатуре событий**  
   - Некоторые события могли сохранить название, но при этом **изменить сигнатуру** (то есть **параметры**). Например, были случаи, когда в более новой версии Access изменялся тип данных одного из параметров.  
   - Если ваш код явно использует параметры события (например, `ByVal Cancel As Integer, ByVal Action As Integer`), сравните их со справкой по Access 2010 и при необходимости скорректируйте.

5. **Обнаружение и исправление устаревших ActiveX-обработчиков**  
   - Если в форме использовались события каких-либо **ActiveX- или COM-компонентов**, убедитесь, что они доступны в Access 2010 и что их события имеют ту же сигнатуру.  
   - Если компонент не поддерживается (нет библиотеки или контрола), придётся либо найти замену, либо переписать часть логики, вызывающей его события.

6. **Компиляция и тест**  
   - Вернитесь в **Visual Basic Editor** (Alt+F11), выполните «Debug» → «Compile» и посмотрите, есть ли ошибки вроде «Method or data member not found» или «Argument not optional».  
   - Если ошибки есть — исправьте код, заменив или убрав несовместимые методы и события. Повторяйте компиляцию, пока все ошибки не будут устранены.  
   - Вернитесь в Access, откройте форму в обычном режиме (Form View) и **проверьте функционал**: срабатывают ли события так, как задумывалось в Access 2003, или что-то нужно дорабатывать.

7. **Детальный учёт изменений**  
   - В отдельном документе (или в комментариях к коду) фиксируйте все изменения, связанные с устаревшими/изменившимися методами и событиями. Это позволит быстрее разобраться с аналогичными проблемами в других формах.  

8. **Повторение для каждой формы/отчёта**  
   - Проделайте тот же набор шагов (1–7) для каждой формы и каждого отчёта (в случае если отчёты тоже содержат VBA-код и события).  

---

Таким образом, данная **расширенная версия** шага 4 явно учитывает то, что:  
1. Часть событий и методов в VBA могла **поменять сигнатуру** или **перестать существовать**.  
2. Нужно **проявить особое внимание** к вызовам событий и методов в процессе компиляции и тестирования.  
3. Должен быть предусмотрен специальный этап, на котором мы целенаправленно **отслеживаем** и **исправляем** сломанные вызовы, а не только общие проблемы привязки к источнику данных.  

В оригинальной инструкции (п. 4.2) это было описано скорее **«общими словами»** через проверку и тестирование форм и VBA. Для реальных крупных проектов, в которых «сломаться» могут сотни форм, такой дополнительный уровень детализации критически важен, чтобы **ничего не упустить** при миграции.
~~~


## 8. Какие конкретно свойства форм и элементов управления, поддерживаемые в Access 2003, были переименованы в Access 2010?
### 8.1.
Я тебя спросил:
~~~
В пункте 5.2 ты писал:
```
Некоторые свойства форм и элементов управления, поддерживаемые в Access 2003, могут быть переименованы или удалены в Access 2010
```
Какие конкретно свойства форм и элементов управления, поддерживаемые в Access 2003, были переименованы в Access 2010?
~~~

### 8.2.
Ты ответил:
~~~
**Короткий ответ:**  
В официальной документации Microsoft **нет** отдельного и чёткого списка свойств форм/элементов управления, которые **буквально** были «переименованы» при переходе с Access 2003 на Access 2010. На практике Microsoft старалась сохранить обратную совместимость, поэтому большинство старых свойств формально продолжало существовать и в Access 2007/2010 (хотя часть могла быть фактически **устаревшей**, «deprecated» или работала в режиме совместимости).  

Гораздо чаще встречалась ситуация, когда некоторые свойства или настройки **убирали** (полностью удаляли) или **заменяли** новой функциональностью (к примеру, классические меню и панели инструментов → ленты (Ribbons)). При этом названия старых свойств иногда оставались, но работали ограниченно или вообще игнорировались.

Ниже — перечень изменений, которые часто принимают за «переименование», но по сути являются либо **полным удалением**, либо **заменой** на новую функциональность (часто со схожим, но не идентичным названием).

---

## 1. Свойства, связанные с меню и панелями инструментов

### 1.1. `MenuBar` и `Toolbar` → `RibbonName`
- **В Access 2003** у формы были свойства `MenuBar` и `Toolbar`, позволяющие указать пользовательскую меню- или панель инструментов.  
- **В Access 2007/2010** классические меню были заменены лентами (Ribbon). Появилось свойство `RibbonName`, в котором указывается наименование пользовательской ленты.  

Формально `MenuBar`/`Toolbar` в Access 2010 **могут** ещё присутствовать для совместимости (в старых базах), но их использование перестало работать «как раньше» (или вызывало хаотичное поведение). Правильно использовать именно `RibbonName`.  

> Часто говорят «свойства `MenuBar` и `Toolbar` **переименовали** в `RibbonName`», но технически старые свойства не переименовывались, а оказались «устаревшими». 

---

## 2. Свойства, связанные с режимами PivotTable/PivotChart

При переходе с Access 2003 на Access 2007/2010 **часть возможностей** (PivotTable, PivotChart) была ещё доступна, но уже считалась устаревшей (deprecated), а в Access 2013 её полностью убрали.

- **Свойства** типа `AllowPivotTableView`, `AllowPivotChartView` и т. п. в Access 2010 чаще всего всё ещё видны, но в более поздних версиях (Access 2013 и выше) они работать перестали.  
- **Методы** или объекты, управлявшие Pivot-режимами, в Access 2010 уже «доживали» последние дни и не развивались.

Здесь «переименования» не произошло: какие-то пункты просто **убрали**, а какие-то продолжали висеть в Property Sheet, но без реальной пользы при проектировании в современных версиях.

---

## 3. Устаревшие свойства, связанные с Data Access Pages (DAP)

**Data Access Pages** (страницы доступа к данным) были представлены в Access 2000/2002/2003, но в Access 2007/2010 объявлены устаревшими, а затем удалены. Свойства и события, связанные с DAP, больше **не поддерживаются**.

Если в VBA-коде или в свойствах форм оставались отсылки к DAP (например, к объектам `AccessObjectType.acDataAccessPage`), это вызывало ошибки в более новых версиях. При этом эти свойства/константы не «переименовывались», а **убирались**.  

---

## 4. Изменения в диалоговых (Popup) и MDI/SDI-режимах

C Access 2007 появились **вкладки документов** (Tabbed Documents) вместо классического MDI-режима «многооконности». Это косвенно повлияло на поведение свойств форм, связанных с отображением окон:

- Свойство `PopUp` по-прежнему существует, но **ведёт себя иначе** в режиме вкладок, чем в старом MDI-окне.  
- Старые настройки вроде `UseMDIMode` (если кто-то их использовал через DAO/ACEDAO) больше не применяются.

Здесь также нет прямого «переименования», но логика поведения сильно изменилась.

---

## 5. ActiveX- и COM-контролы: исчезнувшие (или сломанные) свойства

Если в Access 2003 использовался какой-нибудь ActiveX-контрол (например, старый Microsoft Calendar Control, Date and Time Picker и т.п.), у него могли быть уникальные свойства, которые:
1. **В Access 2010 отсутствуют** вообще (если сам контрол не установлен/не поддерживается).  
2. Могут называться иначе при установке новой версии контрола (хотя это уже не часть «голого» Access, а сторонний/отдельный компонент).

Такое вполне воспринимают как «переименования» или «пропажу свойств», но в реальности это зависело от конкретного COM/OCX-компонента, а не от Access как такового.

---

## 6. «Переименование» некоторых устаревших методов/объектов VBA

В рамках VBA кода (особенно при работе с ADP) могли быть вызовы методов/объектов, относящихся к **старым библиотекам** (например, ADO vs. DAO). В Access 2010 кое-где изменилась организация объектов и ссылки на библиотеки. Встречалось, что:

- Старые объекты ADO (например, `ADODB.Connection`), если у разработчика стояли более ранние версии ADO-библиотек (MDAC 2.8 и т. п.), могли «переехать» в другую версию (например, Office 2010 ADO).  
- Из-за этого иногда менялись названия констант, перечислений или сигнатур методов (хотя это больше вопрос ссылок/References, чем свойств форм).

Это тоже воспринимают как «что-то переименовано», но формально это не свойство формы — это библиотека ADO/DAO.

---

## Итого

1. **Прямых «массовых» переименований свойств форм** (в духе «PropertyX» в Access 2003 стало «PropertyY» в Access 2010) **не зафиксировано** в документации.  
2. Чаще всего речь шла о **замене** (MenuBar/Toolbar → RibbonName) или **полном удалении** (DAP, PivotTable, устаревшие ActiveX) функционала, из-за чего соответствующие свойства могли пропадать, «не работать» или числиться в режиме совместимости.  
3. Если вы видите в Access 2010 сообщение об «Unknown Property» или «Method not found» при открытии старой формы, скорее всего это:  
   - Удалённая функциональность (Data Access Pages, Pivot)  
   - Устаревший метод/константа в VBA  
   - Собственный ActiveX-контрол, который не зарегистрирован на новой машине  
   - Свойство, связанное с классическими меню (`MenuBar`, `Toolbar`), где в Access 2010 нужно использовать `RibbonName`.  

**Практическая рекомендация:**  
- Если у вас после миграции из Access 2003 вдруг «пропало» (или «сломалось») свойство формы, сначала проверьте, не относится ли оно к старой системе меню/панелей инструментов, PivotTable/PivotChart, Data Access Pages или ActiveX-контролам.  
- Для адаптации под Access 2010 (и тем более под Access 365) придётся **либо** убрать это свойство, **либо** перевести на новую механику (например, задать `RibbonName` вместо `MenuBar`).  

Таким образом, говорить о том, что «в Access 2010 множество свойств форм было переименовано», было бы преувеличением. Чаще всего это либо устаревшие/удалённые свойства и объекты, либо замена функциональности меню/панелей инструментов на систему лент.
~~~


## 9. Какие конкретно свойства форм и элементов управления, поддерживаемые в Access 2003, были удалены в Access 2010?
### 9.1.
Я тебя спросил:
~~~
В пункте 5.2 ты писал:
```
Некоторые свойства форм и элементов управления, поддерживаемые в Access 2003, могут быть переименованы или удалены в Access 2010
```
Какие конкретно свойства форм и элементов управления, поддерживаемые в Access 2003, были удалены в Access 2010?
~~~

### 9.2.
Ты ответил:
~~~
Ниже приведён максимально конкретный разбор того, что происходило со свойствами форм и элементов управления при переходе от Access 2003 к Access 2007/2010. Сразу оговоримся, что **Microsoft не публиковала „официальный и исчерпывающий список“ именно удалённых свойств**. Чаще всего речь шла либо об их полном исчезновении (без прямого «переименования»), либо о том, что свойство оставалось в режиме совместимости, но фактически не работало в новых форматах (ACCDB).

Поэтому когда говорят, что в Access 2010 «удалили» те или иные свойства, обычно имеют в виду один из двух сценариев:

1. **Свойство пропало из Property Sheet (или из VBA-модели) вообще** и при обращении к нему в VBA возникает ошибка «Method or data member not found».  
2. **Свойство формально существует, но в новой версии не отображается в дизайне и не работает (устаревшее, “deprecated”)** — в итоге разработчику приходится его убирать или искать аналог (например, для лент Ribbon вместо старых меню/панелей инструментов).

Ниже перечислены несколько групп свойств, которые либо исчезли, либо стали работать «в лучшем случае частично» в Access 2007/2010.

---

## 1. Свойства, связанные с Data Access Pages (DAP)

**Data Access Pages** были представлены ещё в Access 2000/2002/2003. Они позволяли создавать HTML-страницы, привязанные к данным Access/SQL Server. В Access 2007 их объявили устаревшей функциональностью (deprecated), а в Access 2010 **полностью исключили** создание/редактирование DAP:

- Все свойства, которые были нужны для настройки Data Access Pages (например, `HasModule` у DAP, `CurrentView` и прочие специальные методы/константы для страниц), **пропали из интерфейса** и перестали работать в режиме ACCDB.  
- Если вы откроете старую базу (формата .mdb) с DAP и соответствующими свойствами в Access 2010, то при попытке обратиться к ним в VBA получите ошибку (либо эти объекты вообще не будут отображаться в Navigation Pane).

Хотя DAP — это скорее отдельные объекты в базе, чем «свойства форм», на практике в VBA‑коде иногда встречались вызовы или проверки, связанные с DAP (например, перебор всех `CurrentProject.AllDataAccessPages`). В Access 2010 это возвращает пустой набор или генерирует ошибку.

---

## 2. Свойства, связанные с классическими меню/панелями инструментов

В Access 2003 существовали свойства формы:

- **`MenuBar`**  
- **`Toolbar`**  
- **`ShortcutMenuBar`**  

которые позволяли указывать *пользовательскую* строку меню, *пользовательскую* панель инструментов или *пользовательское* контекстное меню для конкретной формы.

Начиная с Access 2007/2010, интерфейс перешёл на систему лент (Ribbon). Вот что случилось со старыми свойствами:

1. **`MenuBar` и `Toolbar`**  
   - В формате **MDB** (открытом в режиме совместимости) они могут ещё отображаться в Property Sheet, но уже не дают прежнего эффекта, так как вместо них действует лента.  
   - В новом формате **ACCDB** (особенно если создать базу «с нуля» в Access 2010) эти свойства либо не показываются в списке свойств формы вообще, либо показываются, но *ничего не делают*.  
   - На смену им пришло свойство **`RibbonName`**, куда можно вписать имя пользовательской ленты.

2. **`ShortcutMenuBar`**  
   - Формально оно может ещё присутствовать, но в Access 2010 часто отмечают проблемы, если пытаться использовать старые пользовательские контекстные меню.  
   - Иногда «неожиданно» работает, иногда — нет: зависит от настроек и режима совместимости.  
   - В некоторых справочных материалах указывалось, что `ShortcutMenuBar` фактически устарело вместе со старыми панелями инструментов, но в VBA‑модели оно ещё есть.  

Таким образом, в части «удалённых» свойств (особенно в ACCDB) можно считать, что **`MenuBar`/`Toolbar`** *как реальные рабочие свойства* **фактически исчезли** и были заменены на `RibbonName`. При этом в некоторых случаях они всё ещё видны для совместимости, но не приносят пользы.

---

## 3. Свойства, связанные с PivotTable/PivotChart

В Access 2003 (и в 2007) существовал функционал **PivotTable** и **PivotChart** *прямо внутри* форм/отчётов. Начиная с Access 2010, Microsoft анонсировала устаревание (deprecated) этого функционала, а в Access 2013 полностью его убрала.

- **`AllowPivotTableView`**  
- **`AllowPivotChartView`**  

В **Access 2010** они ещё могут отображаться (при определённых настройках совместимости), но фактически являются «зомби»-свойствами: новыми средствами Pivot там уже толком никто не пользуется, а в Access 2013 они и вовсе недоступны.

Если же вы откроете в Access 2010 базу **в формате ACCDB**, созданную с нуля, этих свойств зачастую в Property Sheet не будет. В старых базах (MDB) при конверсии в 2010 вы их иногда увидите, но реальная работа с ними будет ограниченной. А в ADP (Access Data Project) Pivot-режим тоже считался «проблемным» и постепенно выпиливался.

---

## 4. Устаревшие ActiveX-контролы и их свойства

Часто в Access 2003 применяли встроенные или сторонние **ActiveX-контролы** (например, `Calendar Control 11.0`, `MonthView Control`, `Date and Time Picker`). При переходе на Access 2010 эти элементы:

1. Либо **вообще не устанавливались** вместе с Office 2010 (и их нужно было отдельно инсталлировать и регистрировать).  
2. Могли иметь **другую версию** (например, `Calendar Control 12.0` или 14.0), у которой часть свойств называлась иначе.  
3. Могли **пропасть** вместе со своими свойствами, если Microsoft исключила их из поставки.

Поэтому, если в форме были свойства, специфичные для конкретного ActiveX (например, `ControlName.MaxDate` или `ControlName.DayFontColor` — выдуманный пример), и этот контрол в Access 2010 не поддерживается, то при загрузке формы свойства считаются «неизвестными» и мы получаем «broken form».

---

## 5. Свойства, относящиеся к Data Access Project (ADP) и SQL-Object Bindings

В ADP (особенно в Access 2003) существовали нюансы привязки формы к серверным объектам SQL (например, `InputParameters` для хранимых процедур, `ServerFilterByForm` и т. п.). В Access 2010 формат ADP ещё поддерживался частично, но:

1. Некоторые свойства (или их комбинации) могли работать не так, как прежде, особенно при попытке связаться с новыми версиями SQL Server или с Azure SQL.  
2. В более поздних версиях (Access 2013+) ADP уже официально не поддерживается, и некоторые серверные свойства форм исчезают или не функционируют.

Однако в **Access 2010** формально большая часть ADP-свойств ещё присутствовала. Так что «удаление» затронуло, скорее, Access 2013+.

---

## Выводы и краткий список «что реально пропало или стало бесполезным»

1. **Data Access Pages (DAP)**  
   - Свойства и объекты, связанные с DAP, были полностью убраны из Access 2010.  
2. **PivotTable/PivotChart**  
   - Свойства вида `AllowPivotTableView` и `AllowPivotChartView` в 2010 остались «для галочки», но уже объявлены устаревшими (а в 2013 удалены).  
3. **MenuBar/Toolbar**  
   - В новой базе (ACCDB) под Access 2010 эти свойства формально не появляются в Property Sheet и не работают как раньше, хотя могут быть видны в режимах совместимости. По сути, заменены на `RibbonName`.  
4. **ActiveX-контролы**  
   - Многие старые ActiveX-компоненты из комплекта Office 2003 отсутствуют в Office 2010, а следовательно «выпиливаются» их свойства.  
5. **Data Access Project (ADP) специфические свойства**  
   - Часть SQL-связанных свойств либо потеряла функциональность, либо доступна только если открывать ADP в режиме совместимости.  

Таким образом, **прямо „исчезнувших из базы свойств формы“** между Access 2003 и Access 2010 не так много (например, `MenuBar`, `Toolbar`, `ShortcutMenuBar` и некоторые DAP/Pivot‑свойства могут быть недоступны в чистом ACCDB), однако на практике разработчики Access 2003 часто сталкивались с ситуацией, что:

> - Одни свойства *формально* ещё есть, но больше не работают.  
> - Другие свойства (связанные со старыми объектами) *полностью удалены* и при миграции вызывают ошибку или «broken form».

Если же вам нужно конкретно найти, почему у вас «сломалось» свойство X после миграции, то почти наверняка оно относится к одной из перечисленных четырёх групп (DAP, Pivot, классическое меню, ActiveX) или к ADP‑специфике. Все остальные привычные свойства формы (Record Source, Control Source, ScrollBars, BorderStyle, PopUp и т. д.) в Access 2010 сохранились и работали примерно так же, как и в 2003.
~~~


## 10. Какие конкретно методы и события Access 2003 работают иначе в Access 2010?
### 10.1.
Я тебя спросил:
~~~
В пункте 5.2 ты писал:
```
Методы и события, на которые полагались формы в VBA-коде, могут работать иначе
```
Какие конкретно методы и события Access 2003 работают иначе в Access 2010?
~~~

### 10.2.
Ты ответил:
~~~
Ниже приведён подробный обзор известных изменений в методах и событиях, которые могли повлиять на работу форм (и VBA-кода), при переходе с Access 2003 на Access 2007/2010. Сразу стоит отметить, что **Microsoft не публиковала исчерпывающий список изменений** именно в плане «событие Х работало так в 2003, а в 2010 изменилось на Y». Часть старого функционала официально объявлена устаревшим (deprecated), часть — «сохранилась, но ведёт себя иначе», а кое-что просто убрали. Ниже — самые распространённые случаи, которые на практике ломали логику в мигрируемых проектах.

---

## 1. Изменения, связанные с меню и панелями инструментов (CommandBars → Ribbon)

### Что было в Access 2003
- **Пользовательские меню** и **панели инструментов** (CommandBars).  
- События, завязанные на объекты `CommandBarButton` и т. п.  
- Методы `DoCmd.ShowToolbar`, `DoCmd.AddMenu`, а также доступ к `CommandBars` в VBA, где можно было отлавливать события нажатий на кнопки в меню/панелях.

### Что изменилось в Access 2010
- **Интерфейс ленты (Ribbon)** заменил классические меню.  
- Старые методы (например, `DoCmd.ShowToolbar`, `CommandBars("MyToolbar").Visible = True`) могут не работать или не давать должного эффекта.  
- Если в VBA-коде были события, связанные с элементами `CommandBarButton`, в среде ленты они не вызываются. Теперь настройка и реагирование на элементы ленты идёт совсем иначе (XML + callbacks).  
- Свойства формы `MenuBar`, `Toolbar` формально присутствуют в режиме совместимости, но в `.accdb` и ADP на Access 2010 уже не работают (или работают непредсказуемо).  

**Итог:** События и методы для классических меню/панелей (например, _Click_ на CommandBarButton) фактически «считайте удалёнными» при использовании нового формата и ленты.

---

## 2. Изменения в поведении событий формы (On Open, On Load, On Current и т. п.)

В целом базовые события (On Open, On Load, On Current, On Resize, On Close и прочие) **сохранились** в Access 2010. Однако на практике возникают такие различия:

1. **Порядок вызова некоторых событий** мог сдвинуться, если форма открывается в табличном режиме документов (Tabbed Documents) вместо классического MDI. Например, в Access 2007/2010 при включённом режиме вкладок форма может сначала загружаться «вкладкой», затем срабатывать On Load, а не в том порядке, который был в Access 2003 при MDI-окнах.  
2. **События, связанные с MenuBar/Toolbar** (например, On Update Toolbar) утратили актуальность, поскольку Ribbon устроена иначе.  
3. **События ActiveX-контролов** (On Updated, On InteractiveChange и т. п.) могут не срабатывать, если контрол не поддерживается в Access 2010 или установлен другой версии.  
4. **On Current** в проектах ADP иногда ведёт себя иначе при работе с SQL Server 2008+ или Azure SQL (особенно если форма основана на хранимой процедуре): в Access 2003 могло быть одно поведение при переключении записей, а в Access 2010 — другое (вплоть до дополнительных перезапросов).

Часто это не «ломает» код глобально, но может менять последовательность выполнения, если ваш VBA строго опирается на точный порядок (например, что On Load обязательно срабатывает до On Current — что в общем случае верно, но подспудные отличия иногда всплывают).

---

## 3. Изменения в событиях PivotTable / PivotChart

В Access 2003 можно было открыть форму/отчёт в режиме сводной таблицы (PivotTable) или сводной диаграммы (PivotChart). С ними были связаны дополнительные события и методы, например:
- `Form.PivotTableChange`  
- `Form.PivotChartOpen`  
- Переход в режим сводной таблицы (который можно было вызвать через `DoCmd.RunCommand acCmdPivotTableView` и т. п.)

В Access 2010 этот функционал объявлен устаревшим, а начиная с Access 2013 — полностью убран. Соответственно:
- **События**, которые происходили в режиме PivotTable/PivotChart, могут не вызываться или работать непредсказуемо (в зависимости от SP-билда Office 2010).  
- Методы `DoCmd.RunCommand acCmdPivotTableView` могут выдавать ошибку или не делать ничего.

---

## 4. Методы/объекты, связанные с Data Access Pages (DAP)

В Access 2003 существовал объект **`DataAccessPage`** и события, связанные с ним, а также методы вроде:
- `Application.CreateDataAccessPage`
- Доступ к коллекции `CurrentProject.AllDataAccessPages`  
- События при открытии страницы (OnBeforeOpenDataPage и т. д.)

В Access 2010 **редактирование и создание** DAP недоступно, поддержка DAP фактически удалена, а сами объекты считаются устаревшими.  
Если в VBA были вызовы этих методов/событий, вы получите ошибку «Method not found» либо «Object or property not supported».

---

## 5. Изменения в поведении ADP (Access Data Project)

При работе именно с ADP в Access 2003 часто использовались методы для:
- Прямого открытия серверных объектов (хранимых процедур, функций) в режиме конструктора  
- Управления подключением через `CurrentProject.Connection` (ADO)  
- События, связанные с `ServerFilterByForm` и `UniqueTable` при редактировании SQL-данных

В Access 2010 ADP ещё формально поддерживаются, но уже **с рядом ограничений**:
- Некоторые методы ADP (например, открытие диаграмм SQL Server) в 2010 уже не работали.  
- Событие и свойство `ServerFilterByForm` могло работать иначе в связке с новыми версиями SQL Server.  

К тому же в 64-битном Access 2010 при вызове некоторых ADO- или DAO-методов (особенно если в VBA прописаны `Declare` для API) возможны сложности, так как сигнатуры должны быть адаптированы к 64-бит.  

---

## 6. Устаревшие/удалённые глобальные методы и объекты в VBA

Хотя это не совсем «события форм», многие проекты Access 2003 используют глобальные методы и объекты VBA, которые к 2010 стали недоступны:

1. **`FileSearch`** (объект и метод `Application.FileSearch` пропали ещё в Office 2007). Если в коде формы вызывался `Application.FileSearch.Execute`, в Access 2010 получите ошибку «Method or data member not found».  
2. **`DoCmd.AddMenu`** — работал для добавления пользовательского меню в 2003, но в 2010 фактически не актуален (из-за Ribbon). Часто выдаёт ошибку или не даёт эффекта.  
3. **`RunCommand acCmdSaveAsDataAccessPage`** и похожие команды, связанные с DAP, Pivot и т. п., — тоже мёртвые.  

Часть таких методов могла вызываться из событий формы (например, в On Click кнопки) и теперь приводит к сбою.

---

## 7. Различия в сигнатурах API и событиях при переходе на 64-бит Access

Это уже не строго «Access 2010» отличие, а **Access 2010 (64-бит)** vs. **Access 2003 (32-бит)**. Но в реальных проектах часто встречаются проблемы:

- Если в VBA-коде формы есть вызовы Windows API через `Declare Function ... As Long`, в 64-бит версии это может требовать `LongPtr` и другую сигнатуру. Иначе при срабатывании события (On Load / On Click) форма просто упадёт с ошибкой.  
- В результате кажется, что «событие не работает», хотя на самом деле рушится вызов API.

---

## 8. События ActiveX-контролов

Наконец, если в Access 2003 вы использовали:
- **Microsoft Calendar Control** (Calendar Control 11.0)  
- **Date and Time Picker** (MSComCtl2.DTPicker)  
- Иные OCX-компоненты  

То в Access 2010 (особенно 64-бит) нередко:
1. Эти контролы **не устанавливаются** по умолчанию.  
2. Их события (On Click, On Change и т. п.) просто не регистрируются, так как компонента нет в системе.  
3. Да и сам VBA-код, обращающийся к свойствам/методам контрола, вызывает ошибку «Object doesn’t support this property or method».

Это выглядит, как «события перестали срабатывать», но причина — отсутствие или несовместимость ActiveX-контрола.

---

# Итоговый обзор

1. **Прямо „переименованных“ событий** между Access 2003 и 2010 почти нет — названия основных событий (On Open, On Load, On Current, On Close и т. д.) остались прежними.  
2. **Чаще всего изменения касаются**:
   - \[**Классические меню и панели** → Ribbon\] — события CommandBars/Toolbar не работают или перестали вызываться.  
   - \[**PivotTable/PivotChart**\] — события перестали работать в 2010 (или работают «наполовину»), а в 2013 были полностью вырезаны.  
   - \[**Data Access Pages**\] — методы и события DAP убраны.  
   - \[**ADP**\] — часть серверных функций/событий изменила поведение; в более поздних версиях ADP вовсе недоступны.  
   - \[**ActiveX**\] — если контрол недоступен или несовместим, его события отсутствуют.  

3. **Методы** (а не события) тоже могут «пропадать» или работать иначе — в первую очередь это касается всего, что взаимодействовало со старыми объектами (DAP, Pivot, FileSearch, AddMenu, ShowToolbar).  

4. Если в проекте есть специфические вызовы (например, `DoCmd.RunCommand acCmdSomethingPivot`, `DoCmd.AddMenu`, `Application.FileSearch`), нужно проверить, **не оказались ли они в числе удалённых/устаревших**.  

Таким образом, при миграции с Access 2003 на 2010 самое «болезненное» — переход на Ribbon вместо CommandBars, удалённые DAP/Pivot функциональности, а также нюансы ADP и ActiveX‑контролов. Именно это приводит к тому, что «некоторые методы и события, на которые полагались формы в VBA-коде, теперь не вызываются или требуют другой синтаксис/подход».
~~~


## 11. Какие конкретно методы и события Access 2003 требуют новой синтаксической конструкции в Access 2010?
### 11.1.
Я тебя спросил:
~~~
В пункте 5.2 ты писал:
```
Методы и события, на которые полагались формы в VBA-коде, могут работать иначе
```
Какие конкретно методы и события Access 2003 требуют новой синтаксической конструкции в Access 2010?
~~~

### 11.2.
Ты ответил:
~~~
Ниже приводятся **конкретные примеры** методов и сценариев из Access 2003, которые в Access 2010 (особенно при работе с формами и VBA) **требуют иной синтаксис или вообще другую реализацию**. При этом следует иметь в виду, что **Microsoft не выпускала единого «справочника замен»**. Большинство «новых синтаксисов» — это либо переход на объекты Ribbon вместо CommandBars, либо отказ от устаревших команд (Pivot, DAP, FileSearch и т. п.) в пользу иных библиотек и подходов.

---

## 1. Переход с классических меню/панелей инструментов на Ribbon

### Что было в Access 2003
- **CommandBar**-объекты (MenuBar/Toolbar) и методы для их управления:  
  ```vba
  ' Пример "старого" кода в Access 2003
  DoCmd.ShowToolbar "MyCustomToolbar", acToolbarYes
  CommandBars("MyCustomMenu").Enabled = True
  ```
- События, связанные с элементами командных панелей, могли обрабатываться через **OnAction** и т. п.

### Что изменилось (Access 2010)
- Старые методы `ShowToolbar`, `AddMenu` и манипуляции с `CommandBars` **не работают** для управления лентой (Ribbon).  
- Нужно **создавать пользовательскую ленту (Custom Ribbon)** через XML и «привязывать» её к базе (через свойства `RibbonName` в форме или глобально).  
- Вместо события `CommandBarButton.OnAction` теперь используются «колбэки» (Callback) для кнопок в XML-описании ленты.  
- **Новый синтаксис**: нет прямого аналога «DoCmd.AddMenu», а настройка меню идёт через импорт XML и обратные вызовы в VBA, например:
  ```xml
  <customUI xmlns="http://schemas.microsoft.com/office/2006/01/customui">
    <ribbon>
      <tabs>
        <tab id="MyCustomTab" label="My Tab">
          <group id="MyGroup" label="My Group">
            <button id="MyButton"
                    label="Click me"
                    onAction="MyButtonCallback"/>
          </group>
        </tab>
      </tabs>
    </ribbon>
  </customUI>
  ```
  ```vba
  ' VBA Callback:
  Public Sub MyButtonCallback(control As IRibbonControl)
      MsgBox "Hello from Ribbon!"
  End Sub
  ```
Таким образом, **«методы» CommandBars** в Access 2003 → **«колбэки» и XML** в Access 2010.

---

## 2. PivotTable/PivotChart команды и события

### Что было в Access 2003
- Методы, позволяющие переключать форму в сводный режим (PivotTable/PivotChart), например:
  ```vba
  DoCmd.RunCommand acCmdPivotTableView
  ```
- События формы, связанные с изменением сводной таблицы, типа `Form.PivotTableChange` (при перестроении полей).
- Нative Access Pivot-функциональность для отображения сводных диаграмм.

### Что изменилось (Access 2010)
- PivotTable/PivotChart в Access 2010 **ещё формально существуют**, но объявлены «устаревшими» (deprecated). В Access 2013 их **полностью удалили**.  
- Некоторые методы (например, `acCmdPivotTableView`) могут **ничего не делать** или выдавать ошибку, а события Pivot при определённых настройках — **не вызываться**.  
- **Альтернативный подход**:  
  - Использовать стандартные формы и отчёты с графическими объектами (графиками) через «встроенный» конструктор диаграмм Access 2010 (другой движок).  
  - Или строить сводные отчёты средствами SQL Server/Reporting Services, если речь о данных на SQL.  

Тут нет «нового» именно VBA-синтаксиса (чтобы «заменить одну строчку на другую»), а скорее **надо отказаться** от старых методов и событий Pivot и **перепроектировать** отчёт/форму в другой системе.

---

## 3. Data Access Pages (DAP): создание, открытие, события

### Что было в Access 2003
- Методы для работы с DAP, например:
  ```vba
  Application.CreateDataAccessPage "MyPage.htm", CurrentProject.Path & "\template.htm"
  ```
- Доступ к коллекции `CurrentProject.AllDataAccessPages`, события при открытии DAP в Access.

### Что изменилось (Access 2010)
- Поддержка DAP **убрана**, ни создание, ни редактирование уже **невозможно**.  
- Любой вызов `CreateDataAccessPage`, `AllDataAccessPages` и т. д. — вызывает ошибку «Method not found» или «Object not supported».  
- **Новая «синтаксическая конструкция»** фактически отсутствует — DAP не имеют прямой замены. Нужно переводить логику на «Access Forms/Reports + SharePoint» (Access Services) или использовать ASP.NET/Power Apps и т. п.

---

## 4. Методы для классических меню в VBA: `DoCmd.AddMenu`, `CommandBarButton.OnAction` и т. п.

### Что было в Access 2003
```vba
DoCmd.AddMenu "MyMenuName", "MyMenuMacro"
CommandBarButton.OnAction = "MyMacro"
```

### Что изменилось (Access 2010)
- Нельзя просто «AddMenu» в ленту: надо прописывать XML + колбэки (см. пункт 1).  
- Если в старом коде встречается `DoCmd.AddMenu`, он либо не даёт эффекта, либо вызывает ошибку.  
- **Новая конструкция** → создавать XML Ribbon и подключать обратные вызовы на VBA-процедуры.  

---

## 5. Глобальный объект `Application.FileSearch`

### Что было в Access 2003
```vba
With Application.FileSearch
   .LookIn = "C:\SomeFolder"
   .SearchSubFolders = True
   .Execute
   ...
End With
```
- Использовалось для поиска файлов в VBA.

### Что изменилось (Access 2007 / 2010)
- `Application.FileSearch` **убрали** во всём Office 2007 и выше.  
- **Новая конструкция**: нужно применять либо `Dir`, либо `FileSystemObject`, либо .NET/Windows API. Пример замены:
  ```vba
  ' Вместо FileSearch используют FileSystemObject:
  Dim fso As Object
  Dim folder As Object
  Dim file As Object

  Set fso = CreateObject("Scripting.FileSystemObject")
  Set folder = fso.GetFolder("C:\SomeFolder")
  For Each file In folder.Files
      Debug.Print file.Name
  Next
  ```

---

## 6. Изменения в вызовах Windows API при переходе на 64-бит (Access 2010 x64)

### Что было в Access 2003 (32-бит)
```vba
Public Declare Function GetUserName Lib "advapi32.dll" _
   Alias "GetUserNameA" (ByVal lpBuffer As String, nSize As Long) As Long
```

### Что изменилось (Access 2010 64-bit)
- Нужно использовать `PtrSafe` и `LongPtr`:
  ```vba
  #If VBA7 Then
      Public Declare PtrSafe Function GetUserName Lib "advapi32.dll" _
      Alias "GetUserNameA" (ByVal lpBuffer As String, ByRef nSize As LongPtr) As Long
  #Else
      Public Declare Function GetUserName Lib "advapi32.dll" _
      Alias "GetUserNameA" (ByVal lpBuffer As String, ByRef nSize As Long) As Long
  #End If
  ```
- Если этого не сделать, при запуске формы (где код вызывает API) будет ошибка «Compile error: The code in this project must be updated for use on 64-bit systems».

Это именно **другая синтаксическая конструкция** (добавление `PtrSafe`, `LongPtr`) для декларации API.

---

## 7. ActiveX-контролы (Calendar Control, DTPicker и др.)

### Что было в Access 2003
```vba
' Предположим, Microsoft Calendar Control 11.0:
Private Sub Calendar0_Click()
    TextBox1.Value = Calendar0.Value
End Sub
```
### Что изменилось (Access 2010)
- В Office 2010 многие старые ActiveX-контролы (особенно «Calendar Control») **не поставляются**.  
- При открытии формы с таким контролом → событие `On Click` **вообще не вызывается**, а форма может «сломаться».  
- **Новая конструкция**: нужно либо  
  - Подключать новую версию контрола (если существует), у которого события и свойства могут иметь другие имена;  
  - Использовать стандартные элементы (например, «Date Picker» встроенный в текстовые поля Access 2007+), где событие `On Click` отсутствует — вместо него просто пользователь выбирает дату в поле.  
- Это уже не просто «один метод заменили на другой», а полная переписка логики.

---

## 8. События, связанные с ADP и SQL Server (Access Data Project)

### Что было в Access 2003
- Прямые вызовы серверных объектов (Open Stored Procedure in design view), настройки `ServerFilterByForm`, `UniqueTable`, `ResyncCommand`.
- Некоторые методы и события могли срабатывать по-другому (например, `Form_BeforeUpdate` при работе с серверными полями).

### Что изменилось (Access 2010)
- ADP **ещё поддерживаются**, но ограничено. Часть серверных функций не работает «из коробки».  
- Если вы мигрируете на Office 2010 x64, могут понадобиться правки в ADO (задекларировать методы как PtrSafe).  
- В итоге зачастую проще перейти не на ADP, а на `*.accdb` + ODBC Linked Tables. Тогда логика событий (BeforeUpdate и т. д.) сохраняется, но все «ADP-специфические» методы (**DoCmd.OpenStoredProcedure**, прямое редактирование таблиц SQL Server через ADP и т. п.) пропадают, и вместо них нужна классическая связка DAO/ODBC.

---

# Вывод и краткая сводка

- **Нет** одного‑единственного «списка» методов/событий, которым просто заменили имена. Чаще всего речь идёт об **устаревших функциях** (Pivot, DAP, классические меню/панели, `FileSearch`) или **смене инфраструктуры** (Ribbon, 64-бит API, ActiveX-контролы).  
- **Где действительно нужен «новый синтаксис»:**  
  1. \[**Меню/панели → Ribbon**\] — старые вызовы CommandBars и события заменяются на XML+Callback.  
  2. \[**FileSearch**\] → `FileSystemObject` или `Dir$`.  
  3. \[**32-бит API**\] → `Declare PtrSafe` и типы `LongPtr` для 64-бит.  
- **Где «синтаксиса» нет, а нужна полная переделка:**  
  - Pivot (замена на собственные средства отчетов или другие инструменты),  
  - DAP (удалены, нужна новая технология),  
  - ActiveX-контролы, которых нет в Office 2010.  

Таким образом, если в вашем Access 2003‑проекте активно использовались перечисленные выше методы/события, то **при миграции на Access 2010** придётся либо **заменять** их на Ribbon/XML, либо **отказываться** от них в пользу других решений, либо **переписывать** часть кода (особенно с учётом 64-бит и отсутствия «старых» ActiveX).
~~~


## 12. «После открытия проекта в новой версии Access могут «потеряться» некоторые библиотеки (например, ADO, DAO, ActiveX Controls и т. д.).»
### 12.1.
Я тебя спросил:
~~~
В пункте 5.2 ты писал:
```
   - После открытия проекта в новой версии Access могут «потеряться» некоторые библиотеки (например, ADO, DAO, ActiveX Controls и т. д.). 
```
Учёл ли ты это обстоятельство в своей пошаговой инструкции пункта 4.2?
~~~

### 12.2.
Ты ответил:
~~~
Ниже — развёрнутый ответ о том, **как вопрос «пропавших» библиотек (References) учитывается** (или не вполне учитывается) в исходной пошаговой инструкции, которую я дал в пункте 4.2, и **как правильно дополнить/уточнить** её, чтобы явно охватить ситуацию со «сброшенными» или «потерянными» ссылками на библиотеки и ActiveX‑контролы.

---

## 1. Что уже было упомянуто в инструкции 4.2

В исходном тексте инструкции (из пункта «4.2»), в **шаге 3** («Проверка и настройка VBA‑кода») указывалось следующее:

> 3.2) В окне «Visual Basic Editor» перейти в «Tools» → «References» и убедиться, что все необходимые библиотеки ... корректно доступны.  
> 3.3) При необходимости установить недостающие ссылки или отключить неиспользуемые, которые могут быть помечены как MISSING.  
> 3.4) В «Visual Basic Editor» запустить «Debug» → «Compile», чтобы проверить наличие синтаксических ошибок или проблем с библиотеками.

Таким образом, **в общих чертах** фактор «потерявшихся» библиотек уже **учтён** в виде совета проверить ссылки (References) и при необходимости их «починить». То есть **сам факт, что библиотеки ADO, DAO или ActiveX могут «слететь»**, в инструкции **упомянут**.

Однако в том варианте инструкции, который я дал, этот момент прописан **довольно кратко**. На практике же проблемы с библиотеками могут быть весьма обширными и вызывать ошибки на многих формах и модулях VBA. Поэтому зачастую требуется более детальное пояснение, как именно действовать, если «ссылка пропала» или «контрол не зарегистрирован».

---

## 2. Как можно уточнить инструкцию, чтобы лучше осветить проблему с References

Чтобы **сделать инструкцию более полной**, добавляют дополнительный пункт или расшифровку существующего «Шага 3». Вот пример, **как можно расширить**:

### 3. Проверка и настройка References (библиотек)

1. **Открыть References**  
   - В «Visual Basic Editor» (Alt+F11) выберите «Tools» → «References».  
   - Просмотрите список: если напротив какой-то библиотеки указано «MISSING: ...», поставьте галочку на нужную версию библиотеки (если она доступна) или снимите галочку, если библиотека не нужна/недоступна.

2. **Проверить наличие установленных библиотек**  
   - Иногда библиотека ADO (Microsoft ActiveX Data Objects) или DAO (Microsoft DAO X.X Object Library) **может отсутствовать** в той версии Office, которая установлена на рабочей станции.  
   - Если вы используете ADO, нужно **установить подходящую версию** (например, «Microsoft ActiveX Data Objects 6.1 Library», если она доступна) или поставлять отдельно нужный драйвер.  
   - Если нужна библиотека Microsoft Excel/Word (автоматизация), её версии тоже могут отличаться (14.0 в Office 2010, 16.0 в Office 365 и т. п.).

3. **ActiveX-контролы**  
   - Если в проекте используются сторонние ActiveX (OCX-файлы) или компоненты Office (Calendar Control, TreeView из MSCOMCTL.OCX и т. п.), **убедитесь**, что они установлены и зарегистрированы на новой машине.  
   - Если контрол физически отсутствует (не установлен), то в References вы можете увидеть «MISSING: <имя ActiveX>», а в форме контрола вообще не будет — Access заменит его на пустой объект или выдаст ошибку «The OLE server isn't registered».  
   - При необходимости нужно **переустановить** нужный ActiveX или перейти на современный аналог (встроенный Date Picker и пр.).

4. **Компиляция и отладка**  
   - После корректировки ссылок выполните «Debug» → «Compile» в VBA‑редакторе.  
   - Если всё ещё появляются ошибки вида «User-defined type not defined», это признак того, что в References всё ещё отсутствует нужная библиотека (например, ADO).  
   - Исправляйте «MISSING»-ссылки, пока проект не будет компилироваться без ошибок.

5. **Документирование**  
   - Запишите, какие именно библиотеки (и каких версий) требуются проекту. Это облегчает дальнейшую миграцию (например, если переходите на Access 365).  
   - Если библиотека редкая или устаревшая, стоит рассмотреть её замену на стандартные средства (например, использовать DAO вместо ADO, если ADO не критичен, и т. д.).

В итоге вы получаете **более подробный шаг** по работе с References и ActiveX-контролами — чтобы на практике избежать того, что «половина VBA-кода не компилируется из-за MISSING-ссылок» или «формы не открываются, потому что контрол пропал».

---

## 3. Итог

1. **Да**, в исходной инструкции (п. 4.2) это учтено **(шаг 3.2 / 3.3)**, но **лишь в общем виде**.  
2. На **практике** при миграции ADP (или MDB) с Access 2003 на Access 2010 нередко приходится уделять **особое внимание** переподключению библиотек ADO, DAO, Excel/Word, MSCOMCTL (ActiveX) и проверке 32/64-битных версий.  
3. Чтобы **явно отработать** все потенциальные проблемы с потерянными ссылками, можно расширить инструкцию отдельным детальным блоком, как описано выше.  

Таким образом, **ответ** на вопрос «Учёл ли я этот аспект в инструкции?» — **учёл**, но **кратко**. Если вам нужно **подробно** руководствоваться инструкцией, стоит усилить соответствующий раздел и расписать каждую деталь, касающуюся «пропавших» библиотек и ActiveX.
~~~



## 13. «При переходе на Access 2010 часть объектов требуется перенастроить (Record Source, привязки, параметры форм)»
### 13.1.
Я тебя спросил:
~~~
В пункте 5.2 ты писал:
```
3. **Изменения в способе подключения к SQL Server**  
   - Формы в ADP могут быть настроены напрямую на объекты SQL Server (таблицы, представления, хранимые процедуры) и использовать особенности ADP (например, прямое редактирование серверных объектов).  
   - При переходе на Access 2010 часть объектов требуется перенастроить (Record Source, привязки, параметры форм). Если этого не сделать, формы «не видят» таблиц или возвращают ошибки при попытке отображать данные.
```
Учёл ли ты это обстоятельство в своей пошаговой инструкции пункта 4.2?
~~~

### 13.2.
Ты ответил:
~~~
Короткий ответ:  
• В «базовой» версии пошаговой инструкции (см. пункт 4.2), это учтено — там действительно есть шаг, где рекомендуются проверка и перенастройка источников данных форм (Record Source, Control Source) и переопределение связей с SQL Server.  
• Однако подробные нюансы (например, необходимость заново прописывать параметры форм, перенастраивать хранимые процедуры, корректировать InputParameters и т. п.) там отражены лишь общими словами. Ниже — детализированное объяснение.  

────────────────────────────────────────────────────────
1. Что уже было сказано в инструкции пункта 4.2
────────────────────────────────────────────────────────
В исходной инструкции (п. 4.2) есть такой фрагмент (цитирую близко к тексту):

• «4.2) Открыть каждую форму и проверить свойства источников данных (Record Source, Control Source) на совместимость с Microsoft Access 2010.»  
• «4.3) При необходимости изменить ссылки на объекты SQL Server. Например, вместо устаревших способов прямого доступа использовать действующие объекты (Views, Stored Procedures) или настроить связи через ODBC.»

Это означает, что общий посыл «после конвертации ADP могут «потеряться» или некорректно работать привязки к таблицам/представлениям и придётся их вручную переназначать» уже присутствует.  
Но, как правило, в реальном проекте с большим количеством форм, связанных с хранимыми процедурами, функциями или нестандартными параметрами (InputParameters), нужно более детально расписать, что именно и в каком порядке проверять.  

────────────────────────────────────────────────────────
2. Как можно дополнить инструкцию, чтобы учесть все нюансы
────────────────────────────────────────────────────────
Чтобы учитывать «при переходе на Access 2010 часть объектов нужно перенастроить (Record Source, привязки, параметры форм)», в инструкции обычно добавляют более развёрнутый подпункт. Пример:

• «Проверка каждой формы» (Record Source / Control Source):  
  – Откройте форму в режиме конструктора (Design View).  
  – Перейдите в окно свойств (Property Sheet → вкладка Data).  
  – Убедитесь, что в поле «Record Source» указаны актуальные объекты SQL Server (или локальные таблицы, если вы решили перейти на связанный ODBC‑режим).  
  – Если форма была основана на хранимой процедуре (Stored Procedure), посмотрите на свойство «InputParameters»:  
    → Уточните, правильно ли задана строка параметров (например, @Param1 int = Forms!MyForm!TextBox1).  
    → Проверьте, не исчезла ли у вас связь (binding) из-за изменения названия процедур, схем, или если хранимая процедура теперь запрашивает иные параметры.  

• «Связь с контролами» (Control Source, поля формы):  
  – В режиме конструктора формы проверьте каждый элемент управления (TextBox, ComboBox и т. д.). Если в «Control Source» была указана колонка из таблицы/представления, убедитесь, что эта колонка до сих пор существует и имеет то же название на SQL Server.  
  – Если же «Control Source» ссылался на функцию или выражение, убедитесь, что синтаксис не «сломался» (особенно если это была функция VBA, которая перестала работать при обновлении библиотеки).  

• «Серверные фильтры и параметры (ServerFilter, ServerFilterByForm и т. п.)»:  
  – В ADP иногда применялись дополнительные свойства для фильтрации на стороне SQL. В Access 2010 (а тем более в более поздних версиях) эти механизмы могли ограниченно работать или вообще не поддерживаться. Нужно проверить, не нужно ли вам перенастраивать логику фильтра через обычное «Where» при открытии формы (DoCmd.OpenForm…, WhereCondition:=…).  

• «Проверка ошибок и тест»:  
  – После каждого изменения откройте форму в режиме Form View, проверьте, приходят ли данные с SQL Server, корректно ли обрабатываются поля, не возникает ли ошибок «#Name?», «#Error», «Invalid object name» и т. п.  
  – Если используете ADP и видите, что часть возможностей (например, редактирование данных в таблице) не работает, решите, не проще ли перейти на формат ACCDB + Linked Tables (ODBC-связь).  

Таким образом, в обновлённой инструкции мы прямо указываем, какие именно свойства и параметры нужно «перепроверять» и «перенастраивать», чтобы формы не «падали» или не оставались «пустыми» при подключении к SQL Server из Access 2010.  

────────────────────────────────────────────────────────
3. Итог
────────────────────────────────────────────────────────
• В исходном варианте пошаговой инструкции (п. 4.2) этот момент — про «перенастройку» (Record Source, параметры форм, привязки) — уже упомянут, но скорее в общем виде: «проверьте источники данных для каждой формы и при необходимости перенастройте».  
• Если в проекте много форм/модулей, где активно использовались хранимые процедуры, функции SQL или специфические свойства ADP, стоит расширить инструкцию отдельным блоком (см. пример) и более детально описать, как проверять/изменять InputParameters, ServerFilter, свойства ElementName и т.д.  

Таким образом, «да», это обстоятельство формально учтено в базовом пункте 4.2, но чтобы избежать пропусков и самых частых ошибок, обычно добавляют подробные пояснения, как именно и в каком порядке проводить перенастройку каждого объекта, связанного с SQL Server.
~~~


