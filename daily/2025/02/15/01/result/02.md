1) Ensure that none of your applications depend on the 8.3 (short) name mechanism  
2) Make a backup of critical data.   
3) Run the command:  
```
fsutil 8dot3name query
```  
https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/fsutil-8dot3name  
3.1) If `fsutil` returns `1` or `3`, it means that short names are already disabled (fully or partially).  
3.2) If `fsutil` returns `0`, it means that short names are enabled.  
3.3) If `fsutil` returns `2`, it means that the volume level setting is used.  
4) In the case of 3.2, 8.3-names must be disabled.  
4.1) The shortest way to do this is with the same `fsutil` program:  
```
fsutil 8dot3name set 1
```  
4.2) Another way is to use the «Registry Editor»:
4.2.1) Open the «Registry Editor» (through «Start» → «Run» → enter `regedit`).
4.2.2) Go to the following path: «HKEY_LOCAL_MACHINE» → «SYSTEM» → «CurrentControlSet» → «Control» → «FileSystem».
4.2.3) Locate the 'NtfsDisable8dot3NameCreation' parameter.
4.2.4) Change the «Value data» to 1 in order to disable the 8.3 mechanism for all volumes.
4.2.5) Close the «Registry Editor».
5) Reboot the server for the changes to take effect for all new file operations.
After the reboot, new files and directories will not be given short names. 
6) Delete existing 8.3 file names.
This is especially important for the IIS web content directory.
6.1) Run the command:  
```
fsutil 8dot3name strip
```  
6.1.1) Example (with subdirectory processing enabled and logging to `strip-log.txt`):  
```
fsutil 8dot3name strip /s /l strip-log.txt D:\inetpub\wwwroot
```  
In this command:
- `/s` indicates that the operation will be applied to all subdirectories.
- `/l` specifies a log file; in this case `strip-log.txt`.
- `D:\inetpub\wwwroot` is an example path to the directory where the web content is located.
6.2) Analyze the resulting log (`strip-log.txt` from the example in 6.1.1).
If any applications still reference short names, deleting 8.3 names may cause errors in those applications.
Therefore, I recommend running the command with the `/t' parameter (test mode) before final deletion to identify potentially problematic files. 
7) Re-run the scan tool that detected the IIS Short Name Enumeration vulnerability.
This is usually done by an external PCI DSS Approved Scanning Vendor (ASV) or with software such as Tenable Nessus, Qualys, or others.
Ensure that the issue no longer appears in the scan report. 
8) Additional actions (if necessary)
8.1) If you have old applications that require short names, instead of globally disabling 8.3 (value `1`), you can set `NtfsDisable8dot3NameCreation` to `2` or `3`.
After that, you will be able to enable or disable 8.3 names for individual volumes manually. 
8.2) You can configure filtering for the `~` character in Microsoft Internet Information Services (IIS Manager) → «Request Filtering» or through «URL Rewrite» to block specific requests, but this solution only hides the vulnerability at the IIS level.
If the goal is specifically to meet PCI DSS requirements, I recommend the full disabling of 8.3 (with subsequent removal of existing short names).
9) Usually, it is necessary to prepare a report for the PCI DSS auditors indicating what specific steps have been taken. 
---
I have completed 534 projects here on Upwork.
My GitHub profile: https://github.com/dmitrii-fediuk
My websites: https://df.tips?order=views, https://dmitry.ai?order=views, https://mage2.pro?order=views 