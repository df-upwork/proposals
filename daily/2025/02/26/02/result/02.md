The correct way to set up a certificate for hMailServer:
1) Obtain the certificate (or create a self-signed one).
2) Import the certificate (`.pfx` or `.p12`) via «MMC» → «Certificates» → «Local Computer» → «Personal» → «Certificates» into the Windows certificate store . 
3) In case of using separate key and certificate files (e.g. `server.crt` and `server.key`), place them in a secure folder and make sure that permissions to the private key are restricted.
4) In «hMailServer Administrator», go to «Settings» → «Advanced» → «SSL certificates».
5) Click «Add» and specify the following: a name for the new certificate, the path to the private key file (e.g. `C:\Certificates\server.key`), the path to the certificate file (for example, `C:\Certificates\server.crt`), and, if necessary, the path to the intermediate certificates (intermediate chain).
6) Save the settings.
7) In «Settings» → «Advanced» → «TCP/IP ports», set the ports for secure connections (e.g. 993 for IMAP over SSL, 995 for POP3 over SSL, 465 or 587 for SMTP over SSL/TLS).
8) For each port in the «SSL/TLS» field, select the corresponding SSL certificate that was added in the previous step.
9) If necessary, configure «StartTLS» on the standard IMAP/POP3/SMTP ports.
10) Go to «Domains» and make sure that all domains and email addresses are configured correctly.
11) Go to «Settings» → «Protocols» → «SMTP»/«POP3»/«IMAP» and check the ports, limits, and other parameters.
12) In «Settings» → «Anti-spam» / «Anti-virus», make surethat spam filtering and anti-virus integration (if needed) are correctly configured.
13) In Windows Firewall (or another network firewall), make sure  that the appropriate  ports (SMTP, IMAP, POP3) are open, including the SSL ports (465, 587, 993, 995).
14) Check the routing (NAT, if used) on the external router or firewall so that the mail traffic reaches the server.
15) Use a mail client to check the connection over IMAP/POP3/SMTP with SSL/TLS enabled.
16) Ensure that the client application does not display any untrusted certificate warnings (or add the root and intermediate certificates to the trusted store on the client side).
17) Verify that logins and passwords are transmitted correctly over the encrypted channel and that mail traffic is flowing successfully.
18) If necessary, enable additional authentication or anti-spam methods in hMailServer (in «Settings» → «Anti-spam») according to the security policy.
19) Test sending messages to external domains (Gmail, Outlook.com, etc.) and make sure that the messages do not end up in spam folders.
20) Document all the settings used (ports, paths to certificate files, software versions).