https://gemini.google.com/share/22c6a05bdd2c

# 1. `Mᚖ1`: Комплексный CSS-патч стабилизации вьюпорта

### Суть

Данный метод заключается в принудительном создании изолированного контекста наложения для фиксированных элементов интерфейса и жесткой фиксации высоты корневого контейнера.
Необходимо применить CSS-свойство `transform: translateZ(0)` к элементам с `position: fixed` для активации аппаратного ускорения и обхода бага рендеринга WebKit.
Для корневых элементов `html` и `body` следует задать высоту `100dvh`, чтобы компенсировать динамическое поведение адресной строки Chrome в iPadOS 26.
Дополнительно требуется установить `background-color` для `body`, совпадающий с цветом нижней панели, для визуальной маскировки возможных микро-смещений.

### Оценка

95

### Достоинства

Метод устраняет наиболее вероятную первопричину визуального артефакта — ошибку композитинга слоев в новой системе Liquid Glass.
Использование единиц `dvh` обеспечивает математически корректный расчет видимой области с учетом плавающих панелей браузера.
Решение является декларативным, не нагружает основной поток выполнения JavaScript и применяется мгновенно при отрисовке страницы.
Цветовая маскировка фона эффективно скрывает проблему даже в тех редких случаях, когда физическое смещение вьюпорта сохраняется.

### Недостатки

Принудительная аппаратная растеризация может незначительно увеличить потребление видеопамяти на старых устройствах.
Изменение контекста наложения способно повлиять на `z-index` других всплывающих элементов, требуя проверки модальных окон.
В редких случаях комбинация `100dvh` и `translateZ` может конфликтовать с нативным инерционным скроллом iOS.

# 2. `Mᚖ2`: Программная синхронизация геометрии через JavaScript

### Суть

Решение предполагает внедрение скрипта-наблюдателя, который принудительно синхронизирует координаты макета с визуальным вьюпортом при изменении состояния интерфейса.
Скрипт должен отслеживать события `focusout` (закрытие клавиатуры) и `resize`, вызывая микро-прокрутку `window.scrollTo(0, 0)` или пересчет стилей.
Это действие сбрасывает внутренний флаг смещения в движке WebKit, устраняя «фантомный» отступ в 24 пикселя, оставшийся после скрытия клавиатуры.
Метод напрямую адресует механику бага №297779, описанного в техническом анализе проблемы.

### Оценка

85

### Достоинства

Подход гарантированно исправляет смещение интерфейса в сценариях активного взаимодействия с формами ввода и виртуальной клавиатурой.
Скрипт работает реактивно, устраняя проблему именно в момент её возникновения, когда CSS-правила могут быть проигнорированы движком.
Решение не требует радикальной перестройки верстки приложения и может быть внедрено как точечный «хотфикс».

### Недостатки

Использование слушателей событий `resize` и `scroll` создает дополнительную нагрузку на процессор и может вызывать «дрожание» интерфейса.
Существует задержка между возникновением события и срабатыванием скрипта, из-за чего пользователь может заметить скачок контента.
Зависимость от JavaScript делает интерфейс менее устойчивым в условиях высокой загрузки системы или блокировки скриптов.

# 3. `Mᚖ3`: Адаптивная защита безопасных зон

### Суть

Стратегия заключается в замене прямой ссылки на переменную `env(safe-area-inset-bottom)` защитной CSS-функцией `max()`.
Вместо стандартного паддинга следует использовать конструкцию `padding-bottom: max(env(safe-area-inset-bottom), 20px)`, гарантирующую минимальный отступ.
Параллельно необходимо верифицировать наличие мета-тега `viewport` со значением `viewport-fit=cover` для корректной активации полноэкранного режима.
Это страхует верстку от ситуации «нулевого инсета», когда система Liquid Glass неверно сообщает размеры безопасной зоны.

### Оценка

70

### Достоинства

Метод предотвращает полное перекрытие интерактивных элементов интерфейса системным индикатором «Домой» или тулбаром.
Код полностью соответствует стандартам и повышает эргономику приложения на всех безрамочных устройствах Apple.
Решение является предельно простым в реализации и требует минимальных изменений в кодовой базе.

### Недостатки

Данный подход не устраняет саму белую полосу, а лишь сдвигает контент вверх, что может нарушить дизайн-макет.
В случае, если баг вызывает смещение более 20 пикселей, защитного отступа может не хватить для полной компенсации.
Метод борется со следствием ошибки (наложением), но не с её причиной (сбоем вычисления геометрии).

# 4. `Mᚖ4`: Архитектурный рефакторинг позиционирования (Body Scroll Lock)

### Суть

Метод подразумевает полный отказ от использования `position: fixed` для основных элементов навигации в пользу фиксации корневого контейнера и внутреннего скролла.
Верстка перестраивается таким образом, что `body` имеет `overflow: hidden`, а прокрутка осуществляется внутри центрального контейнера с `overflow-y: auto`.
Это исключает элементы из контекста глобального вьюпорта, делая их невосприимчивыми к большинству багов смещения WebKit.
Подход эмулирует поведение нативного приложения, где область просмотра жестко задана и не подвержена «эффекту резинки» на уровне всей страницы.

### Оценка

60

### Достоинства

Архитектура приложения становится полностью иммунной к большинству багов рендеринга `position: fixed` в iOS.
Обеспечивается предсказуемое поведение интерфейса на устройствах с любыми типами экранов и системных панелей.
Решение является наиболее надежным в долгосрочной перспективе, так как не зависит от хаков и специфических версий браузера.

### Недостатки

Реализация требует фундаментальной переработки всей структуры приложения, что сопряжено с высокими затратами времени и риском регрессии.
Внутренняя прокрутка контейнеров на iOS может конфликтовать с нативным поведением адресной строки и жестами обновления страницы («pull-to-refresh»).
Для существующего проекта `P⁎` это решение может быть экономически нецелесообразным из-за большого объема рефакторинга.

# 5. `Mᚖ5`: Организационное устранение через настройки доступности

### Суть

Метод заключается в рекомендации пользователю изменить системные настройки iPadOS для отключения конфликтующих графических эффектов.
Пользователю предлагается включить опцию «Понижение прозрачности» (Reduce Transparency) или активировать режим «Гид-доступ» (Guided Access).
Это действие отключает сложные шейдеры системы Liquid Glass или скрывает системные панели, устраняя причину конфликта рендеринга.
Метод может использоваться как временное решение для критически важных операций, пока не будет внедрен программный фикс.

### Оценка

40

### Достоинства

Включение настройки гарантированно убирает визуальный артефакт, если он вызван сбоем прозрачности системного слоя.
Решение позволяет быстро диагностировать природу проблемы без доступа к коду приложения.
Метод эффективен для корпоративных сред, где можно централизованно управлять настройками устройств сотрудников.

### Недостатки

Перекладывание ответственности за исправление интерфейса на пользователя является неприемлемой практикой для профессионального продукта.
Изменение глобальных настроек влияет на внешний вид всей операционной системы, что может быть неприемлемо для клиента.
Это решение не масштабируется для публичного веб-приложения с широкой аудиторией.

# 6. Вердикт

На основании проведенного анализа причин и решений, наиболее эффективным способом устранения проблемы `P†` является комбинированное применение **Mᚖ1 (Комплексный CSS-патч)** и **Mᚖ2 (JS-синхронизация)**.

Рекомендуется в первую очередь внедрить **Mᚖ1**, так как это решение устраняет визуальные артефакты и стабилизирует вьюпорт средствами CSS, что покрывает 95% сценариев возникновения бага.
Особое внимание следует уделить свойствам `transform: translateZ(0)` для футера и `min-height: 100dvh` для `body`, так как они напрямую адресуют проблему композитинга.
Если проблема сохраняется при активном использовании клавиатуры, необходимо дополнительно подключить скрипт **Mᚖ2** для принудительного сброса координат.
Метод **Mᚖ3** следует применить как стандарт гигиены кода для защиты от перекрытия контента в будущем.