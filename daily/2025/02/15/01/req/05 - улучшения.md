## 1.
Клиент хочет выполнить следующий проект:
### 1.1. Title
IIS Short Name Enumeration Remediation for PCI Compliance
### 1.2. Description
We are seeking an experienced IT security professional to assist in resolving IIS Short Name Enumeration issues for a client undergoing a PCI Compliance Scan. 
The candidate must have a strong understanding of IIS configurations, security vulnerabilities, and PCI DSS requirements. 
You will be responsible for identifying the root cause of the enumeration failures and providing actionable solutions to ensure compliance. 
A solid background in web server security and previous experience with PCI compliance projects is essential.
https://techcommunity.microsoft.com/blog/iis-support-blog/iis-short-name-enumeration/3951320

### 1.3. Tags
PCI
Information Security
PCI DSS
Network Security
GDPR

### 1.4. The link
В пункте 1.2 клиент привёл ссылку https://techcommunity.microsoft.com/blog/iis-support-blog/iis-short-name-enumeration/3951320
По этой ссылке статья со следующим содержимым:
```
# IIS Short name Enumeration
## Symptoms :
The security scan tools show that Microsoft Internet Information Server (IIS) suffers from a vulnerability which allows the detection of short names of files and directories which have an equivalent in the 8.3 version of the file naming scheme. By crafting specific requests containing the tilde '~' character, an attacker could leverage this vulnerability to find files or directories that are normally not visible and gain access to sensitive information. Given the underlying filesystem calls generated by the remote server, the attacker could also attempt a denial of service on the target application.

## Cause:
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\FileSystem\NtfsDisable8dot3NameCreation was not set as 1

## Solution:
1) Open registry editor
2) Navigate to below registry
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\FileSystem
3) Right-click NtfsDisable8dot3NameCreation, and then click Modify.
4) In the Value data box, type 1, and then click OK.

## More Information:
The Default Value of "NtfsDisable8dot3NameCreation" can have the following values:
0: Enables 8dot3 name creation for all volumes on the system.
1: Disables 8dot3 name creation for all volumes on the system.
2: Sets 8dot3 name creation on a per volume basis.
3: Disables 8dot3 name creation for all volumes except the system
```

## 2. Что беспокоит клиента?
### 2.1.
Я тебя спросил:
~~~
Что беспокоит клиента?
В чём состоит его стратегическая задача?
~~~

### 2.2.
Ты ответил:
~~~
Клиент столкнулся с уязвимостью в IIS, связанной с возможностью определения «коротких» (8.3) имён файлов и каталогов, что выявилось в ходе PCI Compliance сканирования. Их **ключевая забота** (то, что “беспокоит” клиента) — **необходимость исправить уязвимость** (IIS Short Name Enumeration) и **пройти PCI аудит**, чтобы оставаться в соответствии с требованиями PCI DSS. 

Соответственно, **стратегическая задача** состоит в том, чтобы:
1. **Идентифицировать первопричину** проблемы (некорректные настройки NTFS, позволяющие 8.3 имена и, следовательно, уязвимость).
2. **Внести изменения в конфигурацию** (например, через реестр Windows, параметр `NtfsDisable8dot3NameCreation`) и другие меры, необходимые для закрытия уязвимости.
3. **Гарантированно соответствовать** требованиям PCI DSS и успешно пройти повторное сканирование/аудит.
~~~

## 3. Security scan tools
### 3.1.
Я тебя спросил:
~~~
В пункте 1.2 клиент упомянул, что обнаружил свою проблему (пункт 2) посредством «security scan tools».
Какие конкретно «security scan tools» он имел в виду?
~~~

### 3.2.
Ты ответил:
~~~
На основании предоставленных данных нельзя с уверенностью сказать, какой именно инструмент (или набор инструментов) применялся у клиента. В пункте 1.2 упоминается лишь общий термин «security scan tools», без конкретных названий. Однако в контексте **PCI DSS** наиболее распространённые сценарии таковы:

1. **PCI Approved Scanning Vendor (ASV) решения**.  
   - *Qualys PCI Compliance Scanning* (один из самых популярных вариантов).  
   - *Tenable (Nessus)*, включая их специализированные модули для PCI.  
   - *Trustwave*, *SecurityMetrics* и др.  
2. **Коммерческие инструменты комплексного сканирования уязвимостей**, которые поддерживают плагины/скрипты для проверки IIS Short Name Enumeration (например, *Nessus*, *Rapid7 Nexpose*, *OpenVAS/GVM*, *Acunetix* и др.).  
3. **Интегрированные сервисы**, предлагаемые в составе облачных платформ или специализированных компаний, выполняющих регулярные PCI DSS-сканирования.

Таким образом, клиент мог использовать любой из вышеуказанных инструментов (или их сочетание). Чаще всего для PCI-аудита приглашают **ASV-провайдера** (Approved Scanning Vendor), который в рамках своих сервисов и выполняет подобные сканирования.
~~~

## 4. techcommunity.microsoft.com/blog/iis-support-blog/iis-short-name-enumeration/3951320
### 4.1.
Я тебя спросил:
~~~
В описании проекта (пункт 1.2) клиент привёл ссылку (пункт 1.4) на статью.
Действительно ли содержимое статьи относится к проблеме клиента?
Действительно ли предложенное в статье решение решит проблему клиента?
Знаешь ли ты альтернативные решения проблемы клиента?
Какое из решений — лучшее?
~~~

### 4.2.
Ты ответил:
~~~
Ниже даю развёрнутые ответы на все вопросы по пункту 4:

---

## 4.1. Действительно ли содержимое статьи относится к проблеме клиента?

**Да.** Статья на [techcommunity.microsoft.com](https://techcommunity.microsoft.com/blog/iis-support-blog/iis-short-name-enumeration/3951320) описывает именно ту уязвимость, о которой говорит клиент — *IIS short name enumeration*. Суть проблемы сводится к тому, что в Windows (на NTFS-разделах) существует механизм 8.3 (коротких) имён файлов, и IIS при определённых условиях «пропускает» запросы с символом `~`, позволяя злоумышленнику угадать настоящие имена файлов/папок. В статье чётко сказано, что причиной уязвимости является настройка реестра `NtfsDisable8dot3NameCreation`, и описано, как её менять.

---

## 4.2. Действительно ли предложенное в статье решение решит проблему клиента?

**В большинстве случаев — да,** решение, предложенное Microsoft, действительно устраняет саму возможность считывать короткие имена (8.3) и, следовательно, устраняет уязвимость, выявленную сканированием.

1. **Изменение параметра `NtfsDisable8dot3NameCreation` на `1`** в реестре (HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\FileSystem).  
2. После этого обычно требуется **перезагрузка** (или, как минимум, перерасположение существующих каталогов) для того, чтобы изменение вступило в полную силу и короткие имена перестали генерироваться.  
3. В некоторых случаях нужно дополнительно удалить уже созданные короткие имена (существуют команды `fsutil` для управления 8.3 именами на конкретном томе), иначе старые короткие имена могут всё ещё оставаться в системе.

Если целью является пройти PCI Compliance скан (а значит, закрыть «IIS Short Name Enumeration» как уязвимость), описанные меры в подавляющем большинстве отчётов соответствуют **«confirmed fix»**.

---

## 4.3. Знаешь ли ты альтернативные решения проблемы?

### 4.3.1. Вариант 1: Отключить 8.3 имена на уровне системы (из статьи Microsoft)
Это рекомендованный Microsoft подход:  
- `NtfsDisable8dot3NameCreation = 1` (отключить для всех будущих файлов/папок).  
- При необходимости очистить имеющиеся 8.3 имена (через `fsutil 8dot3name`).

**Плюсы:**  
- Официальное решение от Microsoft.  
- Устраняет проблему «в корне» — новые объекты не получают коротких имён, старые можно почистить.  

**Минусы:**  
- Может быть несовместим с очень старыми приложениями, которые полагаются на 8.3 имена (что в реальной практике встречается редко, но всё же возможно).

### 4.3.2. Вариант 2: Отключать/фильтровать запросы, содержащие `~`
В IIS можно настроить Request Filtering / URL Rewrite, чтобы блокировать или перенаправлять запросы, содержащие `~` (тильду) в URL.  

**Плюсы:**  
- Быстрое, точечное решение: закрывает атаку, связанную с короткими именами.  
- Не затрагивает общесистемные настройки и не ломает теоретически нужные короткие имена в файловой системе.

**Минусы:**  
- Может порождать проблемы с легитимными URL, если приложение действительно использует символ `~` (например, `~/somepath` в ASP.NET-маршрутизации). Тогда нужен тонкий подбор правил.  
- Уязвимость «жива» на уровне файловой системы, просто IIS её «маскирует».  

### 4.3.3. Вариант 3: Установить `NtfsDisable8dot3NameCreation=2` (или `3`) для «гибкого» сценария
Значение `2` означает *«устанавливать политику 8dot3NameCreation на уровне каждого тома отдельно»*; значение `3` — *«Отключать 8dot3 для всех томов, кроме системного»*.  

**Плюсы:**  
- Можно отключить короткие имена только там, где это действительно нужно (на томах с веб-контентом, например `D:`), сохранив 8.3 на других томах (например, системных, если вдруг оно требуется старому софту).  

**Минусы:**  
- Более сложно в администрировании, так как нужно корректно настроить каждый том.  
- В плане PCI-аудита могут попросить убедиться, что все веб-каталоги действительно расположены только на «безопасных» томах.

---

## 4.4. Какое из решений — лучшее?

Если нет критической зависимости (внутренних старых приложений, требующих 8.3 имена), то **лучшее (универсальное) решение** — **полностью отключить 8.3 имена**:  
1. Поставить в реестре `NtfsDisable8dot3NameCreation=1`.  
2. Перезагрузить (или, как минимум, обновить файловую систему для действующих каталогов).  
3. (Опционально) Удалить уже созданные короткие имена с помощью `fsutil`.  

Это решение:  
- Рекомендовано самими разработчиками IIS (Microsoft).  
- Наиболее надёжно фиксирует уязвимость.  
- Почти все современные приложения не зависят от 8.3.  

Если же есть риск, что какие-то старые программы могут «упасть» без 8.3 имён, можно пойти по пути компромисса — установить `NtfsDisable8dot3NameCreation=2` или `3` для конкретных томов, а при желании добавить **Request Filtering** на IIS, чтобы исключить случайные запросы с `~`.

---

### Краткий итог:

1. **Статья действительно описывает ту же самую уязвимость.**  
2. **Метод, предложенный Microsoft, обычно решает проблему** и удовлетворяет PCI DSS требованиям.  
3. **Существуют альтернативы** (фильтрация `~`, выборочный отключение 8.3 на конкретных томах), но самая «чистая» и рекомендованная Microsoft — **полное отключение 8.3** (через `NtfsDisable8dot3NameCreation=1`).  
4. **Лучшее решение** — то, что официально рекомендовано Microsoft и не вызывает зависимостей со старыми приложениями. Если таких зависимостей нет, смело отключайте 8.3 имена на всех томах.
~~~

## 5. `fsutil 8dot3name`
В официальной документации Microsoft имеется статья`fsutil 8dot3name` с адресом https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/fsutil-8dot3name и следующим содержимым:
```
<main id="main" class="" role="main" data-bi-name="content" lang="en-us" dir="ltr"><!-- article-header -->
	<div id="article-header" class="background-color-body margin-top-sm-tablet margin-bottom-xs display-none-print">
		<div class="display-flex align-items-center ">
			<details id="article-header-breadcrumbs-overflow-popover" class="popover" data-for="article-header-breadcrumbs"
					 hidden="">
				<summary class="button button-clear button-primary button-sm inner-focus" aria-label="All breadcrumbs">
											<span class="icon">
												<span class="docon docon-more"></span>
											</span>
				</summary>
				<div id="article-header-breadcrumbs-overflow" class="popover-content padding-none"><!---->
					<nav>
						<ol class="list-style-none">
							<!---->
							<li class="line-clamp-1">
								<a class="display-block has-inner-focus padding-inline-xs padding-block-xxs border-radius font-size-sm"
								   href="https://learn.microsoft.com/en-us/">
									Learn
								</a>
							</li>
							<!----><!---->
							<li class="line-clamp-1">
								<a class="display-block has-inner-focus padding-inline-xs padding-block-xxs border-radius font-size-sm"
								   href="https://learn.microsoft.com/en-us/windows-server/">
									Windows Server
								</a>
							</li>
							<!---->
						</ol>
					</nav>

					<!----></div>
			</details>

			<bread-crumbs id="article-header-breadcrumbs" data-test-id="article-header-breadcrumbs"
						  class="overflow-hidden flex-grow-1 margin-right-sm margin-right-md-tablet margin-right-lg-desktop margin-left-negative-xxs padding-left-xxs"
						  style="display: block; white-space: nowrap; overflow: hidden;"><!---->
				<nav>
					<ol class="breadcrumbs">
						<!---->
						<li class="breadcrumbs-item" data-bread-crumbs-collapse-target="">
							<a href="https://learn.microsoft.com/en-us/"><!---->Learn<!----></a>
						</li>
						<!----><!---->
						<li class="breadcrumbs-item" data-bread-crumbs-collapse-target="">
							<a href="https://learn.microsoft.com/en-us/windows-server/"><!---->Windows Server<!----></a>
						</li>
						<!---->
					</ol>
				</nav>
				<!----></bread-crumbs>
			<div id="article-header-page-actions" class="margin-left-auto display-flex flex-wrap-no-wrap align-items-stretch"><a
					id="lang-link-tablet"
					class="button button-primary button-clear button-sm display-none display-inline-flex-tablet"
					title="Read in English" data-bi-name="language-toggle" data-read-in-link="" hidden=""
					href="https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/fsutil-8dot3name"
					data-bi="{&quot;cN&quot;:&quot;language-toggle&quot;,&quot;value&quot;:&quot;off&quot;}">
											<span class="icon margin-none" aria-hidden="true" data-read-in-link-icon="">
												<span class="docon docon-locale-globe"></span>
											</span>
				<span class="is-visually-hidden" data-read-in-link-text="">Read in English</span>
			</a>
				<details class="popover popover-right add-item-popover">
					<summary class="button button-clear button-sm button-primary display-none display-inline-flex-tablet"
							 data-list-type="collection" data-list-item-title="fsutil 8dot3name | Microsoft Learn"
							 data-list-item-url="/windows-server/administration/windows-commands/fsutil-8dot3name"
							 data-list-source="module" data-resource-type="" data-bi-name="add-to-list"
							 aria-describedby="popover-content" aria-expanded="false">
			
												<span class="icon margin-none" aria-hidden="true">
													<span class="docon docon-circle-addition"></span>
												</span>
						<span class="collection-status is-visually-hidden">Save</span>

					</summary>
					<div class="popover-content has-z-index-one">
						<ul class="list-style-none margin-inline-none">
							<li>
								<button class="button button-clear button-sm button-primary" data-list-type="collection"
										data-list-item-title="fsutil 8dot3name | Microsoft Learn"
										data-list-item-url="/windows-server/administration/windows-commands/fsutil-8dot3name"
										data-bi-name="add-to-collections" data-pressed="false"
										title="Add fsutil 8dot3name | Microsoft Learn to a collection">
						<span class="icon" aria-hidden="true">
							<span class="docon docon-circle-addition"></span>
						</span>
									<span class="collection-status">Add to Collections</span>
								</button>
							</li>
							<li>
								<button class="button button-clear button-sm button-primary" data-list-type="plan"
										data-list-item-title="fsutil 8dot3name | Microsoft Learn"
										data-list-item-url="/windows-server/administration/windows-commands/fsutil-8dot3name"
										data-bi-name="add-to-plans" data-pressed="false"
										title="Add fsutil 8dot3name | Microsoft Learn to a plan">
						<span class="icon" aria-hidden="true">
							<span class="docon docon-circle-addition"></span>
						</span>
									<span class="plan-status">Add to plan</span>
								</button>
							</li>

						</ul>
					</div>
				</details>
				<a data-contenteditbtn=""
				   class="button button-clear button-sm text-decoration-none button-primary display-none display-inline-flex-tablet"
				   aria-label="Edit" title="Edit This Document" data-bi-name="edit"
				   href="https://github.com/MicrosoftDocs/windowsserverdocs/blob/main/WindowsServerDocs/administration/windows-commands/fsutil-8dot3name.md"
				   data-original_content_git_url="https://github.com/MicrosoftDocs/windowsserverdocs-pr/blob/live/WindowsServerDocs/administration/windows-commands/fsutil-8dot3name.md"
				   data-original_content_git_url_template="{repo}/blob/{branch}/WindowsServerDocs/administration/windows-commands/fsutil-8dot3name.md"
				   data-pr_repo="" data-pr_branch="">
												<span class="icon margin-none" aria-hidden="true">
													<span class="docon docon-edit-outline"></span>
												</span>
				</a>
				<details class="popover popover-right" id="article-header-page-actions-overflow">
					<summary class="justify-content-flex-start button button-clear button-sm button-primary"
							 aria-label="More actions" title="More actions">
												<span class="icon" aria-hidden="true">
													<span class="docon docon-more-vertical"></span>
												</span>
					</summary>
					<div class="popover-content padding-xs">
						<button data-page-action-item="overflow-mobile" type="button"
								class="justify-content-flex-start button-block button-sm has-inner-focus button button-clear display-none-tablet"
								data-bi-name="contents-expand" data-contents-button="" data-popover-close="">
														<span class="icon">
															<span class="docon docon-editor-list-bullet"
																  aria-hidden="true"></span>
														</span><span class="contents-expand-title">Table of contents</span>
						</button>
						<a id="lang-link-overflow"
						   class="justify-content-flex-start button-sm has-inner-focus button button-clear button-block display-none-tablet"
						   title="Read in English" data-bi-name="language-toggle" data-page-action-item="overflow-mobile"
						   data-check-hidden="true" data-read-in-link="" hidden=""
						   href="https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/fsutil-8dot3name"
						   data-bi="{&quot;cN&quot;:&quot;language-toggle&quot;,&quot;value&quot;:&quot;off&quot;}">
													<span class="icon" aria-hidden="true" data-read-in-link-icon="">
														<span class="docon docon-locale-globe"></span>
													</span>
							<span data-read-in-link-text="">Read in English</span>
						</a>
						<button type="button"
								class="collection justify-content-flex-start button button-clear button-sm has-inner-focus button-block display-none-tablet"
								data-list-type="collection" data-bi-name="collection"
								title="Add fsutil 8dot3name | Microsoft Learn to a collection"
								data-page-action-item="overflow-mobile" data-check-hidden="true" data-popover-close=""
								data-pressed="false">
														<span class="icon" aria-hidden="true">
															<span class="docon docon-circle-addition"></span>
														</span>
							<span class="collection-status">Add to Collections</span>
						</button>


						<button type="button"
								class="collection justify-content-flex-start button button-clear button-sm has-inner-focus button-block display-none-tablet"
								data-list-type="plan" data-bi-name="plan" title="Add fsutil 8dot3name | Microsoft Learn to a plan"
								data-page-action-item="overflow-mobile" data-check-hidden="true" data-popover-close=""
								data-pressed="false">
														<span class="icon" aria-hidden="true">
															<span class="docon docon-circle-addition"></span>
														</span>
							<span class="plan-status">Add to plan</span>
						</button>
						<a data-contenteditbtn=""
						   class="button button-clear button-block button-sm has-inner-focus justify-content-flex-start text-decoration-none display-none-tablet"
						   aria-label="Edit" title="Edit This Document" data-bi-name="edit"
						   href="https://github.com/MicrosoftDocs/windowsserverdocs/blob/main/WindowsServerDocs/administration/windows-commands/fsutil-8dot3name.md"
						   data-original_content_git_url="https://github.com/MicrosoftDocs/windowsserverdocs-pr/blob/live/WindowsServerDocs/administration/windows-commands/fsutil-8dot3name.md"
						   data-original_content_git_url_template="{repo}/blob/{branch}/WindowsServerDocs/administration/windows-commands/fsutil-8dot3name.md"
						   data-pr_repo="" data-pr_branch="">
														<span class="icon" aria-hidden="true">
															<span class="docon docon-edit-outline"></span>
														</span>
							<span>Edit</span>
						</a>
						<div aria-hidden="true" class="margin-none" data-page-action-item="overflow-all"></div>
						<hr class="display-none-tablet margin-bottom-xxs margin-top-xxs">
						<h4 class="font-size-sm padding-left-xxs">Share via</h4>

						<a class="button button-clear button-sm button-block has-inner-focus text-decoration-none justify-content-flex-start share-facebook"
						   data-bi-name="facebook" data-page-action-item="overflow-all"
						   href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Flearn.microsoft.com%2Fen-us%2Fwindows-server%2Fadministration%2Fwindows-commands%2Ffsutil-8dot3name%3FWT.mc_id%3Dfacebook">
															<span class="icon" aria-hidden="true">
																<span class="docon docon-facebook-share font-size-md color-primary"></span>
															</span>
							<span class="margin-left-xxs">Facebook</span>
						</a>
						<a class="button button-clear button-sm has-inner-focus button-block text-decoration-none justify-content-flex-start share-twitter"
						   data-bi-name="twitter" data-page-action-item="overflow-all"
						   href="https://twitter.com/intent/tweet?original_referer=https%3A%2F%2Flearn.microsoft.com%2Fen-us%2Fwindows-server%2Fadministration%2Fwindows-commands%2Ffsutil-8dot3name%3FWT.mc_id%3Dtwitter&amp;text=Today%20I%20completed%20%22fsutil%208dot3name%20%7C%20Microsoft%20Learn%22!%20I'm%20so%20proud%20to%20be%20celebrating%20this%20achievement%20and%20hope%20this%20inspires%20you%20to%20start%20your%20own%20%40MicrosoftLearn%20journey!&amp;tw_p=tweetbutton&amp;url=https%3A%2F%2Flearn.microsoft.com%2Fen-us%2Fwindows-server%2Fadministration%2Fwindows-commands%2Ffsutil-8dot3name%3FWT.mc_id%3Dtwitter">
															<span class="icon" aria-hidden="true">
																<span class="docon docon-xlogo-share font-size-xxs"></span>
															</span>
							<span class="margin-left-xxs">x.com</span>
						</a>
						<a class="button button-clear button-sm has-inner-focus button-block text-decoration-none justify-content-flex-start share-linkedin"
						   data-bi-name="linkedin" data-page-action-item="overflow-all"
						   href="https://www.linkedin.com/feed/?shareActive=true&amp;text=Today%20I%20completed%20%22fsutil%208dot3name%20%7C%20Microsoft%20Learn%22!%20I'm%20so%20proud%20to%20be%20celebrating%20this%20achievement%20and%20hope%20this%20inspires%20you%20to%20start%20your%20own%20%40MicrosoftLearn%20journey!%0A%0D%0Ahttps%3A%2F%2Flearn.microsoft.com%2Fen-us%2Fwindows-server%2Fadministration%2Fwindows-commands%2Ffsutil-8dot3name%3FWT.mc_id%3Dlinkedin">
															<span class="icon" aria-hidden="true">
																<span class="docon docon-linked-in-logo font-size-sm color-primary"></span>
															</span>
							<span class="margin-left-xxs">LinkedIn</span>
						</a>
						<a class="button button-clear button-sm button-block has-inner-focus text-decoration-none justify-content-flex-start margin-bottom-xxs share-email"
						   data-bi-name="email" data-page-action-item="overflow-all"
						   href="mailto:?subject=%5BShared%20Article%5D%20fsutil%208dot3name%20%7C%20Microsoft%20Learn&amp;body=Today%20I%20completed%20%22fsutil%208dot3name%20%7C%20Microsoft%20Learn%22!%20I'm%20so%20proud%20to%20be%20celebrating%20this%20achievement%20and%20hope%20this%20inspires%20you%20to%20start%20your%20own%20%40MicrosoftLearn%20journey!%0A%0D%0Ahttps%3A%2F%2Flearn.microsoft.com%2Fen-us%2Fwindows-server%2Fadministration%2Fwindows-commands%2Ffsutil-8dot3name%3FWT.mc_id%3Demail">
															<span class="icon" aria-hidden="true">
																<span class="docon docon-mail-message font-size-sm color-primary"></span>
															</span>
							<span class="margin-left-xxs">Email</span>
						</a>
						<hr>
						<button class="button button-block button-clear button-sm justify-content-flex-start has-inner-focus margin-top-xxs"
								title="Print" type="button" aria-label="Print" data-bi-name="print"
								data-page-action-item="overflow-all" data-popover-close="" data-print-page=""
								data-check-hidden="true">
														<span class="icon" aria-hidden="true">
															<span class="docon docon-print font-size-sm color-primary"></span>
														</span>
							<span class="margin-left-xxs">Print</span>
						</button>
					</div>
				</details>

			</div>
		</div>
	</div>
	<!-- end article-header -->
	<div>
		<button type="button" class="border contents-button button button-clear button-sm is-hidden-tablet has-inner-focus"
				data-bi-name="contents-expand" data-contents-button="" hidden="">
									<span class="icon">
										<span class="docon docon-editor-list-bullet" aria-hidden="true"></span>
									</span><span class="contents-expand-title">Table of contents</span></button>
	</div><!-- end mobile-contents button  -->

	<div class="content "><h1 id="fsutil-8dot3name">fsutil 8dot3name</h1>
		<div class="display-flex justify-content-space-between align-items-center flex-wrap-wrap page-metadata-container">
			<div class="margin-right-xxs">
				<ul class="metadata page-metadata" data-bi-name="page info" lang="en-us" dir="ltr">
					<li>Article</li>
					<li class="visibility-hidden-visual-diff">
						<time class="" data-article-date="" aria-label="Article review date" datetime="2024-11-01T17:46:00.000Z"
							  data-article-date-source="calculated">11/01/2024
						</time>
					</li>
					<li class="contributors-holder display-none-print">
						<button aria-label="View all contributors" class="contributors-button link-button"
								data-bi-name="contributors" title="View all contributors">11 contributors
						</button>
					</li>
					<li class="attributeList-holder">
						<dl class="attributeList">
							<dt>Applies to:</dt>
							<dd>✅ <a href="https://learn.microsoft.com/windows-server/get-started/windows-server-release-info"
									 target="_blank">Windows Server 2025</a>, ✅ <a
									href="https://learn.microsoft.com/windows-server/get-started/windows-server-release-info"
									target="_blank">Windows Server 2022</a>, ✅ <a
									href="https://learn.microsoft.com/windows-server/get-started/windows-server-release-info"
									target="_blank">Windows Server 2019</a>, ✅ <a
									href="https://learn.microsoft.com/windows-server/get-started/windows-server-release-info"
									target="_blank">Windows Server 2016</a>, ✅ <a
									href="https://learn.microsoft.com/windows/release-health/supported-versions-windows-client"
									target="_blank">Windows 11</a>, ✅ <a
									href="https://learn.microsoft.com/windows/release-health/supported-versions-windows-client"
									target="_blank">Windows 10</a>, ✅ <a
									href="https://learn.microsoft.com/azure/azure-local/release-information-23h2" target="_blank">Azure
								Local, versions 23H2 and 22H2</a></dd>
						</dl>
					</li>
				</ul>
			</div>
			<div id="user-feedback" class="margin-block-xxs display-none-print" data-hide-on-archived="">
				<button id="user-feedback-button" data-test-id="conceptual-feedback-button"
						class="button button-sm button-clear button-primary" type="button" data-bi-name="user-feedback-button"
						data-user-feedback-button="">
		<span class="icon" aria-hidden="true">
			<span class="docon docon-like"></span>
		</span>
					<span>Feedback</span>
				</button>
			</div>
		</div>
		<nav id="center-doc-outline" class="doc-outline display-none-print margin-bottom-sm" data-bi-name="intopic toc"
			 aria-label="In this article"><!---->
			<h2 id="ms--in-this-article" class="title is-6 margin-block-xs"><!---->In this article<!----></h2>
			<ol id="content-well-in-this-article-list" class="border-left padding-left-xxs">
				<!---->
				<li class="">
					<a href="#syntax"><!---->Syntax<!----></a>
				</li>
				<!---->
				<li class="">
					<a href="#related-links"><!---->Related links<!----></a>
				</li>
				<!---->
			</ol>
			<!----></nav><!-- <content> --><p>Queries or changes the settings for short name (8dot3 name) behavior, which
			includes:</p>
		<ul>
			<li><p>Querying the current setting for the short name behavior.</p>
			</li>
			<li><p>Scanning the specified directory path for registry keys that might be impacted if short names were stripped
				from the specified directory path.</p>
			</li>
			<li><p>Changing the setting that controls the short name behavior. This setting can be applied to a specified volume
				or to the default volume setting.</p>
			</li>
			<li><p>Removing the short names for all files within a directory.</p>
			</li>
		</ul>
		<div class="alert is-primary">
			<p class="alert-title"><span class="docon docon-status-info-outline" aria-hidden="true"></span> Important</p>
			<p>Permanently removing 8dot3 file names and not modifying registry keys that point to the 8dot3 file names may lead
				to unexpected application failures, including the inability to uninstall an application. It is recommended you
				first back up your directory or volume before you attempt to remove 8dot3 file names.</p>
		</div>
		<div class="heading-wrapper" data-heading-level="h2"><a class="anchor-link docon docon-link" href="#syntax"
																aria-label="Section titled: Syntax"></a>
			<h2 id="syntax" class="heading-anchor">Syntax</h2></div>
		<div class="codeHeader" id="code-try-0" data-bi-name="code-header"><span class="language"></span>
			<button type="button" class="action position-relative display-none-print" data-bi-name="copy">
			<span class="icon margin-right-xxs" aria-hidden="true">
				<span class="docon docon-edit-copy"></span>
			</span>
				<span>Copy</span>
				<div class="successful-copy-alert position-absolute right-0 top-0 left-0 bottom-0 display-flex align-items-center justify-content-center has-text-success-invert has-background-success is-transparent"
					 aria-hidden="true">
				<span class="icon font-size-lg">
					<span class="docon docon-check-mark"></span>
				</span>
				</div>
			</button>
		</div>
		<pre class="has-inner-focus"><code>fsutil 8dot3name [query] [&lt;volumepath&gt;]
fsutil 8dot3name [scan] [/s] [/l [&lt;log file&gt;] ] [/v] &lt;directorypath&gt;
fsutil 8dot3name [set] { &lt;defaultvalue&gt; | &lt;volumepath&gt; {1|0}}
fsutil 8dot3name [strip] [/t] [/s] [/f] [/l [&lt;log file.] ] [/v] &lt;directorypath&gt;
</code></pre>
		<div class="heading-wrapper" data-heading-level="h3"><a class="anchor-link docon docon-link" href="#parameters"
																aria-label="Section titled: Parameters"></a>
			<h3 id="parameters" class="heading-anchor">Parameters</h3></div>
		<div class="buttons buttons-right margin-bottom-none margin-top-sm"><!---->
			<button class="button button-clear button-sm display-flex gap-xxs">
		<span class="icon" aria-hidden="true">
			<span class="docon docon-expand color-primary"></span>
		</span>
				<span><!---->Expand table<!----></span>
			</button><!----></div>
		<div class="has-inner-focus">
			<table aria-label="Table 1" class="table table-sm margin-top-none">
				<thead>
				<tr>
					<th>Parameter</th>
					<th>Description</th>
				</tr>
				</thead>
				<tbody>
				<tr>
					<td>query <code>[&lt;volumepath&gt;]</code></td>
					<td>Queries the file system for the state of the 8dot3 short name creation behavior.<p>If a
						<em>volumepath</em> isn't specified as a parameter, the default 8dot3name creation behavior setting for
						all volumes is displayed.</p></td>
				</tr>
				<tr>
					<td>scan <code>&lt;directorypath&gt;</code></td>
					<td>Scans the files that are located in the specified <em>directorypath</em> for registry keys that might be
						impacted if 8dot3 short names were stripped from the file names.
					</td>
				</tr>
				<tr>
					<td>set <code>{&lt;defaultvalue&gt; \| &lt;volumepath&gt;}</code></td>
					<td>Changes the file system behavior for 8dot3 name creation in the following instances:
						<ul>
							<li>When <em>defaultvalue</em> is specified, the registry key, <strong>HKLM\System\CurrentControlSet\Control\FileSystem\NtfsDisable8dot3NameCreation</strong>,
								is set to the <em>defaultvalue</em>.<p>The <em>DefaultValue</em> can have the following values:
								</p>
								<ul>
									<li><strong>0</strong>: Enables 8dot3 name creation for all volumes on the system.</li>
									<li><strong>1</strong>: Disables 8dot3 name creation for all volumes on the system.</li>
									<li><strong>2</strong>: Sets 8dot3 name creation on a per volume basis.</li>
									<li><strong>3</strong>: Disables 8dot3 name creation for all volumes except the system volume.
									</li>
								</ul>
							</li>
							<li>When a <em>volumepath</em> is specified, the specified volumes on disk flag 8dot3name properties
								are set to enable 8dot3 name creation for a specified volume (<strong>0</strong>) or set to
								disable 8dot3 name creation on the specified volume (<strong>1</strong>).<p>You must set the
									default file system behavior for 8dot3 name creation to the value <strong>2</strong> before
									you can enable or disable 8dot3 name creation for a specified volume.</p></li>
						</ul>
					</td>
				</tr>
				<tr>
					<td>strip <code>&lt;directorypath&gt;</code></td>
					<td>Removes the 8dot3 file names for all files that are located in the specified <em>directorypath</em>. The
						8dot3 file name is not removed for any files where the <em>directorypath</em> combined with the file name
						contains more than 260 characters.<p>This command lists, but does not modify the registry keys that point
							to the files that had 8dot3 file names permanently removed.</p></td>
				</tr>
				<tr>
					<td><code>&lt;volumepath&gt;</code></td>
					<td>Specifies the drive name followed by a colon or the GUID in the format <code>volume{GUID}</code>.</td>
				</tr>
				<tr>
					<td>/f</td>
					<td>Specifies that all files that are located in the specified <em>directorypath</em> have the 8dot3 file
						names removed even if there are registry keys that point to files using the 8dot3 file name. In this case,
						the operation removes the 8dot3 file names, but does not modify any registry keys that point to the files
						that are using the 8dot3 file names. <strong>Warning:</strong> It's recommended that you back up your
						directory or volume prior to using the <strong>/f</strong> parameter because it may lead to unexpected
						application failures, including the inability to uninstall programs.
					</td>
				</tr>
				<tr>
					<td>/l <code>[&lt;log file&gt;]</code></td>
					<td>Specifies a log file where information is written.<p>If the <strong>/l</strong> parameter isn't specified,
						all information is written to the default log file: <code>%temp%\8dot3_removal_log@(GMT YYYY-MM-DD
							HH-MM-SS)</code>.log**</p></td>
				</tr>
				<tr>
					<td>/s</td>
					<td>Specifies that the operation should be applied to the subdirectories of the specified
						<em>directorypath</em>.
					</td>
				</tr>
				<tr>
					<td>/t</td>
					<td>Specifies that the removal of 8dot3 file names should be run in test mode. All operations except the
						actual removal of the 8dot3 file names are performed. You can use test mode to discover which registry
						keys point to files that use the 8dot3 file names.
					</td>
				</tr>
				<tr>
					<td>/v</td>
					<td>Specifies that all information that is written to the log file is also displayed on the command-line.</td>
				</tr>
				</tbody>
			</table>
		</div>
		<div class="heading-wrapper" data-heading-level="h3"><a class="anchor-link docon docon-link" href="#examples"
																aria-label="Section titled: Examples"></a>
			<h3 id="examples" class="heading-anchor">Examples</h3></div>
		<p>To query for the disable 8dot3 name behavior for a disk volume that is specified with the GUID,
			{928842df-5a01-11de-a85c-806e6f6e6963}, type:</p>
		<div class="codeHeader" id="code-try-1" data-bi-name="code-header"><span class="language"></span>
			<button type="button" class="action position-relative display-none-print" data-bi-name="copy">
			<span class="icon margin-right-xxs" aria-hidden="true">
				<span class="docon docon-edit-copy"></span>
			</span>
				<span>Copy</span>
				<div class="successful-copy-alert position-absolute right-0 top-0 left-0 bottom-0 display-flex align-items-center justify-content-center has-text-success-invert has-background-success is-transparent"
					 aria-hidden="true">
				<span class="icon font-size-lg">
					<span class="docon docon-check-mark"></span>
				</span>
				</div>
			</button>
		</div>
		<pre class="has-inner-focus"><code>fsutil 8dot3name query volume{928842df-5a01-11de-a85c-806e6f6e6963}
</code></pre>
		<p>You can also query the 8dot3 name behavior by using the <strong>behavior</strong> subcommand.</p>
		<p>To remove 8dot3 file names in the <em>D:\MyData</em> directory and all subdirectories, while writing the information to
			the log file that is specified as <em>mylogfile.log</em>, type:</p>
		<div class="codeHeader" id="code-try-2" data-bi-name="code-header"><span class="language"></span>
			<button type="button" class="action position-relative display-none-print" data-bi-name="copy">
			<span class="icon margin-right-xxs" aria-hidden="true">
				<span class="docon docon-edit-copy"></span>
			</span>
				<span>Copy</span>
				<div class="successful-copy-alert position-absolute right-0 top-0 left-0 bottom-0 display-flex align-items-center justify-content-center has-text-success-invert has-background-success is-transparent"
					 aria-hidden="true">
				<span class="icon font-size-lg">
					<span class="docon docon-check-mark"></span>
				</span>
				</div>
			</button>
		</div>
		<pre class="has-inner-focus"><code>fsutil 8dot3name strip /l mylogfile.log /s d:\MyData
</code></pre>
		<div class="heading-wrapper" data-heading-level="h2"><a class="anchor-link docon docon-link" href="#related-links"
																aria-label="Section titled: Related links"></a>
			<h2 id="related-links" class="heading-anchor">Related links</h2></div>
		<ul>
			<li><p><a href="command-line-syntax-key" data-linktype="relative-path">Command-Line Syntax Key</a></p>
			</li>
			<li><p><a href="fsutil" data-linktype="relative-path">fsutil</a></p>
			</li>
			<li><p><a href="fsutil-behavior" data-linktype="relative-path">fsutil behavior</a></p>
			</li>
		</ul>
	</div>
	<div id="ms--inline-notifications" class="margin-block-xs" data-bi-name="inline-notification"></div>
	<div id="assertive-live-region" role="alert" aria-live="assertive" class="visually-hidden" aria-relevant="additions"
		 aria-atomic="true"></div>
	<div id="polite-live-region" role="status" aria-live="polite" class="visually-hidden" aria-relevant="additions"
		 aria-atomic="true"></div>
	<!-- </content> -->

</main>
```

## 6. Как статья пункта 5 соотносится с проблемой клиента?
### 6.1.
Я тебя спросил:
~~~
Как статья пункта 5 соотносится с проблемой клиента?
~~~

### 6.2.
Ты ответил:
~~~
Статья из пункта 5 подробно описывает команду **`fsutil 8dot3name`**, которая напрямую связана с отключением и управлением «короткими» (8.3) именами в файловой системе NTFS. Именно эти короткие имена и вызывают уязвимость IIS Short Name Enumeration. Поэтому:

1. **В чём суть проблемы клиента:**  
   - Клиент столкнулся с уязвимостью, позволяющей сканеру (или потенциальному злоумышленнику) «угадывать» короткие (8.3) имена файлов и каталогов на IIS-сервере.  
   - Причина — в том, что на NTFS-разделах включён механизм 8.3 имён, и IIS при особых запросах (с `~`) выдаёт информацию об этих коротких именах.

2. **Как помогает статья:**  
   - Статья описывает, как с помощью **`fsutil 8dot3name`** можно проверить текущее состояние создания коротких имён, **выключить** их создание на уровне системы или конкретного тома (`set`), а также **«стереть»** уже существующие короткие имена (`strip`).  
   - Это важно, потому что **одного только изменения реестра** (`NtfsDisable8dot3NameCreation=1`) зачастую недостаточно, если короткие имена для старых файлов **уже** были сгенерированы. Их нужно удалить отдельно, чтобы уязвимость ушла полностью.

3. **Практическое применение для клиента:**  
   - После того как клиент изменит реестр (отключит 8.3 для новых файлов), ему может потребоваться запустить `fsutil 8dot3name strip`, чтобы **удалить уже существующие короткие имена** в директории, где лежит веб-контент.  
   - Если этого не сделать, старые короткие имена продолжат существовать и сканер всё равно обнаружит ту же уязвимость.

4. **Заключение:**  
   - Статья из пункта 5 — это **официальная документация Microsoft**, которая детально описывает управление 8.3 именами.  
   - Она **полностью релевантна** задаче клиента по устранению IIS Short Name Enumeration. Используя рекомендации из статьи (и параллельно учитывая реестр), клиент сможет комплексно закрыть уязвимость, что необходимо для успешного прохождения PCI Compliance скана.
~~~

## 7. Предлагает ли статья пункта 5 некие альтернативные решения проблемы клиента в дополнение к указанным тобой в пункте 4.2?
### 7.1.
Я тебя спросил:
~~~
Предлагает ли статья пункта 5 некие альтернативные решения проблемы клиента в дополнение к указанным тобой в пункте 4.2?
~~~

### 7.2.
Ты ответил:
~~~
**Короткий ответ:**  
Нет, статья из пункта 5 **не предлагает принципиально новых** способов устранения проблемы, кроме тех, что уже упоминались в п. 4.2. Она лишь даёт **детализированные инструкции** по работе с 8.3-именами (просмотр, отключение, удаление существующих) с помощью `fsutil 8dot3name`, но по сути решение сводится к тем же шагам:

1. **Отключить** генерацию коротких имён (на уровне всей системы или конкретного тома).  
2. **Удалить** (при необходимости) уже существующие короткие имена из каталога с веб-контентом.  

Все остальные возможные «варианты» (использовать фильтрацию `~`, оставить 8.3 на части томов и т. д.) в статье **прямо не описаны** — они относятся скорее к дополнительным мерам, которые можно применять в IIS или при «гибкой» настройке реестра.  

### Что именно добавляет статья п. 5
- **Подробные опции** команды `fsutil 8dot3name`:  
  - `query` (просмотр текущих настроек),  
  - `set` (установка 8.3-режима на уровне всей системы или выбранного тома),  
  - `scan` (проверка директорий на наличие путей, зависящих от коротких имён),  
  - `strip` (удаление уже существующих 8.3-имен).

- **Параметры** вроде `/f`, `/t`, `/l`, которые позволяют:  
  - **снять** ограничение с проверки на регистрационные ключи (но при этом вы можете «сломать» программы, которые на них ссылаются),  
  - **тестировать** удаление в «пробном» режиме без реального стирания коротких имён,  
  - **вести** лог записей обо всех изменениях.

Всё это — _не самостоятельные «альтернативные» решения_, а скорее инструменты и нюансы выполнения **основной** стратегии: «Отключить 8.3 и очистить старые имена».
~~~

## 8. Мой ответ клиенту
Я хочу ответить клиенту так:
~~~
1) Ensure that none of your applications depend on the 8.3 (short) name mechanism.  
2) Create a backup of critically important data.  
3) Execute the command:  
```
fsutil 8dot3name query
```  
https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/fsutil-8dot3name  
3.1) If the `fsutil` program responds that `NtfsDisable8dot3NameCreation` equals `1` (or `3`), it means that short names are already disabled (fully or partially).  
3.2) If the `fsutil` program responds `0`, it means that short names are enabled.  
3.3) If the `fsutil` program responds `2`, it means that the volume-level setting is used.  
4) In the case of 3.2, 8.3-names need to be disabled.  
4.1) It is easiest to do this with the same `fsutil` program:  
```
fsutil 8dot3name set 1
```  
4.2) Another way to do this is through «Registry Editor»:  
4.2.1) Open «Registry Editor» (through «Start» → «Run» → enter `regedit`).  
4.2.2) Go to the following path: «HKEY_LOCAL_MACHINE» → «SYSTEM» → «CurrentControlSet» → «Control» → «FileSystem».  
4.2.3) Find the parameter `NtfsDisable8dot3NameCreation`.  
4.2.4) Change «Value data» to 1 in order to disable the 8.3 mechanism for all volumes.  
4.2.5) Close «Registry Editor».  
5) I recommend restarting the server so that the changes take effect for all new file operations.  
After the restart, new files and directories will not receive short names. However, for already existing files, short names may still remain.  
6) Deletion of already existing 8.3-names.  
This is especially important for the IIS web content directory.  
6.1) Run the command:  
```
fsutil 8dot3name strip
```  
6.1.1) Example (with subdirectory processing enabled and logging to `strip-log.txt`):  
```
fsutil 8dot3name strip /s /l strip-log.txt D:\inetpub\wwwroot
```  
In this command:  
- `/s` indicates applying to all subdirectories.  
- `/l` makes it possible to specify a log file; in this case `strip-log.txt`.  
- `D:\inetpub\wwwroot` is an example path to the directory where the web content is located.  
6.2) Analyze the resulting log (`strip-log.txt` from the example in 6.1.1).  
If any applications still reference short names, deleting 8.3-names may lead to errors in these applications.  
Therefore, before the final deletion, you I recommend to run the command with the `/t` parameter (test mode) to identify potentially problematic files.  
7) Run again the scanning tool that detected the IIS Short Name Enumeration vulnerability.  
This usually occurs through an external PCI DSS Approved Scanning Vendor (ASV) or with software such as Tenable Nessus, Qualys, or others.  
Ensure that the issue no longer appears in the scanning report.  
8) Additional measures (if necessary)  
8.1. If you have old applications that require short names, instead of globally disabling 8.3 (value `1`), you can set `NtfsDisable8dot3NameCreation=2` or `3`.  
After that, you will be able to enable or disable 8.3-names for individual volumes manually.  
8.2. You can configure the `~` character filtering in Microsoft Internet Information Services (IIS Manager) → «Request Filtering» or through «URL Rewrite» to block specific requests, but this solution will only hide the vulnerability at the IIS level.  
If the goal is specifically to meet PCI DSS requirements, a full disabling of 8.3 (with subsequent removal of existing short names) is most often recommended.  
9) Usually it is necessary to prepare a report for PCI DSS auditors indicating which specific steps were taken.  
~~~

## 9. Твоя задача
Проанализируй следующий фрагмент моего ответа клиенту (пункт 8) на наличие языковых ошибок/недостатков:
<фрагмент>
STUB
</фрагмент>

## 10. Требования к твоему ответу
### 10.1.
Анализируй только тот фрагмент текста, который указан в пункте 9.

### 10.2.
Используй полный текст моего ответа клиенту (пункт 8) для понимания контекста анализируемого фрагмента (пункт 9).

### 10.3.
Используй все предыдущие пункты моего запроса (1-7) для понимания обсуждаемой в моём ответе клиенту (пункт 8) предметной области.

### 10.4. 
Анализ языковых ошибок (пункт 9) веди на русском языке.

### 10.5.
К уловым кавычкам `«»` не придирайся.

### 10.6.
Каждую языковую ошибку нумеруй.

### 10.7. Итоговый вариант
#### 10.7.1
После своего анализа каждой из языковых ошибок предложи итоговый вариант улучшения анализируемого фрагмента (пункт 9). 
#### 10.7.2
Назови этот раздел своего ответа «Итоговый вариант».
Сделай это заголовком 2-го уровня (используй `##`).
#### 10.7.3
Свой итоговый вариант помести внутрь backticks таким образом:
```
Текст итогового варианта
```
Мне это нужно, чтобы я мог одним кликом скопировать твой итоговый вариант.
#### 10.7.4
Не добавляй новую разметку Markdown к итоговому варианту.
Используй только ту разметку Markdown, которая имелась в исходном варианте.
#### 10.7.5
Форматируй итоговый вариант в точности как исходный фрагмент. 
В частности:
*) каждый абзац должен содержать ровно одно предложение
*) между абзацами не должно оставаться пустых строк.
*) кавычки используй те же, что и в оригинале: «» и ``.
### 10.7.6
Не используй в итоговом варианте сокращения типа «don't». 
Все подобные фразы пиши полностью: «do not».